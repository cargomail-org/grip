<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1801" height="1583"><desc>participant%20%22AS%22%20as%20AS%0Aparticipant%20%22Client%22%20as%20Client%0Aparticipant%20%22RS%22%20as%20RS%0A%0Abottomparticipants%0A%0Aentryspacing%201.0%0Anote%20over%20AS%3AAS%5Cn%E2%80%A2%20acts%20in%20the%20role%20of%20a%20Security%20Token%20Service%20(STS)%5Cn%E2%80%A2%20supports%20the%20Token%20Exchange%20extension%20of%20OAuth%202.0%5Cn%E2%80%A2%20supports%20mTLS%20Client%20Certificate-Bound%20Access%20Tokens%20extension%20of%20OAuth%202.0%0Anote%20over%20Client%3ARP%2FClient%3A%5Cn%E2%80%A2%20is%20registered%20at%20the%20AS%20as%20a%20confidential%20client%5Cn%E2%80%A2%20supports%20mTLS%20Client%20Certificate-Bound%20Access%20Tokens%20extension%20of%20OAuth%202.0%5Cn%E2%80%A2%20uses%20a%20self-signed%20or%20CA-signed%20certificate%20with%20a%20certificate%20extension%20containing%20a%20custom%20OID%20and%20ASN1%3AUTF8String%20value%5Cn%20%20that%20serves%20as%20a%20global%20client%20identifier%20in%20respect%20of%20the%20service%20it%20represents%2C%5Cn%20%20e.g.%2C%201.2.3.4.5.6.7.8%3DASN1%3AUTF8String%3Aclient._mhs._grip.foo.com%5Cn%E2%80%A2%20acts%20as%20a%20client%20in%20respect%20of%20the%20RS%5Cn%E2%80%A2%20the%20Client's%20public%20key%20fingerprint%20is%20published%20on%20the%20client%20domain%20using%20DNS%20TXT%20record%2C%5Cn%20%20e.g.%2C%20client._mhs._grip.foo.com%20IN%20TXT%20%20%22v%3Dgrip1%3B%20h%3Dsha256%3B%20p%3Dd2abde240d7cd3ee6b%20...%20e971%22%0Anote%20over%20RS%3ARS%3A%5Cn%E2%80%A2%20supports%20mTLS%20Client%20Certificate-Bound%20Access%20Tokens%20extension%20of%20OAuth%202.0%5Cn%E2%80%A2%20uses%20a%20CA-signed%20certificate%20with%20an%20appropriate%20Subject%20Alternative%20Name%20(SAN)%5Cn%E2%80%A2%20uses%20a%20DNS%20SRV%20record%20to%20specify%20a%20host%20and%20port%20of%20the%20resource%20server%2C%20while%20identifies%20the%20respective%5Cn%20%20%20service%2C%20e.g.%2C%20_mhs._tcp.bar.com%5Cn%E2%80%A2%20uses%20the%20information%20in%20the%20assertion%20to%20identify%20the%20user%5Cn%20%20and%20makes%20authorization%20decisions%20using%20a%20local%20ABAC%20engine%5Cn%E2%80%A2%20should%20support%20the%20AS%20issuer%20discovery%20mechanism%0AClient-%3EClient%3A1.%20Client%20generates%20a%20token%20%E2%80%94%20a%20signed%2C%20using%20the%20Client's%20private%20key%2C%5Cn%20%20%20%20certificate-bound%20assertion%20in%20JWT%20format%20with%20these%20claims%3A%5Cn%20%20%20%20%7Biss%2C%20aud%2C%20sub%2C%20exp%2C%20nbf%2C%20cnf%2C%20act%7Bsub%7D%2C%20tokens%7D%5Cn%20%20%20%20%E2%80%A2%20iss%20identifies%20who%20issues%20the%20token%20%E2%80%94%20CN%20from%20public%20Client's%20certificate%2C%5Cn%20%20%20%20%20%20e.g.%2C%20foo.com%5Cn%20%20%20%20%E2%80%A2%20aud%20identifies%20the%20target%20AS%5Cn%20%20%20%20%E2%80%A2%20sub%20identifies%20the%20user%20by%20email%20address%2C%5Cn%20%20%20%20%20%20e.g.%20User%20Principal%20Name%20(UPN)%20from%20Active%20Directory%20(AD)%5Cn%20%20%20%20%20%20(Client%20impersonates%20the%20user%20by%20using%20their%20email%20address)%5Cn%20%20%20%20%E2%80%A2%20exp%2C%20nbf%20are%20the%20standard%20JWT%20claims%5Cn%20%20%20%20%E2%80%A2%20cnf%20is%20the%20confirmation%20method%20with%20the%20hash%20of%20the%20client%20certificate%5Cn%20%20%20%20%20%20to%20which%20the%20token%20is%20bound%5Cn%20%20%20%20%E2%80%A2%20tokens%20(optional)%20holds%20an%20embedded%20JWT%20from%20the%20previous%20hop%5Cn%20%20%20%20%E2%80%A2%20digest%20(optional)%20contains%20a%20digest%20(cryptographic%20hash)%20of%20the%20data%5Cn%20%20%20%20%20%20%20being%20transmitted%20(pushed%20or%20pulled)%0AAS%3C-Client%3A2.%20Send%20an%20HTTPS%20request%20to%20the%20AS%20STS%20token%20endpoint%20using%20mTLS%5Cn%20%20%20%20%E2%80%A2%20grant_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Atoken-exchange%5Cn%20%20%20%20%E2%80%A2%20resource%20%3D%20a%20target%20RS%20URI%5Cn%20%20%20%20%E2%80%A2%20requested_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Ajwt%5Cn%20%20%20%20%E2%80%A2%20subject_token%20%3D%20token%5Cn%20%20%20%20%E2%80%A2%20subject_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Ajwt%0AAS-%3EAS%3A3.%20Authorization%20decision%3A%5Cn%20%20%20%201.%20authenticate%20the%20client%20using%20the%20specified%20credentials%5Cn%20%20%20%202.%20evaluate%20the%20resource%20parameter%5Cn%20%20%20%203.%20verify%20the%20subject_token%20signature%20using%20the%20Client's%20certificate%20public%20key%5Cn%20%20%20%204.%20validate%20the%20subject_token%20proof-of-possession%5Cn%20%20%20%205.%20evaluate%20the%20subject_token%20claims%5Cn%20%20%20%206.%20(optional)%20evaluate%20embedded%20tokens%0A%0AAS-%3EAS%3A4.%20AS%20STS%20generates%20a%20token%20%E2%80%94%20a%20signed%20certificate-bound%20assertion%5Cn%20%20%20%20in%20JWT%20format%20with%20these%20claims%3A%5Cn%20%20%20%20%7Biss%2C%20aud%2C%20sub%2C%20exp%2C%20nbf%2C%20cnf%2C%20act%7Bsub%7D%2C%20tokens%7D%5Cn%20%20%20%20%E2%80%A2%20iss%20is%20the%20URI%20that%20identifies%20who%20issues%20the%20token%5Cn%20%20%20%20%E2%80%A2%20aud%20identifies%20the%20target%20service%20and%20it%20is%20the%20value%20from%5Cn%20%20%20%20%20%20the%20resource%20parameter%5Cn%20%20%20%20%E2%80%A2%20sub%20identifies%20the%20user%20by%20email%20address%5Cn%20%20%20%20%20%20retrieved%20through%20subject_token%20introspection%5Cn%20%20%20%20%E2%80%A2%20exp%2C%20nbf%20are%20the%20standard%20JWT%20claims%5Cn%20%20%20%20%E2%80%A2%20cnf%20is%20the%20confirmation%20method%20with%20the%20hash%20of%20the%20client%20certificate%5Cn%20%20%20%20%20%20to%20which%20the%20token%20is%20bound%5Cn%20%20%20%20%E2%80%A2%20act%7Bsub%7D%20is%20the%20global%20client%20identifier%20in%20respect%20of%20the%20service%20it%20represents%2C%5Cn%20%20%20%20%20%20copied%20from%20the%20ASN1%3AUTF8String%20value%20of%20the%20certificate%20extension%2C%20e.g.%2C%20client._mhs._grip.foo.com%5Cn%20%20%20%20%20%20(act%20identifies%20the%20acting%20party%20to%20whom%20authority%20has%20been%20delegated)%5Cn%20%20%20%20%E2%80%A2%20tokens%20(optional)%20holds%20an%20embedded%20JWT%20from%20the%20previous%20hop%0AClient%3C-AS%3A5.%20Return%20the%20token%5Cn%7B%22access_token%22%3Atoken%2C%5Cn%20%22issued_token_type%22%3A%22urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Ajwt%22%2C%5Cn%20%22token_type%22%3A%22N_A%22%2C%5Cn%20%22expires_in%22%3A3600%7D%0A%0AClient-%3EClient%3A6.%20Client%20generates%20a%20token%20%E2%80%94%20a%20signed%2C%20using%20the%20Client's%20private%20key%2C%5Cn%20%20%20%20DNS-bound%20assertion%20in%20JWT%20format%20with%20these%20claims%3A%5Cn%20%20%20%20%7Biss%2C%20aud%2C%20sub%2C%20exp%2C%20nbf%2C%20jwk%2C%20act%7Bsub%7D%2C%20tokens%7D%5Cn%20%20%20%20%E2%80%A2%20iss%20identifies%20who%20issues%20the%20token%20%E2%80%94%20CN%20from%20public%20Client's%20certificate%2C%5Cn%20%20%20%20%20%20e.g.%2C%20foo.com%5Cn%20%20%20%20%E2%80%A2%20aud%20identifies%20the%20target%20service%20by%20the%20DNS%20SRV%20record%2C%20e.g.%2C%20_mhs._tcp.bar.com%5Cn%20%20%20%20%E2%80%A2%20sub%20identifies%20the%20user%20by%20email%20address%2C%5Cn%20%20%20%20%20%20e.g.%20User%20Principal%20Name%20(UPN)%20from%20Active%20Directory%20(AD)%5Cn%20%20%20%20%20%20(Client%20impersonates%20the%20user%20by%20using%20their%20email%20address)%5Cn%20%20%20%20%E2%80%A2%20exp%2C%20nbf%20are%20the%20standard%20JWT%20claims%5Cn%20%20%20%20%E2%80%A2%20jwks%20holds%20a%20Client's%20certificate%20public%20key%20in%20the%20JWK%20Set%20format%5Cn%20%20%20%20%20%20(alternatively%20provide%20JWK%20Set%20by%20URI%20using%20jwks_uri%20claim)%5Cn%20%20%20%20%E2%80%A2%20tokens%20holds%20an%20embedded%20JWT%20from%20the%20previous%20step%5Cn%20%20%20%20%20%20and%20optionally%20an%20embedded%20JWT%20from%20the%20previous%20hop%5Cn%20%20%20%20%E2%80%A2%20digest%20(optional)%20contains%20a%20digest%20(cryptographic%20hash)%20of%20the%20data%5Cn%20%20%20%20%20%20%20being%20transmitted%20(pushed%20or%20pulled)%0A%0AClient-%3ERS%3A7.%20Send%20an%20HTTPS%20request%20to%20the%20RS%20with%20the%20token%20using%20mTLS%0ARS-%3ERS%3A7.%20Authorization%20decision%5Cn%20%20%20%201.%20the%20client%20is%20authenticated%20via%20the%20DNS%20using%20the%20TXT%20record%20and%20the%20custom%20OID%20value%5Cn%20%20%20%20%20%20%20from%20the%20public%20Client's%20certificate%5Cn%20%20%20%202.%20verify%20token%20signature%5Cn%20%20%20%203.%20validate%20proof-of-possession%5Cn%20%20%20%204.%20evaluate%20embedded%20token%20from%20the%20AS%5Cn%20%20%20%205.%20(optional)%20evaluate%20embedded%20tokens%20from%20the%20previous%20hops%5Cn%20%20%20%206.%20the%20domain%20part%20of%20the%20user's%20email%20address%20and%20the%20domain%20part%20of%20the%20custom%20OID%20value%5Cn%20%20%20%20%20%20%20from%20the%20public%20Client's%20certificate%20must%20match%5Cn%20%20%20%207.%20(optional)%20verify%20the%20digest%20claim%20value%20of%20the%20embedded%20tokens%20against%20the%20digest%20of%5Cn%20%20%20%20%20%20%20%20the%20transmitted%20(pushed)%20data%20or%20the%20digest%20of%20the%20data%20being%20transmitted%20(pulled)%0ARS-%3EClient%3A9.%20Return%20the%20HTTP%20response%2C%20typically%20with%20200%2C%20201%20status%20code%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1801" height="1583"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 233.5704033570703 38.111285853 L 233.5704033570703 1543.3374422430002" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray="8.699220692307692,3.7696623000000002"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 802.670184190664 38.111285853 L 802.670184190664 1543.3374422430002" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray="8.699220692307692,3.7696623000000002"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1275.3866642430078 38.111285853 L 1275.3866642430078 1543.3374422430002" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray="8.699220692307692,3.7696623000000002"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 214.2834856813796 7.690111091999997 L 252.85732103276095 7.690111091999997 L 252.85732103276095 38.111285853 L 214.2834856813796 38.111285853 L 214.2834856813796 7.690111091999997 Z" stroke-miterlimit="10" stroke-width="1.8094379040000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="226.55373646787962" y="26.802298953" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AS</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 774.9999337856337 7.690111091999997 L 830.3404345956943 7.690111091999997 L 830.3404345956943 38.111285853 L 774.9999337856337 38.111285853 L 774.9999337856337 7.690111091999997 Z" stroke-miterlimit="10" stroke-width="1.8094379040000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="787.2701845721338" y="26.802298953" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1256.0414136472427 7.690111091999997 L 1294.731914838773 7.690111091999997 L 1294.731914838773 38.111285853 L 1256.0414136472427 38.111285853 L 1256.0414136472427 7.690111091999997 Z" stroke-miterlimit="10" stroke-width="1.8094379040000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1268.3116644337426" y="26.802298953" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RS</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 214.2834856813796 1543.3374422430002 L 252.85732103276095 1543.3374422430002 L 252.85732103276095 1573.7586170040001 L 214.2834856813796 1573.7586170040001 L 214.2834856813796 1543.3374422430002 Z" stroke-miterlimit="10" stroke-width="1.8094379040000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="226.55373646787962" y="1562.449630104" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AS</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 774.9999337856337 1543.3374422430002 L 830.3404345956943 1543.3374422430002 L 830.3404345956943 1573.7586170040001 L 774.9999337856337 1573.7586170040001 L 774.9999337856337 1543.3374422430002 Z" stroke-miterlimit="10" stroke-width="1.8094379040000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="787.2701845721338" y="1562.449630104" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1256.0414136472427 1543.3374422430002 L 1294.731914838773 1543.3374422430002 L 1294.731914838773 1573.7586170040001 L 1256.0414136472427 1573.7586170040001 L 1256.0414136472427 1543.3374422430002 Z" stroke-miterlimit="10" stroke-width="1.8094379040000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1268.3116644337426" y="1562.449630104" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RS</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 5.65449345 60.72925965300001 L 451.3082250541406 60.72925965300001 L 461.4863132641406 70.90734786300001 L 461.4863132641406 120.66689022300001 L 5.65449345 120.66689022300001 L 5.65449345 60.72925965300001 M 451.3082250541406 60.72925965300001 L 451.3082250541406 70.90734786300001 L 461.4863132641406 70.90734786300001" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="21.487075109999978" y="76.561841313" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AS</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="21.487075109999978" y="87.87082821300001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• acts in the role of a Security Token Service (STS)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="21.487075109999978" y="99.17981511300002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports the Token Exchange extension of OAuth 2.0</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="21.487075109999978" y="110.48880201300003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports mTLS Client Certificate-Bound Access Tokens extension of OAuth 2.0</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 453.53761473769526 137.630370573 L 1141.6246654336328 137.630370573 L 1151.8027536436327 147.808458783 L 1151.8027536436327 254.11293564300001 L 453.53761473769526 254.11293564300001 L 453.53761473769526 137.630370573 M 1141.6246654336328 137.630370573 L 1141.6246654336328 147.808458783 L 1151.8027536436327 147.808458783" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="469.3701963976953" y="153.462952233" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RP/Client:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="469.3701963976953" y="164.77193913300002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is registered at the AS as a confidential client</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="469.3701963976953" y="176.08092603300003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports mTLS Client Certificate-Bound Access Tokens extension of OAuth 2.0</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="469.3701963976953" y="187.38991293300003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses a self-signed or CA-signed certificate with a certificate extension containing a custom OID and ASN1:UTF8String value</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="469.3701963976953" y="198.69889983300004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  that serves as a global client identifier in respect of the service it represents,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="469.3701963976953" y="210.00788673300005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  e.g., 1.2.3.4.5.6.7.8=ASN1:UTF8String:client._mhs._grip.foo.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="469.3701963976953" y="221.31687363300006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• acts as a client in respect of the RS</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="469.3701963976953" y="232.62586053300006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• the Client's public key fingerprint is published on the client domain using DNS TXT record,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="469.3701963976953" y="243.93484743300007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  e.g., client._mhs._grip.foo.com IN TXT  "v=grip1; h=sha256; p=d2abde240d7cd3ee6b ... e971"</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 979.9457451806641 271.07641599299996 L 1560.6494950953518 271.07641599299996 L 1570.8275833053517 281.25450420299995 L 1570.8275833053517 376.249994163 L 979.9457451806641 376.249994163 L 979.9457451806641 271.07641599299996 M 1560.6494950953518 271.07641599299996 L 1560.6494950953518 281.25450420299995 L 1570.8275833053517 281.25450420299995" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="995.778326840664" y="286.908997653" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RS:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="995.778326840664" y="298.21798455299995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports mTLS Client Certificate-Bound Access Tokens extension of OAuth 2.0</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="995.778326840664" y="309.52697145299993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses a CA-signed certificate with an appropriate Subject Alternative Name (SAN)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="995.778326840664" y="320.8359583529999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses a DNS SRV record to specify a host and port of the resource server, while identifies the respective</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="995.778326840664" y="332.1449452529999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   service, e.g., _mhs._tcp.bar.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="995.778326840664" y="343.45393215299987" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses the information in the assertion to identify the user</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="995.778326840664" y="354.76291905299985" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  and makes authorization decisions using a local ABAC engine</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="995.778326840664" y="366.0719059529998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• should support the AS issuer discovery mechanism</text></g><g><g><rect fill="white" stroke="none" x="816.052485355664" y="393.213474513" width="375.9260212653125" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="816.052485355664" y="404.522461413" width="335.7926899664844" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="816.052485355664" y="415.83144831299995" width="268.39269607" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="816.052485355664" y="427.14043521299993" width="408.0093647711719" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="816.052485355664" y="438.4494221129999" width="93.22603194646484" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="816.052485355664" y="449.7584090129999" width="172.89269607" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="816.052485355664" y="461.06739591299987" width="243.10935561589844" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="816.052485355664" y="472.37638281299985" width="332.7593647711719" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="816.052485355664" y="483.68536971299983" width="340.84270827703125" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="816.052485355664" y="494.9943566129998" width="223.12603347234375" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="816.052485355664" y="506.3033435129998" width="390.7093769782031" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="816.052485355664" y="517.6123304129998" width="171.54268996648437" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="816.052485355664" y="528.9213173129998" width="370.4760395758594" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="816.052485355664" y="540.2303042129998" width="384.89269607" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="816.052485355664" y="551.5392911129999" width="223.64269607" height="14.70168297"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="817.748833390664" y="403.391562723" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. Client generates a token — a signed, using the Client's private key,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="817.748833390664" y="414.700549623" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    certificate-bound assertion in JWT format with these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="817.748833390664" y="426.00953652299995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {iss, aud, sub, exp, nbf, cnf, act{sub}, tokens}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="817.748833390664" y="437.31852342299993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • iss identifies who issues the token — CN from public Client's certificate,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="817.748833390664" y="448.6275103229999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      e.g., foo.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="817.748833390664" y="459.9364972229999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • aud identifies the target AS</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="817.748833390664" y="471.24548412299987" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • sub identifies the user by email address,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="817.748833390664" y="482.55447102299985" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      e.g. User Principal Name (UPN) from Active Directory (AD)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="817.748833390664" y="493.8634579229998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      (Client impersonates the user by using their email address)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="817.748833390664" y="505.1724448229998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • exp, nbf are the standard JWT claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="817.748833390664" y="516.4814317229998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • cnf is the confirmation method with the hash of the client certificate</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="817.748833390664" y="527.7904186229998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      to which the token is bound</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="817.748833390664" y="539.0994055229999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • tokens (optional) holds an embedded JWT from the previous hop</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="817.748833390664" y="550.4083924229999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • digest (optional) contains a digest (cryptographic hash) of the data</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="817.748833390664" y="561.7173793229999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       being transmitted (pushed or pulled)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 802.670184190664 566.2409740830001 L 847.9061317906641 566.2409740830001 L 847.9061317906641 580.9426570530001 L 811.981250071664 580.9426570530001" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray=""/><g transform="translate(802.670184190664,580.9426570530001) translate(-802.670184190664,-580.9426570530001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 812.094339940664 576.2305791780001 L 802.670184190664 580.9426570530001 L 812.094339940664 585.654734928 Z"/></g></g><g><g><rect fill="white" stroke="none" x="335.0822861929687" y="597.906137403" width="366.0760151617969" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="335.0822861929687" y="609.215124303" width="364.7093769782031" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="335.0822861929687" y="620.5241112030001" width="169.77602736882812" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="335.0822861929687" y="631.8330981030001" width="356.7760273688281" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="335.0822861929687" y="643.1420850030001" width="145.6926991217578" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="335.0822861929687" y="654.4510719030002" width="341.59270827703125" height="14.70168297"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="336.7786342279687" y="608.0842256130001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. Send an HTTPS request to the AS STS token endpoint using mTLS</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="336.7786342279687" y="619.3932125130001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • grant_type = urn:ietf:params:oauth:grant-type:token-exchange</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="336.7786342279687" y="630.7021994130001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • resource = a target RS URI</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="336.7786342279687" y="642.0111863130002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • requested_token_type = urn:ietf:params:oauth:token-type:jwt</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="336.7786342279687" y="653.3201732130002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • subject_token = token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="336.7786342279687" y="664.6291601130002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • subject_token_type = urn:ietf:params:oauth:token-type:jwt</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 802.670184190664 669.152754873 L 242.88146923807028 669.152754873" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray=""/><g transform="translate(233.5704033570703,669.152754873) translate(-233.5704033570703,-669.152754873)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 242.9945591070703 664.4406769980001 L 233.5704033570703 669.152754873 L 242.9945591070703 673.864832748 Z"/></g></g><g><g><rect fill="white" stroke="none" x="246.9527045220703" y="686.1162352230001" width="139.02602736882812" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="246.9527045220703" y="697.4252221230001" width="317.7093769782031" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="246.9527045220703" y="708.7342090230002" width="206.5593678229297" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="246.9527045220703" y="720.0431959230002" width="421.9760395758594" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="246.9527045220703" y="731.3521828230002" width="277.2926899664844" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="246.9527045220703" y="742.6611697230003" width="212.20936171941406" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="246.9527045220703" y="753.9701566230003" width="230.65935866765625" height="14.70168297"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="248.6490525570703" y="696.2943234330002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. Authorization decision:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="248.6490525570703" y="707.6033103330002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    1. authenticate the client using the specified credentials</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="248.6490525570703" y="718.9122972330002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    2. evaluate the resource parameter</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="248.6490525570703" y="730.2212841330003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    3. verify the subject_token signature using the Client's certificate public key</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="248.6490525570703" y="741.5302710330003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    4. validate the subject_token proof-of-possession</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="248.6490525570703" y="752.8392579330003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    5. evaluate the subject_token claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="248.6490525570703" y="764.1482448330004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    6. (optional) evaluate embedded tokens</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 233.5704033570703 768.6718395930001 L 278.8063509570703 768.6718395930001 L 278.8063509570703 783.373522563 L 242.88146923807028 783.373522563" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray=""/><g transform="translate(233.5704033570703,783.373522563) translate(-233.5704033570703,-783.373522563)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 242.9945591070703 778.6614446880001 L 233.5704033570703 783.373522563 L 242.9945591070703 788.085600438 Z"/></g></g><g><g><rect fill="white" stroke="none" x="246.9527045220703" y="800.3370029130001" width="363.8260151617969" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="246.9527045220703" y="811.6459898130001" width="189.0926930182422" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="246.9527045220703" y="822.9549767130002" width="268.39269607" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="246.9527045220703" y="834.2639636130002" width="287.9927021735156" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="246.9527045220703" y="845.5729505130003" width="324.2093769782031" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="246.9527045220703" y="856.8819374130003" width="150.10935561589844" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="246.9527045220703" y="868.1909243130003" width="239.7260243170703" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="246.9527045220703" y="879.4999112130004" width="267.2260395758594" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="246.9527045220703" y="890.8088981130004" width="223.12603347234375" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="246.9527045220703" y="902.1178850130004" width="390.7093769782031" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="246.9527045220703" y="913.4268719130005" width="171.54268996648437" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="246.9527045220703" y="924.7358588130005" width="433.94268386296875" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="246.9527045220703" y="936.0448457130005" width="551.7593342535938" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="246.9527045220703" y="947.3538326130006" width="400.2760273688281" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="246.9527045220703" y="958.6628195130006" width="370.4760395758594" height="14.70168297"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="248.6490525570703" y="810.5150911230002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. AS STS generates a token — a signed certificate-bound assertion</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="248.6490525570703" y="821.8240780230002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    in JWT format with these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="248.6490525570703" y="833.1330649230002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {iss, aud, sub, exp, nbf, cnf, act{sub}, tokens}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="248.6490525570703" y="844.4420518230003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • iss is the URI that identifies who issues the token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="248.6490525570703" y="855.7510387230003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • aud identifies the target service and it is the value from</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="248.6490525570703" y="867.0600256230003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      the resource parameter</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="248.6490525570703" y="878.3690125230004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • sub identifies the user by email address</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="248.6490525570703" y="889.6779994230004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      retrieved through subject_token introspection</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="248.6490525570703" y="900.9869863230005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • exp, nbf are the standard JWT claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="248.6490525570703" y="912.2959732230005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • cnf is the confirmation method with the hash of the client certificate</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="248.6490525570703" y="923.6049601230005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      to which the token is bound</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="248.6490525570703" y="934.9139470230006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • act{sub} is the global client identifier in respect of the service it represents,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="248.6490525570703" y="946.2229339230006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      copied from the ASN1:UTF8String value of the certificate extension, e.g., client._mhs._grip.foo.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="248.6490525570703" y="957.5319208230006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      (act identifies the acting party to whom authority has been delegated)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="248.6490525570703" y="968.8409077230007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • tokens (optional) holds an embedded JWT from the previous hop</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 233.5704033570703 973.3645024830001 L 278.8063509570703 973.3645024830001 L 278.8063509570703 988.0661854530001 L 242.88146923807028 988.0661854530001" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray=""/><g transform="translate(233.5704033570703,988.0661854530001) translate(-233.5704033570703,-988.0661854530001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 242.9945591070703 983.3541075780001 L 233.5704033570703 988.0661854530001 L 242.9945591070703 992.7782633280001 Z"/></g></g><g><g><rect fill="white" stroke="none" x="354.02395184238276" y="1005.0296658030002" width="106.2426945441211" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="354.02395184238276" y="1016.3386527030002" width="127.64269607" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="354.02395184238276" y="1027.6476396030002" width="328.19268386296875" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="354.02395184238276" y="1038.9566265030003" width="112.75936477117187" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="354.02395184238276" y="1050.2656134030003" width="107.60936324529297" height="14.70168297"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="355.7202998773828" y="1015.2077540130002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. Return the token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="355.7202998773828" y="1026.5167409130001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{"access_token":token,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="355.7202998773828" y="1037.8257278130002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> "issued_token_type":"urn:ietf:params:oauth:token-type:jwt",</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="355.7202998773828" y="1049.1347147130002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> "token_type":"N_A",</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="355.7202998773828" y="1060.4437016130003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> "expires_in":3600}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 233.5704033570703 1064.9672963730002 L 793.359118309664 1064.9672963730002" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray=""/><g transform="translate(802.670184190664,1064.9672963730002) translate(-802.670184190664,-1064.9672963730002)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 793.2460284406641 1060.2552184980002 L 802.670184190664 1064.9672963730002 L 793.2460284406641 1069.6793742480002 Z"/></g></g><g><g><rect fill="white" stroke="none" x="816.052485355664" y="1081.9307767230002" width="375.9260212653125" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="816.052485355664" y="1093.2397636230003" width="305.0426899664844" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="816.052485355664" y="1104.5487505230003" width="269.8593708746875" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="816.052485355664" y="1115.8577374230003" width="408.0093647711719" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="816.052485355664" y="1127.1667243230004" width="93.22603194646484" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="816.052485355664" y="1138.4757112230004" width="455.37603347234375" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="816.052485355664" y="1149.7846981230005" width="243.10935561589844" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="816.052485355664" y="1161.0936850230005" width="332.7593647711719" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="816.052485355664" y="1172.4026719230005" width="340.84270827703125" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="816.052485355664" y="1183.7116588230006" width="223.12603347234375" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="816.052485355664" y="1195.0206457230006" width="366.5593525641406" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="816.052485355664" y="1206.3296326230006" width="335.4593769782031" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="816.052485355664" y="1217.6386195230007" width="318.6760212653125" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="816.052485355664" y="1228.9476064230007" width="321.3260151617969" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="816.052485355664" y="1240.2565933230007" width="384.89269607" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="816.052485355664" y="1251.5655802230008" width="223.64269607" height="14.70168297"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="817.748833390664" y="1092.1088649330002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. Client generates a token — a signed, using the Client's private key,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="817.748833390664" y="1103.4178518330002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    DNS-bound assertion in JWT format with these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="817.748833390664" y="1114.7268387330002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {iss, aud, sub, exp, nbf, jwk, act{sub}, tokens}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="817.748833390664" y="1126.0358256330003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • iss identifies who issues the token — CN from public Client's certificate,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="817.748833390664" y="1137.3448125330003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      e.g., foo.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="817.748833390664" y="1148.6537994330004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • aud identifies the target service by the DNS SRV record, e.g., _mhs._tcp.bar.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="817.748833390664" y="1159.9627863330004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • sub identifies the user by email address,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="817.748833390664" y="1171.2717732330004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      e.g. User Principal Name (UPN) from Active Directory (AD)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="817.748833390664" y="1182.5807601330005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      (Client impersonates the user by using their email address)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="817.748833390664" y="1193.8897470330005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • exp, nbf are the standard JWT claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="817.748833390664" y="1205.1987339330005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • jwks holds a Client's certificate public key in the JWK Set format</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="817.748833390664" y="1216.5077208330006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      (alternatively provide JWK Set by URI using jwks_uri claim)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="817.748833390664" y="1227.8167077330006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • tokens holds an embedded JWT from the previous step</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="817.748833390664" y="1239.1256946330006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      and optionally an embedded JWT from the previous hop</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="817.748833390664" y="1250.4346815330007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • digest (optional) contains a digest (cryptographic hash) of the data</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="817.748833390664" y="1261.7436684330007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       being transmitted (pushed or pulled)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 802.670184190664 1266.2672631930002 L 847.9061317906641 1266.2672631930002 L 847.9061317906641 1280.9689461630003 L 811.981250071664 1280.9689461630003" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray=""/><g transform="translate(802.670184190664,1280.9689461630003) translate(-802.670184190664,-1280.9689461630003)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 812.094339940664 1276.2568682880003 L 802.670184190664 1280.9689461630003 L 812.094339940664 1285.6810240380003 Z"/></g></g><g><g><rect fill="white" stroke="none" x="869.5070792335937" y="1297.932426513" width="339.0426899664844" height="14.70168297"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="871.2034272685937" y="1308.110514723" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7. Send an HTTPS request to the RS with the token using mTLS</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 802.670184190664 1312.6341094830002 L 1266.0755983620077 1312.6341094830002" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray=""/><g transform="translate(1275.3866642430078,1312.6341094830002) translate(-1275.3866642430078,-1312.6341094830002)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1265.9625084930078 1307.9220316080002 L 1275.3866642430078 1312.6341094830002 L 1265.9625084930078 1317.3461873580002 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1288.7689654080077" y="1329.5975898330003" width="135.4426991217578" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="1288.7689654080077" y="1340.9065767330003" width="492.7427021735156" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="1288.7689654080077" y="1352.2155636330003" width="207.79268996648437" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="1288.7689654080077" y="1363.5245505330004" width="147.14269607" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="1288.7689654080077" y="1374.8335374330004" width="179.40935866765625" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="1288.7689654080077" y="1386.1425243330004" width="236.7260243170703" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="1288.7689654080077" y="1397.4515112330005" width="357.4927021735156" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="1288.7689654080077" y="1408.7604981330005" width="509.12603347234375" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="1288.7689654080077" y="1420.0694850330005" width="275.0426899664844" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="1288.7689654080077" y="1431.3784719330006" width="483.4927021735156" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="1288.7689654080077" y="1442.6874588330006" width="467.9760395758594" height="14.70168297"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1290.4653134430077" y="1339.7756780430002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7. Authorization decision</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1290.4653134430077" y="1351.0846649430002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    1. the client is authenticated via the DNS using the TXT record and the custom OID value</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1290.4653134430077" y="1362.3936518430003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       from the public Client's certificate</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1290.4653134430077" y="1373.7026387430003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    2. verify token signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1290.4653134430077" y="1385.0116256430003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    3. validate proof-of-possession</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1290.4653134430077" y="1396.3206125430004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    4. evaluate embedded token from the AS</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1290.4653134430077" y="1407.6295994430004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    5. (optional) evaluate embedded tokens from the previous hops</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1290.4653134430077" y="1418.9385863430005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    6. the domain part of the user's email address and the domain part of the custom OID value</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1290.4653134430077" y="1430.2475732430005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       from the public Client's certificate must match</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1290.4653134430077" y="1441.5565601430005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    7. (optional) verify the digest claim value of the embedded tokens against the digest of</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1290.4653134430077" y="1452.8655470430006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">        the transmitted (pushed) data or the digest of the data being transmitted (pulled)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1275.3866642430078 1457.3891418030003 L 1320.6226118430077 1457.3891418030003 L 1320.6226118430077 1472.0908247730003 L 1284.6977301240079 1472.0908247730003" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray=""/><g transform="translate(1275.3866642430078,1472.0908247730003) translate(-1275.3866642430078,-1472.0908247730003)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1284.8108199930077 1467.3787468980004 L 1275.3866642430078 1472.0908247730003 L 1284.8108199930077 1476.8029026480003 Z"/></g></g><g><g><rect fill="white" stroke="none" x="864.6404105324218" y="1489.0543051230002" width="348.7760273688281" height="14.70168297"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="866.3367585674218" y="1499.2323933330001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">9. Return the HTTP response, typically with 200, 201 status code</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1275.3866642430078 1503.7559880930003 L 811.981250071664 1503.7559880930003" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray=""/><g transform="translate(802.670184190664,1503.7559880930003) translate(-802.670184190664,-1503.7559880930003)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 812.094339940664 1499.0439102180003 L 802.670184190664 1503.7559880930003 L 812.094339940664 1508.4680659680002 Z"/></g></g></g></g></svg>