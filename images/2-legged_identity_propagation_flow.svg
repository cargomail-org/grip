<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1300" height="1134"><desc>participant%20%22AS%22%20as%20AS%0Aparticipant%20%22Client%22%20as%20Client%0Aparticipant%20%22RS%22%20as%20RS%0A%0Abottomparticipants%0A%0Aentryspacing%201.0%0Anote%20over%20AS%3AAS%5Cn%E2%80%A2%20acts%20in%20the%20role%20of%20a%20Security%20Token%20Service%20(STS)%5Cn%E2%80%A2%20supports%20the%20Token%20Exchange%20extension%20of%20OAuth%202.0%5Cn%E2%80%A2%20supports%20Mutual-TLS%20Client%20Certificate-Bound%20Access%20Tokens%20extension%20of%20OAuth%202.0%0Anote%20over%20Client%3AClient%3A%5Cn%E2%80%A2%20uses%20self-signed%20or%20CA-signed%20certificate%2C%5Cn%20%20the%20CN%20attribute%20of%20the%20public%20client%20certificate%20is%20used%20as%20a%20global%20client%20identifier%5Cn%20%20in%20respect%20of%20the%20service%20it%20represents%2C%20e.g.%2C%20CN%3D_smtp-client.foo.127.0.0.1.nip.io%5Cn%E2%80%A2%20supports%20Mutual-TLS%20Client%20Certificate-Bound%20Access%20Tokens%20extension%20of%20OAuth%202.0%5Cn%E2%80%A2%20is%20registered%20at%20the%20AS%20as%20a%20confidential%20client%5Cn%E2%80%A2%20acts%20as%20a%20client%20in%20respect%20of%20the%20RS%0Anote%20over%20RS%3ARS%3A%5Cn%E2%80%A2%20supports%20Mutual-TLS%20Client%20Certificate-Bound%20Access%20Tokens%20extension%20of%20OAuth%202.0%5Cn%E2%80%A2%20uses%20the%20information%20in%20the%20assertion%20to%20identify%20the%20user%5Cn%20%20and%20makes%20authorization%20decisions%20using%20a%20local%20ABAC%20engine%5Cn%E2%80%A2%20should%20support%20the%20AS%20issuer%20discovery%20mechanism%0AClient-%3EClient%3A1.%20Client%20generates%20a%20token%20%E2%80%94%20a%20signed%2C%20using%20the%20Client's%20private%20key%2C%5Cn%20%20%20%20certificate-bound%20assertion%20in%20JWT%20format%20with%20these%20claims%3A%5Cn%20%20%20%20%7Biss%2C%20aud%2C%20sub%2C%20exp%2C%20nbf%2C%20cnf%2C%20act%7Bsub%7D%2C%20tokens%7D%5Cn%20%20%20%20%E2%80%A2%20iss%20identifies%20who%20issues%20the%20token%20%E2%80%94%20CN%20from%20public%20Client's%20certificate%2C%5Cn%20%20%20%20%20%20e.g.%20_smtp-client.foo.127.0.0.1.nip.io%5Cn%20%20%20%20%E2%80%A2%20aud%20identifies%20the%20target%20AS%5Cn%20%20%20%20%E2%80%A2%20sub%20identifies%20the%20user%20by%20email%20address%2C%5Cn%20%20%20%20%20%20e.g.%20User%20Principal%20Name%20(UPN)%20from%20Active%20Directory%20(AD)%5Cn%20%20%20%20%20%20(Client%20impersonates%20the%20user%20by%20using%20their%20email%20address)%5Cn%20%20%20%20%E2%80%A2%20exp%2C%20nbf%20are%20the%20standard%20JWT%20claims%5Cn%20%20%20%20%E2%80%A2%20cnf%20is%20the%20confirmation%20method%20with%20the%20hash%20of%20the%20client%20certificate%5Cn%20%20%20%20%20%20to%20which%20the%20token%20is%20bound%5Cn%20%20%20%20%E2%80%A2%20tokens%20(optional)%20holds%20an%20embedded%20JWT%20from%20the%20previous%20hop%0AAS%3C-Client%3A2.%20Send%20an%20HTTP%20request%20to%20the%20AS%20STS%20token%20endpoint%20using%20mTLS%5Cn%20%20%20%20%E2%80%A2%20grant_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Agrant-type%3Atoken-exchange%5Cn%20%20%20%20%E2%80%A2%20resource%20%3D%20a%20target%20RS%20URI%5Cn%20%20%20%20%E2%80%A2%20requested_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Ajwt%5Cn%20%20%20%20%E2%80%A2%20subject_token%20%3D%20token%5Cn%20%20%20%20%E2%80%A2%20subject_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Ajwt%0AAS-%3EAS%3A3.%20Authorization%20decision%3A%5Cn%20%20%20%201.%20authenticate%20the%20client%20using%20the%20specified%20credentials%5Cn%20%20%20%202.%20evaluate%20the%20resource%20parameter%5Cn%20%20%20%203.%20verify%20the%20subject_token%20signature%20using%20the%20Client's%20certificate%20public%20key%5Cn%20%20%20%204.%20validate%20the%20subject_token%20proof-of-possession%5Cn%20%20%20%205.%20evaluate%20the%20subject_token%20claims%5Cn%20%20%20%206.%20(optional)%20evaluate%20embedded%20tokens%0A%0AAS-%3EAS%3A4.%20AS%20STS%20generates%20a%20token%20%E2%80%94%20a%20signed%20certificate-bound%20assertion%5Cn%20%20%20%20in%20JWT%20format%20with%20these%20claims%3A%5Cn%20%20%20%20%7Biss%2C%20aud%2C%20sub%2C%20exp%2C%20nbf%2C%20cnf%2C%20act%7Bsub%7D%2C%20tokens%7D%5Cn%20%20%20%20%E2%80%A2%20iss%20is%20the%20URI%20that%20identifies%20who%20issues%20the%20token%5Cn%20%20%20%20%E2%80%A2%20aud%20identifies%20the%20target%20service%20and%20it%20is%20the%20value%20from%5Cn%20%20%20%20%20%20the%20resource%20parameter%5Cn%20%20%20%20%E2%80%A2%20sub%20identifies%20the%20user%20by%20email%20address%5Cn%20%20%20%20%20%20retrieved%20through%20subject_token%20introspection%5Cn%20%20%20%20%E2%80%A2%20exp%2C%20nbf%20are%20the%20standard%20JWT%20claims%5Cn%20%20%20%20%E2%80%A2%20cnf%20is%20the%20confirmation%20method%20with%20the%20hash%20of%20the%20client%20certificate%5Cn%20%20%20%20%20%20to%20which%20the%20token%20is%20bound%5Cn%20%20%20%20%E2%80%A2%20act%7Bsub%7D%20is%20the%20global%20client%20identifier%20in%20respect%20of%20the%20service%5Cn%20%20%20%20%20%20it%20represents%2C%20copied%20from%20the%20CN%20attribute%20of%20the%20client's%5Cn%20%20%20%20%20%20public%20certificate%2C%20e.g.%2C%20_smtp-client.foo.127.0.0.1.nip.io%5Cn%20%20%20%20%20%20(act%20identifies%20the%20acting%20party%20to%20whom%20authority%20has%20been%20delegated)%5Cn%20%20%20%20%E2%80%A2%20tokens%20(optional)%20holds%20an%20embedded%20JWT%20from%20the%20previous%20hop%0AClient%3C-AS%3A5.%20Return%20the%20token%5Cn%7B%22access_token%22%3Atoken%2C%5Cn%20%22issued_token_type%22%3A%22urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Ajwt%22%2C%5Cn%20%22token_type%22%3A%22N_A%22%2C%5Cn%20%22expires_in%22%3A3600%7D%0A%0AClient-%3ERS%3A6.%20Send%20an%20HTTP%20request%20to%20the%20RS%20with%20the%20token%20using%20mTLS%0ARS-%3ERS%3A7.%20Authorization%20decision%5Cn%20%20%20%201.%20verify%20the%20token%20signature%5Cn%20%20%20%202.%20validate%20proof-of-possession%5Cn%20%20%20%203.%20(optional)%20evaluate%20embedded%20tokens%5Cn%20%20%20%204.%20use%20WebFinger%20to%20locate%20the%20AS%20for%20the%20user%20using%5Cn%20%20%20%20%20%20%20%20its%20identifier%20and%20verify%20that%20the%20AS%20matches%20the%20token%20issuer%5Cn%20%20%20%20or%5Cn%20%20%20%20%20%20%20%20the%20domain%20part%20of%20the%20users's%20email%20address%5Cn%20%20%20%20%20%20%20%20and%20the%20AS%20host%20domain%20must%20match%0ARS-%3EClient%3A8.%20Return%20the%20HTTP%20response%2C%20typically%20with%20200%2C%20201%20status%20code%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1300" height="1134"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 217.58295972234376 33.876698536 L 217.58295972234376 1099.434575336" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray="7.732640615384615,3.3508109333333334"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 602.8457633615365 33.876698536 L 602.8457633615365 1099.434575336" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray="7.732640615384615,3.3508109333333334"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 975.8918921960417 33.876698536 L 975.8918921960417 1099.434575336" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray="7.732640615384615,3.3508109333333334"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 200.52607003897634 6.835654304000002 L 234.6398494057112 6.835654304000002 L 234.6398494057112 33.876698536 L 200.52607003897634 33.876698536 L 200.52607003897634 6.835654304000002 Z" stroke-miterlimit="10" stroke-width="1.608389248" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="211.43295962697633" y="23.824265736" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AS</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 578.4472069797132 6.835654304000002 L 627.2443197433597 6.835654304000002 L 627.2443197433597 33.876698536 L 578.4472069797132 33.876698536 L 578.4472069797132 6.835654304000002 Z" stroke-miterlimit="10" stroke-width="1.608389248" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="589.3540965677132" y="23.824265736" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 958.7850027987765 6.835654304000002 L 992.9987815933068 6.835654304000002 L 992.9987815933068 33.876698536 L 958.7850027987765 33.876698536 L 958.7850027987765 6.835654304000002 Z" stroke-miterlimit="10" stroke-width="1.608389248" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="969.6918923867765" y="23.824265736" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RS</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 200.52607003897634 1099.434575336 L 234.6398494057112 1099.434575336 L 234.6398494057112 1126.4756195680002 L 200.52607003897634 1126.4756195680002 L 200.52607003897634 1099.434575336 Z" stroke-miterlimit="10" stroke-width="1.608389248" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="211.43295962697633" y="1116.4231867679998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AS</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 578.4472069797132 1099.434575336 L 627.2443197433597 1099.434575336 L 627.2443197433597 1126.4756195680002 L 578.4472069797132 1126.4756195680002 L 578.4472069797132 1099.434575336 Z" stroke-miterlimit="10" stroke-width="1.608389248" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="589.3540965677132" y="1116.4231867679998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 958.7850027987765 1099.434575336 L 992.9987815933068 1099.434575336 L 992.9987815933068 1126.4756195680002 L 958.7850027987765 1126.4756195680002 L 958.7850027987765 1099.434575336 Z" stroke-miterlimit="10" stroke-width="1.608389248" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="969.6918923867765" y="1116.4231867679998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RS</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 5.0262164 53.981564135999996 L 421.0925135246875 53.981564135999996 L 430.1397030446875 63.02875365599999 L 430.1397030446875 107.259457976 L 5.0262164 107.259457976 L 5.0262164 53.981564135999996 M 421.0925135246875 53.981564135999996 L 421.0925135246875 63.02875365599999 L 430.1397030446875 63.02875365599999" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="19.09962232000001" y="68.054970056" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">AS</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="19.09962232000001" y="78.10740285600001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• acts in the role of a Security Token Service (STS)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="19.09962232000001" y="88.15983565600001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports the Token Exchange extension of OAuth 2.0</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="19.09962232000001" y="98.21226845600002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports Mutual-TLS Client Certificate-Bound Access Tokens extension of OAuth 2.0</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 390.28902003919274 122.33810717599998 L 806.3553171638803 122.33810717599998 L 815.4025066838802 131.38529669599998 L 815.4025066838802 205.773299416 L 390.28902003919274 205.773299416 L 390.28902003919274 122.33810717599998 M 806.3553171638803 122.33810717599998 L 806.3553171638803 131.38529669599998 L 815.4025066838802 131.38529669599998" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="404.3624259591927" y="136.411513096" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="404.3624259591927" y="146.46394589599998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses self-signed or CA-signed certificate,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="404.3624259591927" y="156.51637869599998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  the CN attribute of the public client certificate is used as a global client identifier</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="404.3624259591927" y="166.56881149599997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  in respect of the service it represents, e.g., CN=_smtp-client.foo.127.0.0.1.nip.io</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="404.3624259591927" y="176.62124429599996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports Mutual-TLS Client Certificate-Bound Access Tokens extension of OAuth 2.0</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="404.3624259591927" y="186.67367709599995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is registered at the AS as a confidential client</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="404.3624259591927" y="196.72610989599994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• acts as a client in respect of the RS</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 763.3351488736979 220.85194861599996 L 1179.4014459983853 220.85194861599996 L 1188.4486355183853 229.89913813599995 L 1188.4486355183853 284.18227525599997 L 763.3351488736979 284.18227525599997 L 763.3351488736979 220.85194861599996 M 1179.4014459983853 220.85194861599996 L 1179.4014459983853 229.89913813599995 L 1188.4486355183853 229.89913813599995" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="777.4085547936979" y="234.92535453599996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RS:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="777.4085547936979" y="244.97778733599995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports Mutual-TLS Client Certificate-Bound Access Tokens extension of OAuth 2.0</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="777.4085547936979" y="255.03022013599994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses the information in the assertion to identify the user</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="777.4085547936979" y="265.08265293599993" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  and makes authorization decisions using a local ABAC engine</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="777.4085547936979" y="275.13508573599995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• should support the AS issuer discovery mechanism</text></g><g><g><rect fill="white" stroke="none" x="614.7411421748698" y="299.260924456" width="329.4824046446875" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="614.7411421748698" y="309.313357256" width="294.36573594351563" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="614.7411421748698" y="319.36579005600004" width="235.29907029410157" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="614.7411421748698" y="329.41822285600006" width="357.6323985411719" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="614.7411421748698" y="339.4706556560001" width="192.11573594351563" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="614.7411421748698" y="349.5230884560001" width="151.56573289175782" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="614.7411421748698" y="359.5755212560001" width="213.11573594351563" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="614.7411421748698" y="369.62795405600014" width="291.6990489317969" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="614.7411421748698" y="379.68038685600015" width="298.74906724234376" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="614.7411421748698" y="389.7328196560002" width="195.61573594351563" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="614.7411421748698" y="399.7852524560002" width="342.4490489317969" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="614.7411421748698" y="409.8376852560002" width="150.36573594351563" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="614.7411421748698" y="419.89011805600023" width="324.64906113882813" height="13.06816264"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="616.2490070948697" y="308.308113976" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. Client generates a token — a signed, using the Client's private key,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="616.2490070948697" y="318.36054677600004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    certificate-bound assertion in JWT format with these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="616.2490070948697" y="328.41297957600005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {iss, aud, sub, exp, nbf, cnf, act{sub}, tokens}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="616.2490070948697" y="338.4654123760001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • iss identifies who issues the token — CN from public Client's certificate,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="616.2490070948697" y="348.5178451760001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      e.g. _smtp-client.foo.127.0.0.1.nip.io</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="616.2490070948697" y="358.5702779760001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • aud identifies the target AS</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="616.2490070948697" y="368.62271077600013" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • sub identifies the user by email address,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="616.2490070948697" y="378.67514357600015" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      e.g. User Principal Name (UPN) from Active Directory (AD)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="616.2490070948697" y="388.7275763760002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      (Client impersonates the user by using their email address)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="616.2490070948697" y="398.7800091760002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • exp, nbf are the standard JWT claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="616.2490070948697" y="408.8324419760002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • cnf is the confirmation method with the hash of the client certificate</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="616.2490070948697" y="418.88487477600023" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      to which the token is bound</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="616.2490070948697" y="428.93730757600025" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • tokens (optional) holds an embedded JWT from the previous hop</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 602.8457633615365 432.958280696 L 643.0554945615364 432.958280696 L 643.0554945615364 446.026443336 L 611.1222663668698 446.026443336" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray=""/><g transform="translate(602.8457633615365,446.026443336) translate(-602.8457633615365,-446.026443336)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 611.2227906948698 441.83792966933333 L 602.8457633615365 446.026443336 L 611.2227906948698 450.21495700266667 Z"/></g></g><g><g><rect fill="white" stroke="none" x="250.35649051842447" y="461.105092536" width="314.9490489317969" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="250.35649051842447" y="471.157525336" width="319.71574204703126" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="250.35649051842447" y="481.209958136" width="148.86573594351563" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="250.35649051842447" y="491.26239093600003" width="312.7324046446875" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="250.35649051842447" y="501.31482373600005" width="127.69906419058594" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="250.35649051842447" y="511.36725653600007" width="299.43238633414063" height="13.06816264"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="251.86435543842447" y="470.152282056" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. Send an HTTP request to the AS STS token endpoint using mTLS</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="251.86435543842447" y="480.204714856" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • grant_type = urn:ietf:params:oauth:grant-type:token-exchange</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="251.86435543842447" y="490.25714765600003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • resource = a target RS URI</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="251.86435543842447" y="500.30958045600005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • requested_token_type = urn:ietf:params:oauth:token-type:jwt</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="251.86435543842447" y="510.36201325600007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • subject_token = token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="251.86435543842447" y="520.4144460560001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • subject_token_type = urn:ietf:params:oauth:token-type:jwt</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 602.8457633615365 524.435419176 L 225.85946272767708 524.435419176" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray=""/><g transform="translate(217.58295972234376,524.435419176) translate(-217.58295972234376,-524.435419176)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 225.9599870556771 520.2469055093333 L 217.58295972234376 524.435419176 L 225.9599870556771 528.6239328426667 Z"/></g></g><g><g><rect fill="white" stroke="none" x="229.4783385356771" y="539.5140683760001" width="121.88239854117188" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="229.4783385356771" y="549.5665011760001" width="278.49906724234376" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="229.4783385356771" y="559.6189339760001" width="181.08239548941407" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="229.4783385356771" y="569.6713667760001" width="369.8490733458594" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="229.4783385356771" y="579.7237995760001" width="242.99906724234376" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="229.4783385356771" y="589.7762323760002" width="186.01572984" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="229.4783385356771" y="599.8286651760002" width="202.13239854117188" height="13.06816264"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="230.9862034556771" y="548.5612578960001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. Authorization decision:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="230.9862034556771" y="558.6136906960002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    1. authenticate the client using the specified credentials</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="230.9862034556771" y="568.6661234960002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    2. evaluate the resource parameter</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="230.9862034556771" y="578.7185562960002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    3. verify the subject_token signature using the Client's certificate public key</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="230.9862034556771" y="588.7709890960002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    4. validate the subject_token proof-of-possession</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="230.9862034556771" y="598.8234218960002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    5. evaluate the subject_token claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="230.9862034556771" y="608.8758546960003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    6. (optional) evaluate embedded tokens</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 217.58295972234376 612.896827816 L 257.79269092234375 612.896827816 L 257.79269092234375 625.964990456 L 225.85946272767708 625.964990456" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray=""/><g transform="translate(217.58295972234376,625.964990456) translate(-217.58295972234376,-625.964990456)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 225.9599870556771 621.7764767893333 L 217.58295972234376 625.964990456 L 225.9599870556771 630.1535041226667 Z"/></g></g><g><g><rect fill="white" stroke="none" x="229.4783385356771" y="641.043639656" width="318.93238633414063" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="229.4783385356771" y="651.096072456" width="165.78239243765626" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="229.4783385356771" y="661.148505256" width="235.29907029410157" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="229.4783385356771" y="671.200938056" width="252.4324015929297" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="229.4783385356771" y="681.2533708560001" width="284.1657237364844" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="229.4783385356771" y="691.3058036560001" width="131.61573594351563" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="229.4783385356771" y="701.3582364560001" width="210.14906113882813" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="229.4783385356771" y="711.4106692560001" width="234.2157267882422" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="229.4783385356771" y="721.4631020560001" width="195.61573594351563" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="229.4783385356771" y="731.5155348560002" width="342.4490489317969" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="229.4783385356771" y="741.5679676560002" width="150.36573594351563" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="229.4783385356771" y="751.6204004560002" width="315.53239243765626" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="229.4783385356771" y="761.6728332560002" width="285.8490733458594" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="229.4783385356771" y="771.7252660560002" width="279.08241074820313" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="229.4783385356771" y="781.7776988560003" width="350.83241074820313" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="229.4783385356771" y="791.8301316560003" width="324.64906113882813" height="13.06816264"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="230.9862034556771" y="650.090829176" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. AS STS generates a token — a signed certificate-bound assertion</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="230.9862034556771" y="660.1432619760001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    in JWT format with these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="230.9862034556771" y="670.1956947760001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {iss, aud, sub, exp, nbf, cnf, act{sub}, tokens}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="230.9862034556771" y="680.2481275760001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • iss is the URI that identifies who issues the token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="230.9862034556771" y="690.3005603760001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • aud identifies the target service and it is the value from</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="230.9862034556771" y="700.3529931760002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      the resource parameter</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="230.9862034556771" y="710.4054259760002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • sub identifies the user by email address</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="230.9862034556771" y="720.4578587760002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      retrieved through subject_token introspection</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="230.9862034556771" y="730.5102915760002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • exp, nbf are the standard JWT claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="230.9862034556771" y="740.5627243760002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • cnf is the confirmation method with the hash of the client certificate</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="230.9862034556771" y="750.6151571760003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      to which the token is bound</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="230.9862034556771" y="760.6675899760003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • act{sub} is the global client identifier in respect of the service</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="230.9862034556771" y="770.7200227760003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      it represents, copied from the CN attribute of the client's</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="230.9862034556771" y="780.7724555760003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      public certificate, e.g., _smtp-client.foo.127.0.0.1.nip.io</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="230.9862034556771" y="790.8248883760003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      (act identifies the acting party to whom authority has been delegated)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="230.9862034556771" y="800.8773211760004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • tokens (optional) holds an embedded JWT from the previous hop</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 217.58295972234376 804.898294296 L 257.79269092234375 804.898294296 L 257.79269092234375 817.966456936 L 225.85946272767708 817.966456936" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray=""/><g transform="translate(217.58295972234376,817.966456936) translate(-217.58295972234376,-817.966456936)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 225.9599870556771 813.7779432693333 L 217.58295972234376 817.966456936 L 225.9599870556771 822.1549706026667 Z"/></g></g><g><g><rect fill="white" stroke="none" x="266.38983097252606" y="833.045106136" width="93.13239854117188" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="266.38983097252606" y="843.097538936" width="111.88239854117188" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="266.38983097252606" y="853.149971736" width="287.64906113882813" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="266.38983097252606" y="863.202404536" width="98.81573289175782" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="266.38983097252606" y="873.254837336" width="94.34906571646485" height="13.06816264"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="267.89769589252603" y="842.092295656" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. Return the token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="267.89769589252603" y="852.144728456" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{"access_token":token,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="267.89769589252603" y="862.1971612560001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> "issued_token_type":"urn:ietf:params:oauth:token-type:jwt",</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="267.89769589252603" y="872.2495940560001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> "token_type":"N_A",</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="267.89769589252603" y="882.3020268560001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> "expires_in":3600}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 217.58295972234376 886.322999976 L 594.5692603562031 886.322999976" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray=""/><g transform="translate(602.8457633615365,886.322999976) translate(-602.8457633615365,-886.322999976)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 594.4687360282031 882.1344863093333 L 602.8457633615365 886.322999976 L 594.4687360282031 890.5115136426667 Z"/></g></g><g><g><rect fill="white" stroke="none" x="643.7359628587891" y="901.4016491760001" width="291.26572984" height="13.06816264"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="645.2438277787891" y="910.4488386960002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. Send an HTTP request to the RS with the token using mTLS</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 602.8457633615365 914.4698118160001 L 967.6153891907084 914.4698118160001" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray=""/><g transform="translate(975.8918921960417,914.4698118160001) translate(-975.8918921960417,-914.4698118160001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 967.5148648627084 910.2812981493333 L 975.8918921960417 914.4698118160001 L 967.5148648627084 918.6583254826668 Z"/></g></g><g><g><rect fill="white" stroke="none" x="987.787271009375" y="929.548461016" width="118.73239701529297" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="987.787271009375" y="939.600893816" width="147.24906724234376" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="987.787271009375" y="949.6533266160001" width="157.23238938589844" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="987.787271009375" y="959.7057594160001" width="202.13239854117188" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="987.787271009375" y="969.7581922160001" width="258.0990580870703" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="987.787271009375" y="979.8106250160001" width="308.99906724234376" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="987.787271009375" y="989.8630578160002" width="24.415729458530272" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="987.787271009375" y="999.9154906160002" width="236.13239854117188" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="987.787271009375" y="1009.9679234160002" width="197.76572984" height="13.06816264"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="989.295135929375" y="938.5956505360001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7. Authorization decision</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="989.295135929375" y="948.6480833360001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    1. verify the token signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="989.295135929375" y="958.7005161360001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    2. validate proof-of-possession</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="989.295135929375" y="968.7529489360002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    3. (optional) evaluate embedded tokens</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="989.295135929375" y="978.8053817360002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    4. use WebFinger to locate the AS for the user using</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="989.295135929375" y="988.8578145360002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">        its identifier and verify that the AS matches the token issuer</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="989.295135929375" y="998.9102473360002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    or</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="989.295135929375" y="1008.9626801360002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">        the domain part of the users's email address</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="989.295135929375" y="1019.0151129360003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">        and the AS host domain must match</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 975.8918921960417 1023.036086056 L 1016.1016233960416 1023.036086056 L 1016.1016233960416 1036.104248696 L 984.168395201375 1036.104248696" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray=""/><g transform="translate(975.8918921960417,1036.104248696) translate(-975.8918921960417,-1036.104248696)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 984.268919529375 1031.9157350293333 L 975.8918921960417 1036.104248696 L 984.268919529375 1040.2927623626667 Z"/></g></g><g><g><rect fill="white" stroke="none" x="636.4942941576172" y="1051.182897896" width="305.74906724234376" height="13.06816264"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="638.0021590776172" y="1060.2300874159998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8. Return the HTTP response, typically with 200, 201 status code</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 975.8918921960417 1064.251060536 L 611.1222663668698 1064.251060536" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray=""/><g transform="translate(602.8457633615365,1064.251060536) translate(-602.8457633615365,-1064.251060536)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 611.2227906948698 1060.0625468693333 L 602.8457633615365 1064.251060536 L 611.2227906948698 1068.4395742026668 Z"/></g></g></g></g></svg>