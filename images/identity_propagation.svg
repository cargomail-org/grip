<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="2167" height="1554"><desc>participant%20%22IdP%20%2B%20STS%22%20as%20IdP-STS%0Aparticipant%20%22Identity%20Propagator%22%20as%20Propagator%0Aparticipant%20%22RP%22%20as%20RP%0A%0Abottomparticipants%0A%0Anote%20over%20IdP-STS%3AIdP%20%2B%20STS%3A%5Cn%E2%80%A2%20both%20act%20as%20the%20same%20authority%0Anote%20over%20Propagator%3AIdentity%20Propagator%3A%5Cn%E2%80%A2%20runs%20as%20a%20client%20service%20on%20its%20own%20URI%20with%20ability%20to%20issue%20tokens%5Cn%E2%80%A2%20generates%20its%20own%20public%20and%20private%20key%20pair%20to%20sign%20assertions%20and%20authenticate%20to%20IdPs%20and%20RPs%5Cn%E2%80%A2%20public%20keys%20are%20published%20at%20the%20propagator's%20well-known%20URI%5Cn%E2%80%A2%20client_id%20is%20the%20propagator%20URI%5Cn%E2%80%A2%20uses%20a%20private_key_jwt%20client%20authentication%20method%20to%20authenticate%20to%20IdPs%20and%20RPs%5Cn%E2%80%A2%20acts%20as%20a%20Relying%20Party%20in%20respect%20of%20the%20IdP%20in%20order%20to%20obtain%20an%20access_token_with_user_claims%0Anote%20over%20RP%3ARP%3A%5Cn%E2%80%A2%20is%20a%20resource%20server%20using%20the%20local%20ABAC%20engine%20to%20automate%20authorization%20assessment%0APropagator-%3EPropagator%3A1.%20Generate%20the%20actor_token%20with%20these%20claims%3A%5Cn%20%20%20%20%7Biss%2C%20aud%2C%20sub%2C%20exp%2C%20nbf%7D%5Cn%20%20%20%20iss%20is%20the%20client_id%5Cn%20%20%20%20aud%20is%20the%20URI%20that%20identifies%20the%20RP%5Cn%20%20%20%20sub%20is%20the%20client_id%5Cn%20%20%20%20exp%2C%20nbf%20are%20the%20standard%20JWT%20claims%0APropagator-%3EPropagator%3A2.%20Generate%20the%20authentication_token%20with%20these%20claims%3A%5Cn%20%20%20%20%7Biss%2C%20sub%2C%20aud%2C%20jti%2C%20exp%7D%5Cn%20%20%20%20iss%20is%20the%20client_id%5Cn%20%20%20%20aud%20is%20the%20URI%20that%20identifies%20the%20IdP%5Cn%20%20%20%20sub%20is%20the%20client_id%5Cn%20%20%20%20jti%2C%20exp%20are%20the%20standard%20JWT%20claims%0AIdP-STS%3C-Propagator%3A3.%20Send%20an%20HTTP%20request%20to%20get%20an%20identity_token%20with%20the%20actor_token%20in%20the%20header%5Cn%20%20%20%20using%20the%20private_key_jwt%20client%20authentication%20method%5Cn%20%20%20%20%7Bgrant_type%20%3D%20token-exchange%2C%5Cn%20%20%20%20%20requested_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Ajwt%2C%5Cn%20%20%20%20%20subject_token%20%3D%20access_token_with_user_claims%2C%5Cn%20%20%20%20%20subject_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Aaccess_token%2C%5Cn%20%20%20%20%20actor_token%20%3D%20actor_token%2C%5Cn%20%20%20%20%20actor_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Ajwt%7D%0AIdP-STS-%3EIdP-STS%3A4.%20Authorization%20assessment%5Cn%20%20%20%201.%20verify%20the%20authentication_token%20signature%20using%20the%20propagator's%20public%20keys%5Cn%20%20%20%20%20%20%20%20published%20at%20the%20propagator's%20well%20known%20URI%2C%20and%20evaluate%20claims%5Cn%20%20%20%202.%20verify%20the%20actor_token%20signature%20using%20the%20propagator's%20public%20keys%5Cn%20%20%20%20%20%20%20%20published%20at%20the%20propagator's%20well%20known%20URI%2C%20and%20evaluate%20claims%5Cn%20%20%20%203.%20verify%20the%20access_token_with_user_claims%20signature%20and%20evaluate%20claims%20%0A%0AIdP-STS-%3EIdP-STS%3A5.%20STS%20generates%20the%20identity_token%20with%20these%20claims%3A%5Cn%20%20%20%20%7Biss%2C%20aud%2C%20sub%2C%20exp%2C%20nbf%2C%20act%7Bsub%7D%7D%5Cn%20%20%20%20iss%20is%20the%20URI%20that%20identifies%20who%20issues%20the%20identity_token%5Cn%20%20%20%20aud%20identifies%20the%20target%20service%20and%20it%20is%20the%20aud%20claim%20value%20extracted%20from%20the%20actor_token%5Cn%20%20%20%20sub%20identifies%20the%20principal%20by%20an%20email%20address%20that%20is%20extracted%20from%20the%20access_token_with_user_claims%5Cn%20%20%20%20exp%2C%20nbf%20are%20the%20standard%20JWT%20claims%5Cn%20%20%20%20act%7Bsub%7D%20is%20the%20sub%20value%20extracted%20from%20the%20actor_token%0APropagator%3C-IdP-STS%3A6.%20Return%20the%20identity_token%0A%0APropagator-%3EPropagator%3A7.%20Generate%20the%20authentication_token%20with%20these%20claims%3A%5Cn%20%20%20%20%7Biss%2C%20sub%2C%20aud%2C%20jti%2C%20exp%7D%5Cn%20%20%20%20iss%20is%20the%20client_id%5Cn%20%20%20%20aud%20is%20the%20URI%20that%20identifies%20the%20RP%5Cn%20%20%20%20sub%20is%20the%20client_id%5Cn%20%20%20%20jti%2C%20exp%20are%20the%20standard%20JWT%20claims%0APropagator-%3ERP%3A8.%20Send%20an%20HTTP%20request%20to%20the%20RP%20with%20the%20identity_token%20in%20the%20header%5Cn%20%20%20%20using%20the%20private_key_jwt%20client%20authentication%20method%0Aiss%20is%20the%20URI%20that%20identifies%20who%20issues%20the%20authentication_token%0ARP-%3ERP%3A9.%20Authorization%20assessment%5Cn%20%20%20%201.%20verify%20the%20authentication_token%20signature%20using%20the%20propagator's%20public%20keys%5Cn%20%20%20%20%20%20%20%20published%20at%20the%20propagator's%20well%20known%20URI%2C%20and%20evaluate%20claims%5Cn%20%20%20%202.%20verify%20the%20identity_token%20signature%20and%20evaluate%20claims%0ARP-%3EPropagator%3A10.%20Return%20the%20HTTP%20response%2C%20typically%20with%20200%2C%20201%20status%20code%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="2167" height="1554"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 148.82443653175784 50.815047804 L 148.82443653175784 1501.3811008439998" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 971.6186511458204 50.815047804 L 971.6186511458204 1501.3811008439998" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1541.7117441622268 50.815047804 L 1541.7117441622268 1501.3811008439998" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 96.59743726328324 10.253481456000003 L 201.05143580023247 10.253481456000003 L 201.05143580023247 50.815047804 L 96.59743726328324 50.815047804 L 96.59743726328324 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="112.95777164528323" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IdP + STS</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 884.4749839391134 10.253481456000003 L 1058.7623183525275 10.253481456000003 L 1058.7623183525275 50.815047804 L 884.4749839391134 50.815047804 L 884.4749839391134 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="900.8353183211134" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Identity Propagator</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1515.8264101616965 10.253481456000003 L 1567.597078162757 10.253481456000003 L 1567.597078162757 50.815047804 L 1515.8264101616965 50.815047804 L 1515.8264101616965 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1532.1867445436965" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RP</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 96.59743726328324 1501.3811008439998 L 201.05143580023247 1501.3811008439998 L 201.05143580023247 1541.9426671919998 L 96.59743726328324 1541.9426671919998 L 96.59743726328324 1501.3811008439998 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="112.95777164528323" y="1526.8640179919998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IdP + STS</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 884.4749839391134 1501.3811008439998 L 1058.7623183525275 1501.3811008439998 L 1058.7623183525275 1541.9426671919998 L 884.4749839391134 1541.9426671919998 L 884.4749839391134 1501.3811008439998 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="900.8353183211134" y="1526.8640179919998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Identity Propagator</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1515.8264101616965 1501.3811008439998 L 1567.597078162757 1501.3811008439998 L 1567.597078162757 1541.9426671919998 L 1515.8264101616965 1541.9426671919998 L 1515.8264101616965 1501.3811008439998 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1532.1867445436965" y="1526.8640179919998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RP</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 7.5393246000000005 80.97234620399999 L 276.5387641835157 80.97234620399999 L 290.1095484635157 94.54313048399999 L 290.1095484635157 130.731888564 L 7.5393246000000005 130.731888564 L 7.5393246000000005 80.97234620399999 M 276.5387641835157 80.97234620399999 L 276.5387641835157 94.54313048399999 L 290.1095484635157 94.54313048399999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.649433480000027" y="102.08245508399999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IdP + STS:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.649433480000027" y="117.16110428399999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• both act as the same authority</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 586.8001987599611 153.349862364 L 1342.86631925168 153.349862364 L 1356.43710353168 166.920646644 L 1356.43710353168 278.502650724 L 586.8001987599611 278.502650724 L 586.8001987599611 153.349862364 M 1342.86631925168 153.349862364 L 1342.86631925168 166.920646644 L 1356.43710353168 166.920646644" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="607.910307639961" y="174.45997124399997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Identity Propagator:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="607.910307639961" y="189.53862044399997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• runs as a client service on its own URI with ability to issue tokens</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="607.910307639961" y="204.61726964399998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• generates its own public and private key pair to sign assertions and authenticate to IdPs and RPs</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="607.910307639961" y="219.69591884399998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• public keys are published at the propagator's well-known URI</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="607.910307639961" y="234.77456804399998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• client_id is the propagator URI</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="607.910307639961" y="249.85321724399998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses a private_key_jwt client authentication method to authenticate to IdPs and RPs</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="607.910307639961" y="264.931866444" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• acts as a Relying Party in respect of the IdP in order to obtain an access_token_with_user_claims</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1191.5099604775394 301.120624524 L 1878.3427435669144 301.120624524 L 1891.9135278469143 314.691408804 L 1891.9135278469143 350.880166884 L 1191.5099604775394 350.880166884 L 1191.5099604775394 301.120624524 M 1878.3427435669144 301.120624524 L 1878.3427435669144 314.691408804 L 1891.9135278469143 314.691408804" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1212.6200693575393" y="322.23073340400003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RP:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1212.6200693575393" y="337.309382604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is a resource server using the local ABAC engine to automate authorization assessment</text></g><g><g><rect fill="white" stroke="none" x="989.4617193658205" y="373.498140684" width="349.3402756682031" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="989.4617193658205" y="388.57678988400005" width="202.99025430589845" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="989.4617193658205" y="403.655439084" width="153.4402665129297" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="989.4617193658205" y="418.734088284" width="284.9402512541406" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="989.4617193658205" y="433.81273748399997" width="160.32359781175782" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="989.4617193658205" y="448.89138668399994" width="294.25693216234373" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="387.0689249640001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. Generate the actor_token with these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="402.14757416400005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {iss, aud, sub, exp, nbf}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="417.226223364" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    iss is the client_id</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="432.304872564" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    aud is the URI that identifies the RP</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="447.38352176399997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    sub is the client_id</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="462.46217096399994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    exp, nbf are the standard JWT claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 971.6186511458204 468.493630644 L 1031.9332479458203 468.493630644 L 1031.9332479458203 488.095874604 L 984.0334056538204 488.095874604" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(971.6186511458204,488.095874604) translate(-971.6186511458204,-488.095874604)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 984.1841921458205 481.813104104 L 971.6186511458204 488.095874604 L 984.1841921458205 494.37864510400004 Z"/></g></g><g><g><rect fill="white" stroke="none" x="989.4617193658205" y="510.71384840400003" width="418.1902512541406" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="989.4617193658205" y="525.792497604" width="193.12360086351563" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="989.4617193658205" y="540.871146804" width="153.4402665129297" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="989.4617193658205" y="555.949796004" width="288.39026346117186" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="989.4617193658205" y="571.0284452039999" width="160.32359781175782" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="989.4617193658205" y="586.1070944039999" width="284.39026346117186" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="524.284632684" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. Generate the authentication_token with these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="539.363281884" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {iss, sub, aud, jti, exp}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="554.441931084" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    iss is the client_id</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="569.520580284" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    aud is the URI that identifies the IdP</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="584.5992294839999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    sub is the client_id</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="599.6778786839999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    jti, exp are the standard JWT claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 971.6186511458204 605.709338364 L 1031.9332479458203 605.709338364 L 1031.9332479458203 625.311582324 L 984.0334056538204 625.311582324" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(971.6186511458204,625.311582324) translate(-971.6186511458204,-625.311582324)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 984.1841921458205 619.0288118240001 L 971.6186511458204 625.311582324 L 984.1841921458205 631.594352824 Z"/></g></g><g><g><rect fill="white" stroke="none" x="247.96807775761724" y="647.929556124" width="624.5069321623438" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.96807775761724" y="663.008205324" width="427.9902695646875" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.96807775761724" y="678.0868545239999" width="255.84026040941407" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.96807775761724" y="693.1655037239999" width="487.95691385179686" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.96807775761724" y="708.2441529239999" width="385.85693826585936" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.96807775761724" y="723.3228021239998" width="542.9902695646875" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.96807775761724" y="738.4014513239998" width="226.52359476" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.96807775761724" y="753.4801005239998" width="456.29025735765623" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="250.22987513761723" y="661.500340404" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. Send an HTTP request to get an identity_token with the actor_token in the header</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="250.22987513761723" y="676.578989604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    using the private_key_jwt client authentication method</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="250.22987513761723" y="691.6576388039999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {grant_type = token-exchange,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="250.22987513761723" y="706.7362880039999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     requested_token_type = urn:ietf:params:oauth:token-type:jwt,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="250.22987513761723" y="721.8149372039999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     subject_token = access_token_with_user_claims,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="250.22987513761723" y="736.8935864039998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     subject_token_type = urn:ietf:params:oauth:token-type:access_token,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="250.22987513761723" y="751.9722356039998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     actor_token = actor_token,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="250.22987513761723" y="767.0508848039998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">     actor_token_type = urn:ietf:params:oauth:token-type:jwt}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 971.6186511458204 773.082344484 L 161.23919103975783 773.082344484" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(148.82443653175784,773.082344484) translate(-148.82443653175784,-773.082344484)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 161.38997753175784 766.7995739840001 L 148.82443653175784 773.082344484 L 161.38997753175784 779.365114984 Z"/></g></g><g><g><rect fill="white" stroke="none" x="166.66750475175783" y="795.700318284" width="213.14026346117188" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="810.778967484" width="603.1569565764063" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="825.8576166839999" width="532.9736069670313" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="840.9362658839999" width="534.3069199553125" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="856.0149150839999" width="532.9736069670313" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="871.0935642839999" width="577.9069565764063" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="809.271102564" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. Authorization assessment</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="824.349751764" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    1. verify the authentication_token signature using the propagator's public keys</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="839.4284009639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">        published at the propagator's well known URI, and evaluate claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="854.5070501639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    2. verify the actor_token signature using the propagator's public keys</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="869.5856993639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">        published at the propagator's well known URI, and evaluate claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="884.6643485639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    3. verify the access_token_with_user_claims signature and evaluate claims </text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 148.82443653175784 890.695808244 L 209.13903333175784 890.695808244 L 209.13903333175784 910.298052204 L 161.23919103975783 910.298052204" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(148.82443653175784,910.298052204) translate(-148.82443653175784,-910.298052204)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 161.38997753175784 904.015281704 L 148.82443653175784 910.298052204 L 161.38997753175784 916.580822704 Z"/></g></g><g><g><rect fill="white" stroke="none" x="166.66750475175783" y="932.916026004" width="405.39026346117186" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="947.9946752039999" width="280.0569199553125" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="963.0733244039999" width="447.02359476" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="978.1519736039999" width="704.8069199553125" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="993.2306228039998" width="799.6736191740625" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="1008.3092720039998" width="294.25693216234373" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="166.66750475175783" y="1023.3879212039998" width="445.2402695646875" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="946.486810284" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. STS generates the identity_token with these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="961.5654594839999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {iss, aud, sub, exp, nbf, act{sub}}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="976.6441086839999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    iss is the URI that identifies who issues the identity_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="991.7227578839999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    aud identifies the target service and it is the aud claim value extracted from the actor_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="1006.8014070839998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    sub identifies the principal by an email address that is extracted from the access_token_with_user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="1021.8800562839998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    exp, nbf are the standard JWT claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="168.92930213175782" y="1036.958705484" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    act{sub} is the sub value extracted from the actor_token</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 148.82443653175784 1042.990165164 L 209.13903333175784 1042.990165164 L 209.13903333175784 1062.592409124 L 161.23919103975783 1062.592409124" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(148.82443653175784,1062.592409124) translate(-148.82443653175784,-1062.592409124)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 161.38997753175784 1056.309638624 L 148.82443653175784 1062.592409124 L 161.38997753175784 1068.8751796239999 Z"/></g></g><g><g><rect fill="white" stroke="none" x="455.393080809375" y="1085.210382924" width="209.65692605882813" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="457.65487818937504" y="1098.781167204" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. Return the identity_token</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 148.82443653175784 1104.8126268839999 L 959.2038966378204 1104.8126268839999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(971.6186511458204,1104.8126268839999) translate(-971.6186511458204,-1104.8126268839999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 959.0531101458204 1098.529856384 L 971.6186511458204 1104.8126268839999 L 959.0531101458204 1111.0953973839999 Z"/></g></g><g><g><rect fill="white" stroke="none" x="989.4617193658205" y="1127.4306006839997" width="418.1902512541406" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="989.4617193658205" y="1142.5092498839997" width="193.12360086351563" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="989.4617193658205" y="1157.5878990839997" width="153.4402665129297" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="989.4617193658205" y="1172.6665482839996" width="284.9402512541406" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="989.4617193658205" y="1187.7451974839996" width="160.32359781175782" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="989.4617193658205" y="1202.8238466839996" width="284.39026346117186" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="1141.0013849639997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7. Generate the authentication_token with these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="1156.0800341639997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {iss, sub, aud, jti, exp}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="1171.1586833639997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    iss is the client_id</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="1186.2373325639996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    aud is the URI that identifies the RP</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="1201.3159817639996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    sub is the client_id</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="1216.3946309639996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    jti, exp are the standard JWT claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 971.6186511458204 1222.426090644 L 1031.9332479458203 1222.426090644 L 1031.9332479458203 1242.0283346039998 L 984.0334056538204 1242.0283346039998" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(971.6186511458204,1242.0283346039998) translate(-971.6186511458204,-1242.0283346039998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 984.1841921458205 1235.7455641039999 L 971.6186511458204 1242.0283346039998 L 984.1841921458205 1248.3111051039998 Z"/></g></g><g><g><rect fill="white" stroke="none" x="989.4617193658205" y="1264.6463084039997" width="534.4069565764063" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="989.4617193658205" y="1279.7249576039997" width="427.9902695646875" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="1278.2170926839997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8. Send an HTTP request to the RP with the identity_token in the header</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="991.7235167458205" y="1293.2957418839997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    using the private_key_jwt client authentication method</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 971.6186511458204 1299.3272015639998 L 1529.2969896542268 1299.3272015639998" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1541.7117441622268,1299.3272015639998) translate(-1541.7117441622268,-1299.3272015639998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1529.1462031622268 1293.0444310639998 L 1541.7117441622268 1299.3272015639998 L 1529.1462031622268 1305.6099720639997 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1559.5548123822268" y="1321.9451753639999" width="213.14026346117188" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1559.5548123822268" y="1337.0238245639998" width="603.1569565764063" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1559.5548123822268" y="1352.1024737639998" width="532.9736069670313" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1559.5548123822268" y="1367.1811229639998" width="447.47360696703123" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1561.8166097622268" y="1335.5159596439998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">9. Authorization assessment</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1561.8166097622268" y="1350.5946088439998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    1. verify the authentication_token signature using the propagator's public keys</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1561.8166097622268" y="1365.6732580439998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">        published at the propagator's well known URI, and evaluate claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1561.8166097622268" y="1380.7519072439998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    2. verify the identity_token signature and evaluate claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1541.7117441622268 1386.783366924 L 1602.0263409622266 1386.783366924 L 1602.0263409622266 1406.3856108839998 L 1554.1264986702267 1406.3856108839998" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1541.7117441622268,1406.3856108839998) translate(-1541.7117441622268,-1406.3856108839998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1554.2772851622267 1400.1028403839998 L 1541.7117441622268 1406.3856108839998 L 1554.2772851622267 1412.6683813839998 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1011.5617407281252" y="1429.0035846839999" width="490.20691385179686" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1013.8235381081251" y="1442.5743689639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">10. Return the HTTP response, typically with 200, 201 status code</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1541.7117441622268 1448.6058286439998 L 984.0334056538204 1448.6058286439998" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(971.6186511458204,1448.6058286439998) translate(-971.6186511458204,-1448.6058286439998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 984.1841921458205 1442.3230581439998 L 971.6186511458204 1448.6058286439998 L 984.1841921458205 1454.8885991439997 Z"/></g></g></g></g></svg>