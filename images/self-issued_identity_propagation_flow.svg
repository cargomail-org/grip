<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1267" height="1104"><desc>participant%20%22client%5Cn(foo.com)%22%20as%20Client%0Aparticipant%20%22server%5Cn(bar.com)%22%20as%20Server%0A%0Abottomparticipants%0A%0Afontfamily%20arial%0A%0Aentryspacing%201.0%0Anote%20over%20Client%3Aclient%3A%5Cn%E2%80%A2%20supports%20mTLS%20authentication%20with%20X.509%20certificates%5Cn%E2%80%A2%20uses%20a%20self-signed%20certificate%20with%20a%20certificate%20extension%20containing%5Cn%20%20%20a%20custom%20OID%20and%20ASN1%3AUTF8String%20value%20that%20serves%20as%20a%20global%5Cn%20%20%20client%20identifier%20in%20respect%20of%20the%20service%20it%20represents%2C%5Cn%20%20%20e.g.%2C%201.2.3.4.5.6.7.8%3DASN1%3AUTF8String%3Aclient._mhs._grip.foo.com%5Cn%E2%80%A2%20the%20client's%20public%20key%20fingerprint%20is%20published%20on%20the%20client%20domain%5Cn%20%20%20using%20DNS%20TXT%20record%2C%20e.g.%2C%20client._mhs._grip.foo.com%5Cn%20%20%20IN%20TXT%20%22v%3Dgrip1%3B%20h%3Dsha256%3B%20f%3Dd2abde240d7cd3ee6b%20...%20e971%22%0Anote%20over%20Server%3Aserver%3A%5Cn%E2%80%A2%20supports%20mTLS%20authentication%20with%20X.509%20certificates%5Cn%E2%80%A2%20uses%20a%20CA-signed%20certificate%20with%20an%20appropriate%20Subject%20Alternative%20Name%20(SAN)%5Cn%E2%80%A2%20uses%20a%20DNS%20SRV%20record%20to%20specify%20a%20host%20and%20port%20of%20the%20server%2C%20while%20identifies%20the%20respective%20service%2C%5Cn%20%20%20e.g.%2C%20_mhs._tcp.bar.com%20IN%20SRV%20100%201%202525%20mhs-server.bar.com%5Cn%E2%80%A2%20(optional)%20uses%20the%20information%20in%20the%20assertion%20to%20identify%20the%20principal%20(user)%0AClient-%3EClient%3A1.%20The%20client%20generates%20a%20security%20token%20%E2%80%94%20a%20signed%20(using%20the%20client's%20private%5Cn%20%20%20%20%20%20%20key)%20DNS-bound%20assertion%20in%20JWT%20format%20with%20these%20claims%3A%5Cn%20%20%20%20%E2%80%A2%20digest%3A%20a%20value%20of%20the%20digest%20of%20the%20digital%20resource%20(message%2C%20blob%20or%5Cn%20%20%20%20%20%20%20security%20token%20from%20the%20previous%20hop)%5Cn%20%20%20%20%E2%80%A2%20iat%3A%20the%20issued-at%20timestamp%20of%20the%20security%20token%5Cn%20%20%20%20%E2%80%A2%20iss%3A%20identifies%20who%20issues%20the%20security%20token%20%E2%80%94%20CN%20from%20the%20public%20client's%5Cn%20%20%20%20%20%20%20certificate%2C%20e.g.%2C%20foo.com%5Cn%20%20%20%20%E2%80%A2%20aud%3A%20identifies%20the%20target%20service%20by%20the%20DNS%20SRV%20record%2C%5Cn%20%20%20%20%20%20%20e.g.%2C%20_mhs._tcp.bar.com%5Cn%20%20%20%20%E2%80%A2%20sub%3A%20(optional)%20identifies%20the%20principal%20by%20email%20address%2C%5Cn%20%20%20%20%20%20%20e.g.%2C%20alice.baz.com%5Cn%20%20%20%20%E2%80%A2%20client%3A%20identifier%20of%20the%20authorized%20client%20A%20(e.g.%2C%20client._mhs._grip.baz.com)%5Cn%20%20%20%20%20%20%20that%20authorizes%20client%20B%20(e.g%2C%20client._mhs._grip.foo.com)%5Cn%20%20%20%20%20%20%20(optional)%20to%20act%20on%20behalf%20of%20the%20principal%20(e.g.%2C%20alice.baz.com)%5Cn%20%20%20%20%E2%80%A2%20jwks%3A%20holds%20the%20public%20key%20of%20the%20client%20certificate%20in%20the%20JWK%20Set%20format%5Cn%20%20%20%20%20%20%20(alternatively%20provide%20JWK%20Set%20by%20URI%20using%20jwks_uri%20claim)%5Cn%0AClient-%3EServer%3A2.%20Send%20an%20HTTPS%20request%20to%20the%20server%20with%20the%20security%20token%20using%20mTLS%0AServer-%3EServer%3A3.%20authorization%20decision%5Cn%20%20%20%20%E2%80%A2%20the%20client%20is%20authenticated%20via%20the%20DNS%20using%20the%20TXT%20record%5Cn%20%20%20%20%20%20%20and%20the%20custom%20OID%20value%20from%20the%20public%20client's%20certificate%5Cn%20%20%20%20%E2%80%A2%20verify%20the%20security%20token%20signature%5Cn%20%20%20%20%E2%80%A2%20validate%20proof-of-possession%5Cn%20%20%20%20%E2%80%A2%20verify%20the%20'aud'%20claim%5Cn%20%20%20%20%E2%80%A2%20(optional)%20validate%20the%20'client'%20claim%3B%20the%20domain%20part%20of%20the%20principal%5Cn%20%20%20%20%20%20%20email%20address%20and%20the%20domain%20part%20of%20the%20'client'%20claim%20value%5Cn%20%20%20%20%20%20%20must%20match%5Cn%20%20%20%20%E2%80%A2%20validate%20the%20digest%20of%20the%20digital%20resource%20against%20the%20'digest'%5Cn%20%20%20%20%20%20%20claim%20value%0AServer-%3EClient%3A4.%20Return%20the%20HTTP%20response%2C%20typically%20with%20200%2C%20201%20status%20code%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1267" height="1104"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 249.40919910499997 65.74291051200001 L 249.40919910499997 1036.807918992" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 782.4639620432812 65.74291051200001 L 782.4639620432812 1036.807918992" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 202.10113370493357 10.102694964000008 L 296.7172645050664 10.102694964000008 L 296.7172645050664 65.74291051200001 L 202.10113370493357 65.74291051200001 L 202.10113370493357 10.102694964000008 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="232.30189167091794" y="35.585612112" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">client</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="218.46146808693356" y="50.664261312" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(foo.com)</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 735.1560034547382 10.102694964000008 L 829.7719206318242 10.102694964000008 L 829.7719206318242 65.74291051200001 L 735.1560034547382 65.74291051200001 L 735.1560034547382 10.102694964000008 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="762.1040835032421" y="35.585612112" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="751.5163378367382" y="50.664261312" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(bar.com)</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 202.10113370493357 1036.807918992 L 296.7172645050664 1036.807918992 L 296.7172645050664 1092.44813454 L 202.10113370493357 1092.44813454 L 202.10113370493357 1036.807918992 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="232.30189167091794" y="1062.2908361399998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">client</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="218.46146808693356" y="1077.3694853399998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(foo.com)</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 735.1560034547382 1036.807918992 L 829.7719206318242 1036.807918992 L 829.7719206318242 1092.44813454 L 735.1560034547382 1092.44813454 L 735.1560034547382 1036.807918992 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="762.1040835032421" y="1062.2908361399998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="751.5163378367382" y="1077.3694853399998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">(bar.com)</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 7.5393246000000005 95.90020891200001 L 477.70828932999996 95.90020891200001 L 491.27907360999995 109.47099319200001 L 491.27907360999995 251.21029567200003 L 7.5393246000000005 251.21029567200003 L 7.5393246000000005 95.90020891200001 M 477.70828932999996 95.90020891200001 L 477.70828932999996 109.47099319200001 L 491.27907360999995 109.47099319200001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="117.01031779200002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">client:</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="132.08896699200002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports mTLS authentication with X.509 certificates</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="147.16761619200003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses a self-signed certificate with a certificate extension containing</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="162.24626539200003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   a custom OID and ASN1:UTF8String value that serves as a global</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="177.32491459200003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   client identifier in respect of the service it represents,</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="192.40356379200003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   e.g., 1.2.3.4.5.6.7.8=ASN1:UTF8String:client._mhs._grip.foo.com</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="207.48221299200003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• the client's public key fingerprint is published on the client domain</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="222.56086219200003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   using DNS TXT record, e.g., client._mhs._grip.foo.com</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="237.63951139200003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   IN TXT "v=grip1; h=sha256; f=d2abde240d7cd3ee6b ... e971"</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 424.9257830949218 273.82826947200004 L 1126.4313567116405 273.82826947200004 L 1140.0021409916405 287.39905375200004 L 1140.0021409916405 383.90240863200006 L 424.9257830949218 383.90240863200006 L 424.9257830949218 273.82826947200004 M 1126.4313567116405 273.82826947200004 L 1126.4313567116405 287.39905375200004 L 1140.0021409916405 287.39905375200004" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.0358919749218" y="294.9383783520001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">server:</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.0358919749218" y="310.01702755200006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports mTLS authentication with X.509 certificates</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.0358919749218" y="325.09567675200003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses a CA-signed certificate with an appropriate Subject Alternative Name (SAN)</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.0358919749218" y="340.174325952" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses a DNS SRV record to specify a host and port of the server, while identifies the respective service,</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.0358919749218" y="355.252975152" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   e.g., _mhs._tcp.bar.com IN SRV 100 1 2525 mhs-server.bar.com</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="446.0358919749218" y="370.33162435199995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• (optional) uses the information in the assertion to identify the principal (user)</text></g><g><g><rect fill="white" stroke="none" x="267.25226732499993" y="406.5203824320001" width="503.45869913011717" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="267.25226732499993" y="421.5990316320001" width="419.91521158128904" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="267.25226732499993" y="436.6776808320001" width="474.03169717699217" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="267.25226732499993" y="451.75633003200005" width="274.15422525316404" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="267.25226732499993" y="466.834979232" width="344.45842447191404" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="267.25226732499993" y="481.913628432" width="502.00595559984373" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="267.25226732499993" y="496.99227763199997" width="188.61410989671876" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="267.25226732499993" y="512.0709268319999" width="399.5910538664453" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="267.25226732499993" y="527.1495760319999" width="189.43687906175782" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="267.25226732499993" y="542.2282252319999" width="386.83845987230467" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="267.25226732499993" y="557.3068744319999" width="155.22247781664063" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="267.25226732499993" y="572.3855236319998" width="509.8350266447656" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="267.25226732499993" y="587.4641728319998" width="390.6456498137109" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="267.25226732499993" y="602.5428220319998" width="433.8486680021875" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="267.25226732499993" y="617.6214712319997" width="487.81486978441404" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="267.25226732499993" y="632.7001204319997" width="417.46773233324217" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="267.25226732499993" y="647.7787696319997" width="4.52359476" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="269.51406470499995" y="420.09116671200013" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. The client generates a security token — a signed (using the client's private</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="269.51406470499995" y="435.1698159120001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       key) DNS-bound assertion in JWT format with these claims:</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="269.51406470499995" y="450.2484651120001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • digest: a value of the digest of the digital resource (message, blob or</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="269.51406470499995" y="465.32711431200005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       security token from the previous hop)</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="269.51406470499995" y="480.405763512" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • iat: the issued-at timestamp of the security token</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="269.51406470499995" y="495.484412712" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • iss: identifies who issues the security token — CN from the public client's</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="269.51406470499995" y="510.56306191199997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       certificate, e.g., foo.com</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="269.51406470499995" y="525.6417111119999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • aud: identifies the target service by the DNS SRV record,</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="269.51406470499995" y="540.7203603119999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       e.g., _mhs._tcp.bar.com</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="269.51406470499995" y="555.7990095119999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • sub: (optional) identifies the principal by email address,</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="269.51406470499995" y="570.8776587119999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       e.g., alice.baz.com</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="269.51406470499995" y="585.9563079119998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • client: identifier of the authorized client A (e.g., client._mhs._grip.baz.com)</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="269.51406470499995" y="601.0349571119998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       that authorizes client B (e.g, client._mhs._grip.foo.com)</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="269.51406470499995" y="616.1136063119998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       (optional) to act on behalf of the principal (e.g., alice.baz.com)</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="269.51406470499995" y="631.1922555119997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • jwks: holds the public key of the client certificate in the JWK Set format</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="269.51406470499995" y="646.2709047119997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       (alternatively provide JWK Set by URI using jwks_uri claim)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 249.40919910499997 667.381013592 L 309.723795905 667.381013592 L 309.723795905 686.983257552 L 261.82395361299996 686.983257552" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(249.40919910499997,686.983257552) translate(-249.40919910499997,-686.983257552)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 261.97474010499997 680.7004870520001 L 249.40919910499997 686.983257552 L 261.97474010499997 693.266028052 Z"/></g></g><g><g><rect fill="white" stroke="none" x="267.252267325" y="709.601231352" width="497.36862649828123" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="269.514064705" y="723.172015632" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. Send an HTTPS request to the server with the security token using mTLS</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 249.40919910499997 729.203475312 L 770.0492075352812 729.203475312" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(782.4639620432812,729.203475312) translate(-782.4639620432812,-729.203475312)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 769.8984210432811 722.920704812 L 782.4639620432812 729.203475312 L 769.8984210432811 735.486245812 Z"/></g></g><g><g><rect fill="white" stroke="none" x="800.3070302632813" y="751.821449112" width="162.5863846769922" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="800.3070302632813" y="766.900098312" width="418.60559549242186" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="800.3070302632813" y="781.9787475119999" width="417.87564554125" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="800.3070302632813" y="797.0573967119999" width="248.33403482347657" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="800.3070302632813" y="812.1360459119999" width="213.3179062834375" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="800.3070302632813" y="827.2146951119998" width="161.87074746996095" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="800.3070302632813" y="842.2933443119998" width="461.6869553557031" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="800.3070302632813" y="857.3719935119998" width="420.70956888109373" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="800.3070302632813" y="872.4506427119998" width="108.77046670824218" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="800.3070302632813" y="887.5292919119997" width="416.9166916838281" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="800.3070302632813" y="902.6079411119997" width="106.33730020433593" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="802.5688276432812" y="765.392233392" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. authorization decision</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="802.5688276432812" y="780.470882592" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • the client is authenticated via the DNS using the TXT record</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="802.5688276432812" y="795.5495317919999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       and the custom OID value from the public client's certificate</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="802.5688276432812" y="810.6281809919999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • verify the security token signature</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="802.5688276432812" y="825.7068301919999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • validate proof-of-possession</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="802.5688276432812" y="840.7854793919998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • verify the 'aud' claim</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="802.5688276432812" y="855.8641285919998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • (optional) validate the 'client' claim; the domain part of the principal</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="802.5688276432812" y="870.9427777919998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       email address and the domain part of the 'client' claim value</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="802.5688276432812" y="886.0214269919998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       must match</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="802.5688276432812" y="901.1000761919997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • validate the digest of the digital resource against the 'digest'</text><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="802.5688276432812" y="916.1787253919997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       claim value</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 782.4639620432812 922.2101850720001 L 842.7785588432812 922.2101850720001 L 842.7785588432812 941.8124290320001 L 794.8787165512812 941.8124290320001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(782.4639620432812,941.8124290320001) translate(-782.4639620432812,-941.8124290320001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 795.0295030432812 935.5296585320001 L 782.4639620432812 941.8124290320001 L 795.0295030432812 948.095199532 Z"/></g></g><g><g><rect fill="white" stroke="none" x="302.679887259082" y="964.430402832" width="426.51338663011717" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="arial" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="304.94168463908204" y="978.001187112" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. Return the HTTP response, typically with 200, 201 status code</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 782.4639620432812 984.032646792 L 261.82395361299996 984.032646792" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(249.40919910499997,984.032646792) translate(-249.40919910499997,-984.032646792)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 261.97474010499997 977.7498762920001 L 249.40919910499997 984.032646792 L 261.97474010499997 990.315417292 Z"/></g></g></g></g></svg>