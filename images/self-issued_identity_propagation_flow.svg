<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1093" height="636"><desc>participant%20%22Client%22%20as%20Client%0Aparticipant%20%22RS%22%20as%20RS%0A%0Abottomparticipants%0A%0Aentryspacing%201.0%0Anote%20over%20Client%3AClient%3A%5Cn%E2%80%A2%20supports%20mTLS%20authentication%20with%20X.509%20certificates%5Cn%E2%80%A2%20uses%20self-signed%20or%20CA-signed%20certificate%2C%5Cn%20%20the%20CN%20attribute%20of%20the%20public%20Client%20certificate%20is%20used%20as%20a%20global%20client%20identifier%5Cn%20%20in%20respect%20of%20the%20service%20it%20represents%2C%20e.g.%2C%20CN%3D_smtp-client.foo.127.0.0.1.nip.io%5Cn%E2%80%A2%20acts%20as%20a%20client%20in%20respect%20of%20the%20RS%5Cn%E2%80%A2%20the%20Client's%20public%20key%20hash%20is%20published%20on%20the%20client%20domain%20using%20DNS%20TXT%20record%2C%5Cn%20%20e.g.%2C%20_smtp-client.foo.127.0.0.1.nip.io.%20IN%20TXT%20%20%22v%3Dgrip1%3B%20h%3Dsha256%3B%20p%3Dd2abde240d7cd3ee6b%20...%20e971%22%0Anote%20over%20RS%3ARS%3A%5Cn%E2%80%A2%20supports%20mTLS%20authentication%20with%20X.509%20certificates%5Cn%E2%80%A2%20uses%20the%20information%20in%20the%20assertion%20to%20identify%20the%20user%5Cn%20%20and%20makes%20authorization%20decisions%20using%20a%20local%20ABAC%20engine%0AClient-%3EClient%3A1.%20Client%20generates%20a%20token%20%E2%80%94%20a%20signed%2C%20using%20the%20Client's%20private%20key%2C%5Cn%20%20%20%20DNS-bound%20assertion%20in%20JWT%20format%20with%20these%20claims%3A%5Cn%20%20%20%20%7Biss%2C%20aud%2C%20sub%2C%20exp%2C%20nbf%2C%20jwk%2C%20act%7Bsub%7D%2C%20tokens%7D%5Cn%20%20%20%20%E2%80%A2%20iss%20identifies%20who%20issues%20the%20token%20%E2%80%94%20CN%20from%20public%20Client's%20certificate%2C%5Cn%20%20%20%20%20%20e.g.%20_smtp-client.foo.127.0.0.1.nip.io%5Cn%20%20%20%20%E2%80%A2%20aud%20identifies%20the%20target%20RS%20URI%5Cn%20%20%20%20%E2%80%A2%20sub%20identifies%20the%20user%20by%20email%20address%2C%5Cn%20%20%20%20%20%20e.g.%20User%20Principal%20Name%20(UPN)%20from%20Active%20Directory%20(AD)%5Cn%20%20%20%20%20%20(Client%20impersonates%20the%20user%20by%20using%20their%20email%20address)%5Cn%20%20%20%20%E2%80%A2%20exp%2C%20nbf%20are%20the%20standard%20JWT%20claims%5Cn%20%20%20%20%E2%80%A2%20jwks%20holds%20a%20Client's%20certificate%20public%20key%20in%20the%20JWK%20Set%20format%5Cn%20%20%20%20%20%20(alternatively%20provide%20JWK%20Set%20by%20URI%20using%20jwks_uri%20claim)%5Cn%20%20%20%20%E2%80%A2%20tokens%20(optional)%20holds%20an%20embedded%20JWT%20from%20the%20previous%20hop%5Cn%20%20%20%20%E2%80%A2%20fingerprint%20(optional)%20contains%20the%20cryptographic%20signature%20of%20the%20data%20being%20transmitted%0A%0A%0AClient-%3ERS%3A2.%20Send%20an%20HTTP%20request%20to%20the%20RS%20with%20the%20token%20using%20mTLS%0ARS-%3ERS%3A3.%20Authorization%20decision%5Cn%20%20%20%201.%20the%20client%20is%20authenticated%20via%20the%20DNS%5Cn%20%20%20%20%20%20%20using%20the%20TXT%20record%20and%20CN%20from%20the%20public%20Client's%20certificate%5Cn%20%20%20%202.%20verify%20the%20token%20signature%5Cn%20%20%20%203.%20validate%20proof-of-possession%5Cn%20%20%20%204.%20verify%20the%20aud%20claim%5Cn%20%20%20%205.%20(optional)%20evaluate%20embedded%20tokens%5Cn%20%20%20%206.%20the%20domain%20part%20of%20the%20users's%20email%20address%5Cn%20%20%20%20%20%20%20and%20the%20CN's%20domain%20part%20from%20the%20public%20Client's%20certificate%20must%20match%0ARS-%3EClient%3A4.%20Return%20the%20HTTP%20response%2C%20typically%20with%20200%2C%20201%20status%20code%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1093" height="636"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 261.9912849176563 33.876698536 L 261.9912849176563 600.8339084560001" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray="7.732640615384615,3.3508109333333334"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 714.070738947474 33.876698536 L 714.070738947474 600.8339084560001" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray="7.732640615384615,3.3508109333333334"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 237.59272853583303 6.835654304000002 L 286.3898412994795 6.835654304000002 L 286.3898412994795 33.876698536 L 237.59272853583303 33.876698536 L 237.59272853583303 6.835654304000002 Z" stroke-miterlimit="10" stroke-width="1.608389248" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="248.49961812383305" y="23.824265736" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 696.9638495502088 6.835654304000002 L 731.1776283447391 6.835654304000002 L 731.1776283447391 33.876698536 L 696.9638495502088 33.876698536 L 696.9638495502088 6.835654304000002 Z" stroke-miterlimit="10" stroke-width="1.608389248" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="707.8707391382088" y="23.824265736" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RS</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 237.59272853583303 600.8339084560001 L 286.3898412994795 600.8339084560001 L 286.3898412994795 627.8749526880001 L 237.59272853583303 627.8749526880001 L 237.59272853583303 600.8339084560001 Z" stroke-miterlimit="10" stroke-width="1.608389248" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="248.49961812383305" y="617.8225198880002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 696.9638495502088 600.8339084560001 L 731.1776283447391 600.8339084560001 L 731.1776283447391 627.8749526880001 L 696.9638495502088 627.8749526880001 L 696.9638495502088 600.8339084560001 Z" stroke-miterlimit="10" stroke-width="1.608389248" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="707.8707391382088" y="617.8225198880002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RS</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 5.0262164 53.981564136 L 509.9091639153125 53.981564136 L 518.9563534353125 63.028753656000006 L 518.9563534353125 147.46918917600001 L 5.0262164 147.46918917600001 L 5.0262164 53.981564136 M 509.9091639153125 53.981564136 L 509.9091639153125 63.028753656000006 L 518.9563534353125 63.028753656000006" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="19.099622320000037" y="68.054970056" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="19.099622320000037" y="78.10740285600001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports mTLS authentication with X.509 certificates</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="19.099622320000037" y="88.15983565600001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses self-signed or CA-signed certificate,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="19.099622320000037" y="98.21226845600002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  the CN attribute of the public Client certificate is used as a global client identifier</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="19.099622320000037" y="108.26470125600002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  in respect of the service it represents, e.g., CN=_smtp-client.foo.127.0.0.1.nip.io</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="19.099622320000037" y="118.31713405600003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• acts as a client in respect of the RS</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="19.099622320000037" y="128.36956685600003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• the Client's public key hash is published on the client domain using DNS TXT record,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="19.099622320000037" y="138.42199965600003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  e.g., _smtp-client.foo.127.0.0.1.nip.io. IN TXT  "v=grip1; h=sha256; p=d2abde240d7cd3ee6b ... e971"</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 553.6389956251302 162.54783837600002 L 865.4552927498177 162.54783837600002 L 874.5024822698176 171.595027896 L 874.5024822698176 215.825732216 L 553.6389956251302 215.825732216 L 553.6389956251302 162.54783837600002 M 865.4552927498177 162.54783837600002 L 865.4552927498177 171.595027896 L 874.5024822698176 171.595027896" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="567.7124015451302" y="176.62124429600001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RS:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="567.7124015451302" y="186.673677096" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports mTLS authentication with X.509 certificates</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="567.7124015451302" y="196.726109896" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses the information in the assertion to identify the user</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="567.7124015451302" y="206.778542696" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  and makes authorization decisions using a local ABAC engine</text></g><g><g><rect fill="white" stroke="none" x="273.88666373098965" y="230.90438141600004" width="329.4824046446875" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="273.88666373098965" y="240.95681421600003" width="267.39906113882813" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="273.88666373098965" y="251.00924701600002" width="236.58239548941407" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="273.88666373098965" y="261.06167981600004" width="357.6323985411719" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="273.88666373098965" y="271.11411261600006" width="192.11573594351563" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="273.88666373098965" y="281.1665454160001" width="170.69906419058594" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="273.88666373098965" y="291.2189782160001" width="213.11573594351563" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="273.88666373098965" y="301.2714110160001" width="291.6990489317969" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="273.88666373098965" y="311.32384381600014" width="298.74906724234376" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="273.88666373098965" y="321.37627661600015" width="195.61573594351563" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="273.88666373098965" y="331.4287094160002" width="321.28239243765626" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="273.88666373098965" y="341.4811422160002" width="294.0490550353125" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="273.88666373098965" y="351.5335750160002" width="324.64906113882813" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="273.88666373098965" y="361.58600781600023" width="436.6657237364844" height="13.06816264"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="275.3945286509896" y="239.95157093600002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. Client generates a token — a signed, using the Client's private key,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="275.3945286509896" y="250.00400373600002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    DNS-bound assertion in JWT format with these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="275.3945286509896" y="260.05643653600004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {iss, aud, sub, exp, nbf, jwk, act{sub}, tokens}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="275.3945286509896" y="270.10886933600005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • iss identifies who issues the token — CN from public Client's certificate,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="275.3945286509896" y="280.1613021360001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      e.g. _smtp-client.foo.127.0.0.1.nip.io</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="275.3945286509896" y="290.2137349360001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • aud identifies the target RS URI</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="275.3945286509896" y="300.2661677360001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • sub identifies the user by email address,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="275.3945286509896" y="310.31860053600013" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      e.g. User Principal Name (UPN) from Active Directory (AD)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="275.3945286509896" y="320.37103333600015" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      (Client impersonates the user by using their email address)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="275.3945286509896" y="330.4234661360002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • exp, nbf are the standard JWT claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="275.3945286509896" y="340.4758989360002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • jwks holds a Client's certificate public key in the JWK Set format</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="275.3945286509896" y="350.5283317360002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      (alternatively provide JWK Set by URI using jwks_uri claim)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="275.3945286509896" y="360.58076453600023" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • tokens (optional) holds an embedded JWT from the previous hop</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="275.3945286509896" y="370.63319733600025" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • fingerprint (optional) contains the cryptographic signature of the data being transmitted</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 261.9912849176563 374.65417045600003 L 302.2010161176563 374.65417045600003 L 302.2010161176563 387.72233309600006 L 270.2677879229896 387.72233309600006" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray=""/><g transform="translate(261.9912849176563,387.72233309600006) translate(-261.9912849176563,-387.72233309600006)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 270.3683122509896 383.5338194293334 L 261.9912849176563 387.72233309600006 L 270.3683122509896 391.9108467626667 Z"/></g></g><g><g><rect fill="white" stroke="none" x="342.3981470125651" y="402.80098229600003" width="291.26572984" height="13.06816264"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="343.9060119325651" y="411.84817181600005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. Send an HTTP request to the RS with the token using mTLS</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 261.9912849176563 415.86914493600005 L 705.7942359421406 415.86914493600005" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray=""/><g transform="translate(714.070738947474,415.86914493600005) translate(-714.070738947474,-415.86914493600005)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 705.6937116141406 411.6806312693334 L 714.070738947474 415.86914493600005 L 705.6937116141406 420.0576586026667 Z"/></g></g><g><g><rect fill="white" stroke="none" x="725.9661177608073" y="430.9477941360001" width="118.73239701529297" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="725.9661177608073" y="441.0002269360001" width="207.33239548941407" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="725.9661177608073" y="451.0526597360001" width="318.93238633414063" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="725.9661177608073" y="461.10509253600014" width="147.24906724234376" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="725.9661177608073" y="471.15752533600016" width="157.23238938589844" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="725.9661177608073" y="481.2099581360002" width="119.89906113882813" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="725.9661177608073" y="491.2623909360002" width="202.13239854117188" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="725.9661177608073" y="501.3148237360002" width="236.13239854117188" height="13.06816264"/></g><g><rect fill="white" stroke="none" x="725.9661177608073" y="511.36725653600024" width="363.76572984" height="13.06816264"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="727.4739826808072" y="439.9949836560001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. Authorization decision</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="727.4739826808072" y="450.0474164560001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    1. the client is authenticated via the DNS</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="727.4739826808072" y="460.09984925600014" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       using the TXT record and CN from the public Client's certificate</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="727.4739826808072" y="470.15228205600016" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    2. verify the token signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="727.4739826808072" y="480.2047148560002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    3. validate proof-of-possession</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="727.4739826808072" y="490.2571476560002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    4. verify the aud claim</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="727.4739826808072" y="500.3095804560002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    5. (optional) evaluate embedded tokens</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="727.4739826808072" y="510.36201325600024" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    6. the domain part of the users's email address</text><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="727.4739826808072" y="520.4144460560002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       and the CN's domain part from the public Client's certificate must match</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 714.070738947474 524.4354191760001 L 754.2804701474739 524.4354191760001 L 754.2804701474739 537.5035818160001 L 722.3472419528073 537.5035818160001" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray=""/><g transform="translate(714.070738947474,537.5035818160001) translate(-714.070738947474,-537.5035818160001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 722.4477662808073 533.3150681493333 L 714.070738947474 537.5035818160001 L 722.4477662808073 541.6920954826668 Z"/></g></g><g><g><rect fill="white" stroke="none" x="335.15647831139324" y="552.5822310160002" width="305.74906724234376" height="13.06816264"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="7pt" font-style="normal" font-weight="normal" text-decoration="normal" x="336.6643432313932" y="561.6294205360002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. Return the HTTP response, typically with 200, 201 status code</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 714.070738947474 565.6503936560001 L 270.2677879229896 565.6503936560001" stroke-miterlimit="10" stroke-width="0.8377027333333333" stroke-dasharray=""/><g transform="translate(261.9912849176563,565.6503936560001) translate(-261.9912849176563,-565.6503936560001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 270.3683122509896 561.4618799893334 L 261.9912849176563 565.6503936560001 L 270.3683122509896 569.8389073226668 Z"/></g></g></g></g></svg>