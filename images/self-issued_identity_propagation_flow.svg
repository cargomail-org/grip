<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1353" height="783"><desc>participant%20%22Client%22%20as%20Client%0Aparticipant%20%22RS%22%20as%20RS%0A%0Abottomparticipants%0A%0Aentryspacing%201.0%0Anote%20over%20Client%3AClient%3A%5Cn%E2%80%A2%20supports%20mTLS%20authentication%20with%20X.509%20certificates%5Cn%E2%80%A2%20uses%20a%20self-signed%20or%20CA-signed%20certificate%20with%20a%20certificate%20extension%20containing%20a%20custom%20OID%20and%20ASN1%3AUTF8String%20value%5Cn%20%20that%20serves%20as%20a%20global%20client%20identifier%20in%20respect%20of%20the%20service%20it%20represents%2C%5Cn%20%20e.g.%2C%201.2.3.4.5.6.7.8%3DASN1%3AUTF8String%3Aclient._mhs._grip.foo.com%5Cn%E2%80%A2%20acts%20as%20a%20client%20in%20respect%20of%20the%20RS%5Cn%E2%80%A2%20the%20Client's%20public%20key%20fingerprint%20is%20published%20on%20the%20client%20domain%20using%20DNS%20TXT%20record%2C%5Cn%20%20e.g.%2C%20client._mhs._grip.foo.com%20IN%20TXT%20%20%22v%3Dgrip1%3B%20h%3Dsha256%3B%20p%3Dd2abde240d7cd3ee6b%20...%20e971%22%0Anote%20over%20RS%3ARS%3A%5Cn%E2%80%A2%20supports%20mTLS%20authentication%20with%20X.509%20certificates%5Cn%E2%80%A2%20uses%20a%20CA-signed%20certificate%20with%20an%20appropriate%20Subject%20Alternative%20Name%20(SAN)%5Cn%E2%80%A2%20uses%20a%20DNS%20SRV%20record%20to%20specify%20a%20host%20and%20port%20of%20the%20resource%20server%2C%20while%20identifies%20the%20respective%5Cn%20%20%20service%2C%20e.g.%2C%20_mhs._tcp.bar.com%5Cn%E2%80%A2%20uses%20the%20information%20in%20the%20assertion%20to%20identify%20the%20user%5Cn%20%20and%20makes%20authorization%20decisions%20using%20a%20local%20ABAC%20engine%0AClient-%3EClient%3A1.%20Client%20generates%20a%20token%20%E2%80%94%20a%20signed%2C%20using%20the%20Client's%20private%20key%2C%5Cn%20%20%20%20DNS-bound%20assertion%20in%20JWT%20format%20with%20these%20claims%3A%5Cn%20%20%20%20%7Biss%2C%20aud%2C%20sub%2C%20exp%2C%20nbf%2C%20jwk%2C%20act%7Bsub%7D%2C%20tokens%7D%5Cn%20%20%20%20%E2%80%A2%20iss%20identifies%20who%20issues%20the%20token%20%E2%80%94%20CN%20from%20public%20Client's%20certificate%2C%5Cn%20%20%20%20%20%20e.g.%2C%20foo.com%5Cn%20%20%20%20%E2%80%A2%20aud%20identifies%20the%20target%20service%20by%20the%20DNS%20SRV%20record%2C%20e.g.%2C%20_mhs._tcp.bar.com%5Cn%20%20%20%20%E2%80%A2%20sub%20identifies%20the%20user%20by%20email%20address%2C%5Cn%20%20%20%20%20%20e.g.%20User%20Principal%20Name%20(UPN)%20from%20Active%20Directory%20(AD)%5Cn%20%20%20%20%20%20(Client%20impersonates%20the%20user%20by%20using%20their%20email%20address)%5Cn%20%20%20%20%E2%80%A2%20exp%2C%20nbf%20are%20the%20standard%20JWT%20claims%5Cn%20%20%20%20%E2%80%A2%20jwks%20holds%20a%20Client's%20certificate%20public%20key%20in%20the%20JWK%20Set%20format%5Cn%20%20%20%20%20%20(alternatively%20provide%20JWK%20Set%20by%20URI%20using%20jwks_uri%20claim)%5Cn%20%20%20%20%E2%80%A2%20tokens%20(optional)%20holds%20an%20embedded%20JWT%20from%20the%20previous%20hop%5Cn%20%20%20%20%E2%80%A2%20digest%20(optional)%20contains%20a%20digest%20(cryptographic%20hash)%20of%20the%20data%5Cn%20%20%20%20%20%20%20being%20transmitted%20(pushed%20or%20pulled)%0A%0A%0AClient-%3ERS%3A2.%20Send%20an%20HTTPS%20request%20to%20the%20RS%20with%20the%20token%20using%20mTLS%0ARS-%3ERS%3A3.%20Authorization%20decision%5Cn%20%20%20%201.%20the%20client%20is%20authenticated%20via%20the%20DNS%20using%20the%20TXT%20record%20and%20the%20custom%20OID%20value%5Cn%20%20%20%20%20%20%20from%20the%20public%20Client's%20certificate%5Cn%20%20%20%202.%20verify%20the%20token%20signature%5Cn%20%20%20%203.%20validate%20proof-of-possession%5Cn%20%20%20%204.%20verify%20the%20aud%20claim%5Cn%20%20%20%205.%20(optional)%20evaluate%20embedded%20tokens%5Cn%20%20%20%206.%20the%20domain%20part%20of%20the%20user's%20email%20address%20and%20the%20domain%20part%20of%20the%20custom%20OID%20value%5Cn%20%20%20%20%20%20%20from%20the%20public%20Client's%20certificate%20must%20match%5Cn%20%20%20%207.%20(optional)%20verify%20the%20digest%20claim%20value%20of%20the%20embedded%20tokens%20against%20the%20digest%20of%5Cn%20%20%20%20%20%20%20%20the%20transmitted%20(pushed)%20data%20or%20the%20digest%20of%20the%20data%20being%20transmitted%20(pulled)%0ARS-%3EClient%3A4.%20Return%20the%20HTTP%20response%2C%20typically%20with%20200%2C%20201%20status%20code%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1353" height="783"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 354.7870629029688 38.111285853 L 354.7870629029688 743.7920684130002" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray="8.699220692307692,3.7696623000000002"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 827.5035429553126 38.111285853 L 827.5035429553126 743.7920684130002" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray="8.699220692307692,3.7696623000000002"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 327.1168124979385 7.690111091999997 L 382.457313307999 7.690111091999997 L 382.457313307999 38.111285853 L 327.1168124979385 38.111285853 L 327.1168124979385 7.690111091999997 Z" stroke-miterlimit="10" stroke-width="1.8094379040000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="339.3870632844385" y="26.802298953" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 808.1582923595474 7.690111091999997 L 846.8487935510777 7.690111091999997 L 846.8487935510777 38.111285853 L 808.1582923595474 38.111285853 L 808.1582923595474 7.690111091999997 Z" stroke-miterlimit="10" stroke-width="1.8094379040000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="820.4285431460474" y="26.802298953" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RS</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 327.1168124979385 743.7920684130002 L 382.457313307999 743.7920684130002 L 382.457313307999 774.2132431740001 L 327.1168124979385 774.2132431740001 L 327.1168124979385 743.7920684130002 Z" stroke-miterlimit="10" stroke-width="1.8094379040000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="339.3870632844385" y="762.9042562740002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 808.1582923595474 743.7920684130002 L 846.8487935510777 743.7920684130002 L 846.8487935510777 774.2132431740001 L 808.1582923595474 774.2132431740001 L 808.1582923595474 743.7920684130002 Z" stroke-miterlimit="10" stroke-width="1.8094379040000002" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="820.4285431460474" y="762.9042562740002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RS</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 5.65449345 60.729259653000014 L 693.7415441459375 60.729259653000014 L 703.9196323559376 70.90734786300001 L 703.9196323559376 165.90283782300003 L 5.65449345 165.90283782300003 L 5.65449345 60.729259653000014 M 693.7415441459375 60.729259653000014 L 693.7415441459375 70.90734786300001 L 703.9196323559376 70.90734786300001" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="21.487075110000035" y="76.56184131300003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="21.487075110000035" y="87.87082821300004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports mTLS authentication with X.509 certificates</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="21.487075110000035" y="99.17981511300005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses a self-signed or CA-signed certificate with a certificate extension containing a custom OID and ASN1:UTF8String value</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="21.487075110000035" y="110.48880201300005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  that serves as a global client identifier in respect of the service it represents,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="21.487075110000035" y="121.79778891300006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  e.g., 1.2.3.4.5.6.7.8=ASN1:UTF8String:client._mhs._grip.foo.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="21.487075110000035" y="133.10677581300007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• acts as a client in respect of the RS</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="21.487075110000035" y="144.41576271300008" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• the Client's public key fingerprint is published on the client domain using DNS TXT record,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="21.487075110000035" y="155.72474961300009" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  e.g., client._mhs._grip.foo.com IN TXT  "v=grip1; h=sha256; p=d2abde240d7cd3ee6b ... e971"</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 532.0626238929688 182.86631817300002 L 1112.7663738076565 182.86631817300002 L 1122.9444620176564 193.04440638300002 L 1122.9444620176564 276.73090944300003 L 532.0626238929688 276.73090944300003 L 532.0626238929688 182.86631817300002 M 1112.7663738076565 182.86631817300002 L 1112.7663738076565 193.04440638300002 L 1122.9444620176564 193.04440638300002" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="547.8952055529688" y="198.69889983300004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RS:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="547.8952055529688" y="210.00788673300005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports mTLS authentication with X.509 certificates</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="547.8952055529688" y="221.31687363300006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses a CA-signed certificate with an appropriate Subject Alternative Name (SAN)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="547.8952055529688" y="232.62586053300006" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses a DNS SRV record to specify a host and port of the resource server, while identifies the respective</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="547.8952055529688" y="243.93484743300007" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   service, e.g., _mhs._tcp.bar.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="547.8952055529688" y="255.24383433300008" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses the information in the assertion to identify the user</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="547.8952055529688" y="266.5528212330001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  and makes authorization decisions using a local ABAC engine</text></g><g><g><rect fill="white" stroke="none" x="368.1693640679688" y="293.694389793" width="375.9260212653125" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="368.1693640679688" y="305.003376693" width="305.0426899664844" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="368.1693640679688" y="316.312363593" width="269.8593708746875" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="368.1693640679688" y="327.62135049299997" width="408.0093647711719" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="368.1693640679688" y="338.93033739299995" width="93.22603194646484" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="368.1693640679688" y="350.2393242929999" width="455.37603347234375" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="368.1693640679688" y="361.5483111929999" width="243.10935561589844" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="368.1693640679688" y="372.8572980929999" width="332.7593647711719" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="368.1693640679688" y="384.16628499299986" width="340.84270827703125" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="368.1693640679688" y="395.47527189299984" width="223.12603347234375" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="368.1693640679688" y="406.7842587929998" width="366.5593525641406" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="368.1693640679688" y="418.0932456929998" width="335.4593769782031" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="368.1693640679688" y="429.4022325929998" width="370.4760395758594" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="368.1693640679688" y="440.71121949299976" width="384.89269607" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="368.1693640679688" y="452.02020639299974" width="223.64269607" height="14.70168297"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="369.8657121029688" y="303.872478003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. Client generates a token — a signed, using the Client's private key,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="369.8657121029688" y="315.181464903" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    DNS-bound assertion in JWT format with these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="369.8657121029688" y="326.490451803" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {iss, aud, sub, exp, nbf, jwk, act{sub}, tokens}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="369.8657121029688" y="337.79943870299996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • iss identifies who issues the token — CN from public Client's certificate,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="369.8657121029688" y="349.10842560299994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      e.g., foo.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="369.8657121029688" y="360.4174125029999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • aud identifies the target service by the DNS SRV record, e.g., _mhs._tcp.bar.com</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="369.8657121029688" y="371.7263994029999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • sub identifies the user by email address,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="369.8657121029688" y="383.0353863029999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      e.g. User Principal Name (UPN) from Active Directory (AD)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="369.8657121029688" y="394.34437320299986" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      (Client impersonates the user by using their email address)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="369.8657121029688" y="405.65336010299984" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • exp, nbf are the standard JWT claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="369.8657121029688" y="416.9623470029998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • jwks holds a Client's certificate public key in the JWK Set format</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="369.8657121029688" y="428.2713339029998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      (alternatively provide JWK Set by URI using jwks_uri claim)</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="369.8657121029688" y="439.5803208029998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • tokens (optional) holds an embedded JWT from the previous hop</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="369.8657121029688" y="450.88930770299976" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • digest (optional) contains a digest (cryptographic hash) of the data</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="369.8657121029688" y="462.19829460299974" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       being transmitted (pushed or pulled)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 354.7870629029688 466.7218893630001 L 400.02301050296876 466.7218893630001 L 400.02301050296876 481.4235723330001 L 364.0981287839688 481.4235723330001" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray=""/><g transform="translate(354.7870629029688,481.4235723330001) translate(-354.7870629029688,-481.4235723330001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 364.2112186529688 476.7114944580001 L 354.7870629029688 481.4235723330001 L 364.2112186529688 486.1356502080001 Z"/></g></g><g><g><rect fill="white" stroke="none" x="421.6239579458985" y="498.3870526830001" width="339.0426899664844" height="14.70168297"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="423.3203059808985" y="508.5651408930001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. Send an HTTPS request to the RS with the token using mTLS</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 354.7870629029688 513.0887356530001 L 818.1924770743126 513.0887356530001" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray=""/><g transform="translate(827.5035429553126,513.0887356530001) translate(-827.5035429553126,-513.0887356530001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 818.0793872053126 508.3766577780001 L 827.5035429553126 513.0887356530001 L 818.0793872053126 517.800813528 Z"/></g></g><g><g><rect fill="white" stroke="none" x="840.8858441203125" y="530.052216003" width="135.4426991217578" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="840.8858441203125" y="541.361202903" width="492.7427021735156" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="840.8858441203125" y="552.6701898030001" width="207.79268996648437" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="840.8858441203125" y="563.9791767030001" width="167.99270217351562" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="840.8858441203125" y="575.2881636030002" width="179.40935866765625" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="840.8858441203125" y="586.5971505030002" width="136.75936477117187" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="840.8858441203125" y="597.9061374030002" width="230.65935866765625" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="840.8858441203125" y="609.2151243030003" width="509.12603347234375" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="840.8858441203125" y="620.5241112030003" width="275.0426899664844" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="840.8858441203125" y="631.8330981030003" width="483.4927021735156" height="14.70168297"/></g><g><rect fill="white" stroke="none" x="840.8858441203125" y="643.1420850030004" width="467.9760395758594" height="14.70168297"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="842.5821921553126" y="540.2303042130001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. Authorization decision</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="842.5821921553126" y="551.5392911130001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    1. the client is authenticated via the DNS using the TXT record and the custom OID value</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="842.5821921553126" y="562.8482780130001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       from the public Client's certificate</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="842.5821921553126" y="574.1572649130002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    2. verify the token signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="842.5821921553126" y="585.4662518130002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    3. validate proof-of-possession</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="842.5821921553126" y="596.7752387130002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    4. verify the aud claim</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="842.5821921553126" y="608.0842256130003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    5. (optional) evaluate embedded tokens</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="842.5821921553126" y="619.3932125130003" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    6. the domain part of the user's email address and the domain part of the custom OID value</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="842.5821921553126" y="630.7021994130004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       from the public Client's certificate must match</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="842.5821921553126" y="642.0111863130004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    7. (optional) verify the digest claim value of the embedded tokens against the digest of</text><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="842.5821921553126" y="653.3201732130004" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">        the transmitted (pushed) data or the digest of the data being transmitted (pulled)</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 827.5035429553126 657.8437679730001 L 872.7394905553126 657.8437679730001 L 872.7394905553126 672.5454509430001 L 836.8146088363126 672.5454509430001" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray=""/><g transform="translate(827.5035429553126,672.5454509430001) translate(-827.5035429553126,-672.5454509430001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 836.9276987053125 667.8333730680001 L 827.5035429553126 672.5454509430001 L 836.9276987053125 677.2575288180001 Z"/></g></g><g><g><rect fill="white" stroke="none" x="416.7572892447266" y="689.5089312930002" width="348.7760273688281" height="14.70168297"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="8pt" font-style="normal" font-weight="normal" text-decoration="normal" x="418.45363727972665" y="699.6870195030002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. Return the HTTP response, typically with 200, 201 status code</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 827.5035429553126 704.2106142630001 L 364.0981287839688 704.2106142630001" stroke-miterlimit="10" stroke-width="0.9424155750000001" stroke-dasharray=""/><g transform="translate(354.7870629029688,704.2106142630001) translate(-354.7870629029688,-704.2106142630001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 364.2112186529688 699.4985363880002 L 354.7870629029688 704.2106142630001 L 364.2112186529688 708.9226921380001 Z"/></g></g></g></g></svg>