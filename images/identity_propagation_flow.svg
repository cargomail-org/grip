<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1677" height="1112"><desc>participant%20%22IdP%20%2B%20STS%22%20as%20STS%0Aparticipant%20%22Identity%20Propagator%22%20as%20Propagator%0Aparticipant%20%22RP%22%20as%20RP%0A%0Abottomparticipants%0A%0Anote%20over%20STS%3ASTS%3A%5Cn%E2%80%A2%20supports%20RFC%208705%5Cn%E2%80%A2%20supports%20the%20Token%20Exchange%20extension%20of%20OAuth%202.0%0Anote%20over%20Propagator%3AIdentity%20Propagator%3A%5Cn%E2%80%A2%20supports%20RFC%208705%5Cn%E2%80%A2%20the%20public%20key%20described%20in%20RFC%208705%20is%20published%20using%20.well-known%20or%20DNS%20mechanism%5Cn%E2%80%A2%20acts%20as%20a%20relying%20party%20in%20respect%20of%20the%20IdP%20in%20order%20to%20obtain%5Cn%20%20an%20access_token_with_user_claims%5Cn%E2%80%A2%20is%20registered%20at%20the%20IdP%20as%20a%20confidential%20client%0Anote%20over%20RP%3ARP%3A%5Cn%E2%80%A2%20supports%20RFC%208705%5Cn%E2%80%A2%20uses%20the%20information%20in%20the%20assertion%20to%20identify%20the%20subscriber%5Cn%20%20and%20makes%20authorization%20decisions%20using%20a%20local%20ABAC%20engine.%0ASTS%3C-Propagator%3A1.%20Send%20an%20HTTP%20request%20to%20the%20STS%20endpoint%5Cn%20%20%20%20%E2%80%A2%20grant_type%20%3D%20token-exchange%5Cn%20%20%20%20%E2%80%A2%20resource%20%3D%20a%20target%20RP%20URI%5Cn%20%20%20%20%E2%80%A2%20requested_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Ajwt%5Cn%20%20%20%20%E2%80%A2%20subject_token%20%3D%20access_token_with_user_claims%5Cn%20%20%20%20%E2%80%A2%20subject_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Aaccess_token%0ASTS-%3ESTS%3A2.%20Authorization%20decision%3A%5Cn%20%20%201.%20evaluate%20the%20resource%20parameter%5Cn%20%20%202.%20verify%20the%20subject_token%20signature%5Cn%20%20%203.%20evaluate%20the%20subject_token%20claims%0A%0ASTS-%3ESTS%3A3.%20STS%20generates%20a%20certificate-bound%20jwt%20access_token%20with%20these%20claims%3A%5Cn%20%20%20%20%7Biss%2C%20aud%2C%20sub%2C%20exp%2C%20nbf%7D%5Cn%20%20%20%20%E2%80%A2%20iss%20is%20the%20URI%20that%20identifies%20who%20issues%20the%20access_token%5Cn%20%20%20%20%E2%80%A2%20aud%20identifies%20the%20target%20service%20and%20it%20is%20the%20value%20from%5Cn%20%20%20%20%20%20the%20resource%20parameter%5Cn%20%20%20%20%E2%80%A2%20sub%20identifies%20the%20subscriber%20by%20an%20email%20address%20that%20is%20extracted%20from%5Cn%20%20%20%20%20%20the%20access_token_with_user_claims%5Cn%20%20%20%20%E2%80%A2%20exp%2C%20nbf%20are%20the%20standard%20JWT%20claims%0APropagator%3C-STS%3A4.%20Return%20the%20access_token%0A%0APropagator-%3ERP%3A5.%20Send%20an%20HTTP%20request%20to%20the%20RP%20with%20the%20access_token%20using%20mTLS%0ARP-%3ERP%3A6.%20Authorization%20decision%5Cn%20%20%20%201.%20verify%20the%20access_token%20signature%5Cn%20%20%20%202.%20validate%20proof-of-possession%5Cn%20%20%20%203.%20evaluate%20claims%0ARP-%3EPropagator%3A7.%20Return%20the%20HTTP%20response%2C%20typically%20with%20200%2C%20201%20status%20code%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1677" height="1112"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 229.7494395835156 50.815047804 L 229.7494395835156 1059.5766792839997" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 815.5269915999219 50.815047804 L 815.5269915999219 1059.5766792839997" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1365.6367166964062 50.815047804 L 1365.6367166964062 1059.5766792839997" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 177.522440315041 10.253481456000003 L 281.9764388519902 10.253481456000003 L 281.9764388519902 50.815047804 L 177.522440315041 50.815047804 L 177.522440315041 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="193.882774697041" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IdP + STS</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 728.3833243932148 10.253481456000003 L 902.6706588066289 10.253481456000003 L 902.6706588066289 50.815047804 L 728.3833243932148 50.815047804 L 728.3833243932148 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="744.7436587752148" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Identity Propagator</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1339.751382695876 10.253481456000003 L 1391.5220506969365 10.253481456000003 L 1391.5220506969365 50.815047804 L 1339.751382695876 50.815047804 L 1339.751382695876 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1356.111717077876" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RP</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 177.522440315041 1059.5766792839997 L 281.9764388519902 1059.5766792839997 L 281.9764388519902 1100.1382456319998 L 177.522440315041 1100.1382456319998 L 177.522440315041 1059.5766792839997 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="193.882774697041" y="1085.0595964319998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IdP + STS</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 728.3833243932148 1059.5766792839997 L 902.6706588066289 1059.5766792839997 L 902.6706588066289 1100.1382456319998 L 728.3833243932148 1100.1382456319998 L 728.3833243932148 1059.5766792839997 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="744.7436587752148" y="1085.0595964319998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Identity Propagator</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1339.751382695876 1059.5766792839997 L 1391.5220506969365 1059.5766792839997 L 1391.5220506969365 1100.1382456319998 L 1339.751382695876 1100.1382456319998 L 1339.751382695876 1059.5766792839997 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1356.111717077876" y="1085.0595964319998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RP</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 7.5393246000000005 80.97234620399999 L 438.3887702870312 80.97234620399999 L 451.9595545670312 94.54313048399999 L 451.9595545670312 145.810537764 L 7.5393246000000005 145.810537764 L 7.5393246000000005 80.97234620399999 M 438.3887702870312 80.97234620399999 L 438.3887702870312 94.54313048399999 L 451.9595545670312 94.54313048399999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="102.08245508399999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">STS:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="117.16110428399999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports RFC 8705</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="132.239753484" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports the Token Exchange extension of OAuth 2.0</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 463.90022012226564 168.42851156399996 L 1153.582978797578 168.42851156399996 L 1167.153763077578 181.99929584399996 L 1167.153763077578 278.502650724 L 463.90022012226564 278.502650724 L 463.90022012226564 168.42851156399996 M 1153.582978797578 168.42851156399996 L 1153.582978797578 181.99929584399996 L 1167.153763077578 181.99929584399996" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="485.0103290022656" y="189.53862044399997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Identity Propagator:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="485.0103290022656" y="204.61726964399998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports RFC 8705</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="485.0103290022656" y="219.69591884399998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• the public key described in RFC 8705 is published using .well-known or DNS mechanism</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="485.0103290022656" y="234.77456804399998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• acts as a relying party in respect of the IdP in order to obtain</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="485.0103290022656" y="249.85321724399998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  an access_token_with_user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="485.0103290022656" y="264.931866444" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is registered at the IdP as a confidential client</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1107.9682734658204 301.12062452399994 L 1609.7343756469922 301.12062452399994 L 1623.3051599269922 314.69140880399993 L 1623.3051599269922 381.03746528399995 L 1107.9682734658204 381.03746528399995 L 1107.9682734658204 301.12062452399994 M 1609.7343756469922 301.12062452399994 L 1609.7343756469922 314.69140880399993 L 1623.3051599269922 314.69140880399993" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1129.0783823458203" y="322.2307334039999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RP:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1129.0783823458203" y="337.3093826039999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports RFC 8705</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1129.0783823458203" y="352.38803180399987" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses the information in the assertion to identify the subscriber</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1129.0783823458203" y="367.46668100399984" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  and makes authorization decisions using a local ABAC engine.</text></g><g><g><rect fill="white" stroke="none" x="249.15141210820317" y="403.65543908399997" width="335.95691385179686" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="249.15141210820317" y="418.734088284" width="255.15692605882813" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="249.15141210820317" y="433.81273748399997" width="233.54025735765626" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="249.15141210820317" y="448.89138668399994" width="491.9402512541406" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="249.15141210820317" y="463.9700358839999" width="389.8402756682031" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="249.15141210820317" y="479.0486850839999" width="546.9736069670313" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="251.41320948820317" y="417.226223364" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. Send an HTTP request to the STS endpoint</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="251.41320948820317" y="432.304872564" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • grant_type = token-exchange</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="251.41320948820317" y="447.38352176399997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • resource = a target RP URI</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="251.41320948820317" y="462.46217096399994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • requested_token_type = urn:ietf:params:oauth:token-type:jwt</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="251.41320948820317" y="477.5408201639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • subject_token = access_token_with_user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="251.41320948820317" y="492.6194693639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • subject_token_type = urn:ietf:params:oauth:token-type:access_token</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 815.5269915999219 498.65092904399995 L 242.16419409151558 498.65092904399995" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(229.7494395835156,498.65092904399995) translate(-229.7494395835156,-498.65092904399995)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 242.3149805835156 492.3681585439999 L 229.7494395835156 498.65092904399995 L 242.3149805835156 504.933699544 Z"/></g></g><g><g><rect fill="white" stroke="none" x="247.5925078035156" y="521.268902844" width="191.60692300707032" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.5925078035156" y="536.3475520439999" width="280.0902756682031" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.5925078035156" y="551.4262012439999" width="287.39026346117186" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.5925078035156" y="566.5048504439999" width="287.85693826585936" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="249.85430518351558" y="534.839687124" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. Authorization decision:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="249.85430518351558" y="549.9183363239999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   1. evaluate the resource parameter</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="249.85430518351558" y="564.9969855239999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   2. verify the subject_token signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="249.85430518351558" y="580.0756347239999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   3. evaluate the subject_token claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 229.7494395835156 586.1070944039999 L 290.0640363835156 586.1070944039999 L 290.0640363835156 605.7093383639999 L 242.16419409151558 605.7093383639999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(229.7494395835156,605.7093383639999) translate(-229.7494395835156,-605.7093383639999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 242.3149805835156 599.4265678639999 L 229.7494395835156 605.7093383639999 L 242.3149805835156 611.9921088639999 Z"/></g></g><g><g><rect fill="white" stroke="none" x="247.5925078035156" y="628.327312164" width="540.456944369375" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.5925078035156" y="643.405961364" width="202.99025430589845" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.5925078035156" y="658.4846105639999" width="453.79025735765623" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.5925078035156" y="673.5632597639999" width="447.02359476" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.5925078035156" y="688.6419089639999" width="206.90692605882813" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.5925078035156" y="703.7205581639998" width="562.6569565764063" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.5925078035156" y="718.7992073639998" width="291.4069260588281" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.5925078035156" y="733.8778565639998" width="307.57358255296873" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="249.85430518351558" y="641.898096444" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. STS generates a certificate-bound jwt access_token with these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="249.85430518351558" y="656.976745644" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {iss, aud, sub, exp, nbf}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="249.85430518351558" y="672.0553948439999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • iss is the URI that identifies who issues the access_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="249.85430518351558" y="687.1340440439999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • aud identifies the target service and it is the value from</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="249.85430518351558" y="702.2126932439999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      the resource parameter</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="249.85430518351558" y="717.2913424439998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • sub identifies the subscriber by an email address that is extracted from</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="249.85430518351558" y="732.3699916439998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      the access_token_with_user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="249.85430518351558" y="747.4486408439998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • exp, nbf are the standard JWT claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 229.7494395835156 753.4801005239999 L 290.0640363835156 753.4801005239999 L 290.0640363835156 773.0823444839999 L 242.16419409151558 773.0823444839999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(229.7494395835156,773.0823444839999) translate(-229.7494395835156,-773.0823444839999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 242.3149805835156 766.799573984 L 229.7494395835156 773.0823444839999 L 242.3149805835156 779.3651149839999 Z"/></g></g><g><g><rect fill="white" stroke="none" x="421.0847540881836" y="795.7003182839999" width="203.10692300707032" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="423.34655146818363" y="809.2711025639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. Return the access_token</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 229.7494395835156 815.3025622439999 L 803.1122370919219 815.3025622439999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(815.5269915999219,815.3025622439999) translate(-815.5269915999219,-815.3025622439999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 802.9614505999218 809.0197917439999 L 815.5269915999219 815.3025622439999 L 802.9614505999218 821.5853327439999 Z"/></g></g><g><g><rect fill="white" stroke="none" x="833.3700598199218" y="837.9205360439998" width="514.4235886564844" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="835.6318571999218" y="851.4913203239998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. Send an HTTP request to the RP with the access_token using mTLS</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 815.5269915999219 857.5227800039999 L 1353.2219621884062 857.5227800039999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1365.6367166964062,857.5227800039999) translate(-1365.6367166964062,-857.5227800039999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1353.0711756964063 851.2400095039999 L 1365.6367166964062 857.5227800039999 L 1353.0711756964063 863.8055505039998 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1383.4797849164063" y="880.1407538039998" width="186.65692605882813" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1383.4797849164063" y="895.2194030039998" width="288.3069199553125" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1383.4797849164063" y="910.2980522039998" width="247.32359781175782" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1383.4797849164063" y="925.3767014039997" width="157.54025735765626" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1385.7415822964062" y="893.7115380839998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. Authorization decision</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1385.7415822964062" y="908.7901872839998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    1. verify the access_token signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1385.7415822964062" y="923.8688364839998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    2. validate proof-of-possession</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1385.7415822964062" y="938.9474856839997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    3. evaluate claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1365.6367166964062 944.9789453639999 L 1425.9513134964063 944.9789453639999 L 1425.9513134964063 964.5811893239999 L 1378.0514712044062 964.5811893239999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1365.6367166964062,964.5811893239999) translate(-1365.6367166964062,-964.5811893239999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1378.2022576964061 958.2984188239999 L 1365.6367166964062 964.5811893239999 L 1378.2022576964061 970.8639598239998 Z"/></g></g><g><g><rect fill="white" stroke="none" x="850.1450537164062" y="987.1991631239998" width="480.8736008635156" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="852.4068510964062" y="1000.7699474039998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7. Return the HTTP response, typically with 200, 201 status code</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1365.6367166964062 1006.8014070839998 L 827.9417461079219 1006.8014070839998" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(815.5269915999219,1006.8014070839998) translate(-815.5269915999219,-1006.8014070839998)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 828.0925325999219 1000.5186365839999 L 815.5269915999219 1006.8014070839998 L 828.0925325999219 1013.0841775839998 Z"/></g></g></g></g></svg>