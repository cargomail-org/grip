<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1914" height="1278"><desc>participant%20%22IdP%22%20as%20IdP%0Aparticipant%20%22Identity%20Propagator%20(RP%20%2B%20Client)%22%20as%20Propagator%0Aparticipant%20%22RP%20(RS)%22%20as%20RP%0A%0Abottomparticipants%0A%0Anote%20over%20IdP%3AIdP%5Cn%E2%80%A2%20supports%20RFC%208705%5Cn%E2%80%A2%20supports%20the%20STS%20Token%20Exchange%20extension%20of%20OAuth%202.0%0Anote%20over%20Propagator%3AIdentity%20Propagator%3A%5Cn%E2%80%A2%20supports%20RFC%208705%5Cn%E2%80%A2%20acts%20as%20a%20relying%20party%20in%20respect%20of%20the%20IdP%20in%20order%20to%20obtain%20an%20access_token_with_user_claims%5Cn%E2%80%A2%20is%20registered%20at%20the%20IdP%20as%20a%20confidential%20client%20or%20uses%20RFC%208705%20to%20authenticate%20at%20the%20IdP%5Cn%E2%80%A2%20acts%20as%20a%20client%20in%20respect%20of%20the%20RP%5Cn%E2%80%A2%20the%20hash%20of%20the%20public%20key%20described%20in%20RFC%208705%20is%20published%20using%20.well-known%2C%20Webfinger%20or%20DNS%20(DANE)%20mechanism%5Cn%20%20to%20authenticate%20to%20the%20RP%20using%20the%20service%20specific%20client%20identity%20represented%20by%20a%20DNS%20domain%20name%0Anote%20over%20RP%3ARP%3A%5Cn%E2%80%A2%20supports%20RFC%208705%5Cn%E2%80%A2%20uses%20the%20information%20in%20the%20assertion%20to%20identify%20the%20subscriber%5Cn%20%20and%20makes%20authorization%20decisions%20using%20a%20local%20ABAC%20engine%5Cn%E2%80%A2%20should%20support%20the%20service%20discovery%20mechanism%0AIdP%3C-Propagator%3A1.%20Send%20an%20HTTP%20request%20to%20the%20STS%20endpoint%5Cn%20%20%20%20%E2%80%A2%20grant_type%20%3D%20token-exchange%5Cn%20%20%20%20%E2%80%A2%20resource%20%3D%20a%20target%20RP%20URI%5Cn%20%20%20%20%E2%80%A2%20requested_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Ajwt%5Cn%20%20%20%20%E2%80%A2%20subject_token%20%3D%20access_token_with_user_claims%5Cn%20%20%20%20%E2%80%A2%20subject_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Aaccess_token%0AIdP-%3EIdP%3A2.%20Authorization%20decision%3A%5Cn%20%20%201.%20evaluate%20the%20resource%20parameter%5Cn%20%20%202.%20verify%20the%20subject_token%20signature%5Cn%20%20%203.%20evaluate%20the%20subject_token%20claims%0A%0AIdP-%3EIdP%3A3.%20STS%20generates%20a%20token%20%E2%80%94%20a%20signed%20certificate-bound%20assertion%5Cn%20%20%20%20in%20JWT%20format%20with%20these%20claims%3A%5Cn%20%20%20%20%7Biss%2C%20aud%2C%20sub%2C%20exp%2C%20nbf%2C%20cnf%7D%5Cn%20%20%20%20%E2%80%A2%20iss%20is%20the%20URI%20that%20identifies%20who%20issues%20the%20token%5Cn%20%20%20%20%E2%80%A2%20aud%20identifies%20the%20target%20service%20and%20it%20is%20the%20value%20from%5Cn%20%20%20%20%20%20the%20resource%20parameter%5Cn%20%20%20%20%E2%80%A2%20sub%20identifies%20the%20subscriber%20by%20an%20email%20address%20that%20is%20extracted%20from%5Cn%20%20%20%20%20%20the%20access_token_with_user_claims%5Cn%20%20%20%20%E2%80%A2%20exp%2C%20nbf%20are%20the%20standard%20JWT%20claims%5Cn%20%20%20%20%E2%80%A2%20cnf%20is%20the%20confirmation%20method%20with%20the%20hash%20of%20the%20client%20certificate%5Cn%20%20%20%20%20%20to%20which%20the%20token%20is%20bound%0APropagator%3C-IdP%3A4.%20Return%20the%20token%5Cn%7B%22access_token%22%3Atoken%2C%5Cn%20%22issued_token_type%22%3A%22urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Ajwt%22%2C%5Cn%20%22token_type%22%3A%22N_A%22%2C%5Cn%20%22expires_in%22%3A3600%7D%0A%0APropagator-%3ERP%3A5.%20Send%20an%20HTTP%20request%20to%20the%20RP%20with%20the%20token%20using%20mTLS%0ARP-%3ERP%3A6.%20Authorization%20decision%5Cn%20%20%20%201.%20verify%20the%20token%20signature%5Cn%20%20%20%202.%20validate%20proof-of-possession%5Cn%20%20%20%203.%20validate%20the%20client%20service%20specific%20identity%5Cn%20%20%20%204.%20use%20WebFinger%20to%20locate%20the%20OpenID%20Provider%20(OP)%20for%20the%20subscriber%5Cn%20%20%20%20%20%20%20using%20its%20identifier%20and%20verify%20that%20the%20OP%20matches%20the%20issuer%0ARP-%3EPropagator%3A7.%20Return%20the%20HTTP%20response%2C%20typically%20with%20200%2C%20201%20status%20code%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1914" height="1278"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 245.88277088234372 50.815047804 L 245.88277088234372 1225.4418204840001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 831.66032289875 50.815047804 L 831.66032289875 1225.4418204840001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1348.2200602022656 50.815047804 L 1348.2200602022656 1225.4418204840001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 218.27243650034373 10.253481456000003 L 273.49310526434374 10.253481456000003 L 273.49310526434374 50.815047804 L 218.27243650034373 50.815047804 L 218.27243650034373 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="234.63277088234372" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IdP</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 694.8749854649922 10.253481456000003 L 968.4456603325077 10.253481456000003 L 968.4456603325077 50.815047804 L 694.8749854649922 50.815047804 L 694.8749854649922 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="711.2353198469922" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Identity Propagator (RP + Client)</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1304.5263918511494 10.253481456000003 L 1391.9137285533818 10.253481456000003 L 1391.9137285533818 50.815047804 L 1304.5263918511494 50.815047804 L 1304.5263918511494 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1320.8867262331494" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RP (RS)</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 218.27243650034373 1225.4418204840001 L 273.49310526434374 1225.4418204840001 L 273.49310526434374 1266.0033868320002 L 218.27243650034373 1266.0033868320002 L 218.27243650034373 1225.4418204840001 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="234.63277088234372" y="1250.9247376320002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IdP</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 694.8749854649922 1225.4418204840001 L 968.4456603325077 1225.4418204840001 L 968.4456603325077 1266.0033868320002 L 694.8749854649922 1266.0033868320002 L 694.8749854649922 1225.4418204840001 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="711.2353198469922" y="1250.9247376320002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Identity Propagator (RP + Client)</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1304.5263918511494 1225.4418204840001 L 1391.9137285533818 1225.4418204840001 L 1391.9137285533818 1266.0033868320002 L 1304.5263918511494 1266.0033868320002 L 1304.5263918511494 1225.4418204840001 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1320.8867262331494" y="1250.9247376320002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RP (RS)</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 7.5393246000000005 80.97234620399999 L 470.65543288468746 80.97234620399999 L 484.22621716468745 94.54313048399999 L 484.22621716468745 145.810537764 L 7.5393246000000005 145.810537764 L 7.5393246000000005 80.97234620399999 M 470.65543288468746 80.97234620399999 L 470.65543288468746 94.54313048399999 L 484.22621716468745 94.54313048399999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="102.08245508399999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IdP</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="117.16110428399999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports RFC 8705</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="132.239753484" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports the STS Token Exchange extension of OAuth 2.0</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 365.46687051289064 168.42851156400002 L 1284.2829910046094 168.42851156400002 L 1297.8537752846094 181.99929584400002 L 1297.8537752846094 293.581299924 L 365.46687051289064 293.581299924 L 365.46687051289064 168.42851156400002 M 1284.2829910046094 168.42851156400002 L 1284.2829910046094 181.99929584400002 L 1297.8537752846094 181.99929584400002" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="386.5769793928906" y="189.538620444" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Identity Propagator:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="386.5769793928906" y="204.617269644" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports RFC 8705</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="386.5769793928906" y="219.695918844" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• acts as a relying party in respect of the IdP in order to obtain an access_token_with_user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="386.5769793928906" y="234.774568044" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is registered at the IdP as a confidential client or uses RFC 8705 to authenticate at the IdP</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="386.5769793928906" y="249.853217244" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• acts as a client in respect of the RP</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="386.5769793928906" y="264.931866444" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• the hash of the public key described in RFC 8705 is published using .well-known, Webfinger or DNS (DANE) mechanism</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="386.5769793928906" y="280.01051564399995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  to authenticate to the RP using the service specific client identity represented by a DNS domain name</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1090.5516169716798 316.199273724 L 1592.3177191528516 316.199273724 L 1605.8885034328516 329.770058004 L 1605.8885034328516 411.194763684 L 1090.5516169716798 411.194763684 L 1090.5516169716798 316.199273724 M 1592.3177191528516 316.199273724 L 1592.3177191528516 329.770058004 L 1605.8885034328516 329.770058004" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1111.6617258516796" y="337.309382604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RP:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1111.6617258516796" y="352.388031804" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports RFC 8705</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1111.6617258516796" y="367.46668100399995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses the information in the assertion to identify the subscriber</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1111.6617258516796" y="382.5453302039999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  and makes authorization decisions using a local ABAC engine</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1111.6617258516796" y="397.6239794039999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• should support the service discovery mechanism</text></g><g><g><rect fill="white" stroke="none" x="265.28474340703127" y="433.8127374840001" width="335.95691385179686" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="265.28474340703127" y="448.89138668400005" width="255.15692605882813" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="265.28474340703127" y="463.970035884" width="233.54025735765626" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="265.28474340703127" y="479.048685084" width="491.9402512541406" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="265.28474340703127" y="494.12733428399997" width="389.8402756682031" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="265.28474340703127" y="509.20598348399994" width="546.9736069670313" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="267.5465407870313" y="447.3835217640001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. Send an HTTP request to the STS endpoint</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="267.5465407870313" y="462.46217096400005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • grant_type = token-exchange</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="267.5465407870313" y="477.540820164" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • resource = a target RP URI</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="267.5465407870313" y="492.619469364" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • requested_token_type = urn:ietf:params:oauth:token-type:jwt</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="267.5465407870313" y="507.69811856399997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • subject_token = access_token_with_user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="267.5465407870313" y="522.7767677639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • subject_token_type = urn:ietf:params:oauth:token-type:access_token</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 831.66032289875 528.8082274440001 L 258.2975253903437 528.8082274440001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(245.88277088234372,528.8082274440001) translate(-245.88277088234372,-528.8082274440001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 258.4483118823437 522.5254569440001 L 245.88277088234372 528.8082274440001 L 258.4483118823437 535.090997944 Z"/></g></g><g><g><rect fill="white" stroke="none" x="263.7258391023437" y="551.4262012440001" width="191.60692300707032" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="263.7258391023437" y="566.5048504440001" width="280.0902756682031" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="263.7258391023437" y="581.5834996440001" width="287.39026346117186" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="263.7258391023437" y="596.6621488440001" width="287.85693826585936" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="265.9876364823437" y="564.9969855240001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. Authorization decision:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="265.9876364823437" y="580.0756347240001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   1. evaluate the resource parameter</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="265.9876364823437" y="595.1542839240001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   2. verify the subject_token signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="265.9876364823437" y="610.232933124" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   3. evaluate the subject_token claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 245.88277088234372 616.2643928040001 L 306.1973676823437 616.2643928040001 L 306.1973676823437 635.8666367640001 L 258.2975253903437 635.8666367640001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(245.88277088234372,635.8666367640001) translate(-245.88277088234372,-635.8666367640001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 258.4483118823437 629.5838662640001 L 245.88277088234372 635.8666367640001 L 258.4483118823437 642.149407264 Z"/></g></g><g><g><rect fill="white" stroke="none" x="263.7258391023437" y="658.4846105640001" width="477.64026346117186" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="263.7258391023437" y="673.5632597640001" width="260.67358865648436" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="263.7258391023437" y="688.6419089640001" width="234.85692300707032" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="263.7258391023437" y="703.7205581640001" width="397.00693216234373" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="263.7258391023437" y="718.799207364" width="447.02359476" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="263.7258391023437" y="733.877856564" width="206.90692605882813" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="263.7258391023437" y="748.956505764" width="562.6569565764063" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="263.7258391023437" y="764.035154964" width="291.4069260588281" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="263.7258391023437" y="779.1138041639999" width="307.57358255296873" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="263.7258391023437" y="794.1924533639999" width="538.6569565764063" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="263.7258391023437" y="809.2711025639999" width="236.40692605882813" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="265.9876364823437" y="672.0553948440001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. STS generates a token — a signed certificate-bound assertion</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="265.9876364823437" y="687.1340440440001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    in JWT format with these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="265.9876364823437" y="702.2126932440001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {iss, aud, sub, exp, nbf, cnf}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="265.9876364823437" y="717.2913424440001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • iss is the URI that identifies who issues the token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="265.9876364823437" y="732.369991644" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • aud identifies the target service and it is the value from</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="265.9876364823437" y="747.448640844" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      the resource parameter</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="265.9876364823437" y="762.527290044" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • sub identifies the subscriber by an email address that is extracted from</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="265.9876364823437" y="777.605939244" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      the access_token_with_user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="265.9876364823437" y="792.6845884439999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • exp, nbf are the standard JWT claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="265.9876364823437" y="807.7632376439999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • cnf is the confirmation method with the hash of the client certificate</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="265.9876364823437" y="822.8418868439999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      to which the token is bound</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 245.88277088234372 828.8733465240001 L 306.1973676823437 828.8733465240001 L 306.1973676823437 848.4755904840001 L 258.2975253903437 848.4755904840001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(245.88277088234372,848.4755904840001) translate(-245.88277088234372,-848.4755904840001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 258.4483118823437 842.1928199840002 L 245.88277088234372 848.4755904840001 L 258.4483118823437 854.7583609840001 Z"/></g></g><g><g><rect fill="white" stroke="none" x="312.52641210820315" y="871.0935642840001" width="146.32359781175782" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="312.52641210820315" y="886.172213484" width="175.82359781175782" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="312.52641210820315" y="901.250862684" width="452.4902695646875" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="312.52641210820315" y="916.329511884" width="155.30693521410157" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="312.52641210820315" y="931.408161084" width="148.27359476" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="314.78820948820317" y="884.6643485640001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. Return the token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="314.78820948820317" y="899.742997764" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">{"access_token":token,</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="314.78820948820317" y="914.821646964" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> "issued_token_type":"urn:ietf:params:oauth:token-type:jwt",</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="314.78820948820317" y="929.900296164" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> "token_type":"N_A",</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="314.78820948820317" y="944.978945364" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"> "expires_in":3600}</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 245.88277088234372 951.0104050440001 L 819.24556839075 951.0104050440001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(831.66032289875,951.0104050440001) translate(-831.66032289875,-951.0104050440001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 819.0947818987499 944.7276345440001 L 831.66032289875 951.0104050440001 L 819.0947818987499 957.2931755440001 Z"/></g></g><g><g><rect fill="white" stroke="none" x="861.1200598199218" y="973.628378844" width="457.64026346117186" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="863.3818571999218" y="987.199163124" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. Send an HTTP request to the RP with the token using mTLS</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 831.66032289875 993.2306228040001 L 1335.8053056942656 993.2306228040001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1348.2200602022656,993.2306228040001) translate(-1348.2200602022656,-993.2306228040001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1335.6545192022656 986.9478523040001 L 1348.2200602022656 993.2306228040001 L 1335.6545192022656 999.513393304 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1366.0631284222657" y="1015.8485966040001" width="186.65692605882813" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1366.0631284222657" y="1030.9272458040002" width="231.52359476" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1366.0631284222657" y="1046.0058950040002" width="247.32359781175782" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1366.0631284222657" y="1061.0845442040002" width="352.54025735765623" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1366.0631284222657" y="1076.1631934040001" width="543.206944369375" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1366.0631284222657" y="1091.241842604" width="481.0569199553125" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1368.3249258022656" y="1029.4193808840002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. Authorization decision</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1368.3249258022656" y="1044.4980300840002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    1. verify the token signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1368.3249258022656" y="1059.5766792840002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    2. validate proof-of-possession</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1368.3249258022656" y="1074.6553284840002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    3. validate the client service specific identity</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1368.3249258022656" y="1089.7339776840001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    4. use WebFinger to locate the OpenID Provider (OP) for the subscriber</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1368.3249258022656" y="1104.812626884" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">       using its identifier and verify that the OP matches the issuer</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1348.2200602022656 1110.8440865640002 L 1408.5346570022657 1110.8440865640002 L 1408.5346570022657 1130.4463305240001 L 1360.6348147102656 1130.4463305240001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1348.2200602022656,1130.4463305240001) translate(-1348.2200602022656,-1130.4463305240001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1360.7856012022655 1124.1635600240002 L 1348.2200602022656 1130.4463305240001 L 1360.7856012022655 1136.729101024 Z"/></g></g><g><g><rect fill="white" stroke="none" x="849.50339111875" y="1153.0643043240002" width="480.8736008635156" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="851.7651884987499" y="1166.6350886040002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7. Return the HTTP response, typically with 200, 201 status code</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1348.2200602022656 1172.666548284 L 844.07507740675 1172.666548284" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(831.66032289875,1172.666548284) translate(-831.66032289875,-1172.666548284)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 844.22586389875 1166.3837777840001 L 831.66032289875 1172.666548284 L 844.22586389875 1178.949318784 Z"/></g></g></g></g></svg>