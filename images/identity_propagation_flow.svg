<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1757" height="1158"><desc>participant%20%22IdP%22%20as%20IdP%0Aparticipant%20%22Identity%20Propagator%20(RP%20%2B%20Client)%22%20as%20Propagator%0Aparticipant%20%22RP%20(RS)%22%20as%20RP%0A%0Abottomparticipants%0A%0Anote%20over%20IdP%3AIdP%5Cn%E2%80%A2%20supports%20RFC%208705%5Cn%E2%80%A2%20supports%20the%20STS%20Token%20Exchange%20extension%20of%20OAuth%202.0%0Anote%20over%20Propagator%3AIdentity%20Propagator%3A%5Cn%E2%80%A2%20supports%20RFC%208705%5Cn%E2%80%A2%20acts%20as%20a%20relying%20party%20in%20respect%20of%20the%20IdP%20in%20order%20to%20obtain%20an%20access_token_with_user_claims%5Cn%E2%80%A2%20is%20registered%20at%20the%20IdP%20as%20a%20confidential%20client%20or%20uses%20RFC%208705%20to%20authenticate%20at%20the%20IdP%5Cn%E2%80%A2%20acts%20as%20a%20client%20in%20respect%20of%20the%20RP%5Cn%E2%80%A2%20the%20hash%20of%20the%20public%20key%20described%20in%20RFC%208705%20is%20published%20using%20.well-known%2C%20Webfinger%20or%20DNS%20(DANE)%20mechanism%5Cn%20%20to%20authenticate%20to%20the%20RP%20using%20the%20service%20specific%20client%20identity%20represented%20by%20a%20DNS%20domain%20name%0Anote%20over%20RP%3ARP%3A%5Cn%E2%80%A2%20supports%20RFC%208705%5Cn%E2%80%A2%20uses%20the%20information%20in%20the%20assertion%20to%20identify%20the%20subscriber%5Cn%20%20and%20makes%20authorization%20decisions%20using%20a%20local%20ABAC%20engine%5Cn%E2%80%A2%20should%20support%20the%20service%20discovery%20mechanism%0AIdP%3C-Propagator%3A1.%20Send%20an%20HTTP%20request%20to%20the%20STS%20endpoint%5Cn%20%20%20%20%E2%80%A2%20grant_type%20%3D%20token-exchange%5Cn%20%20%20%20%E2%80%A2%20resource%20%3D%20a%20target%20RP%20URI%5Cn%20%20%20%20%E2%80%A2%20requested_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Ajwt%5Cn%20%20%20%20%E2%80%A2%20subject_token%20%3D%20access_token_with_user_claims%5Cn%20%20%20%20%E2%80%A2%20subject_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Aaccess_token%0AIdP-%3EIdP%3A2.%20Authorization%20decision%3A%5Cn%20%20%201.%20evaluate%20the%20resource%20parameter%5Cn%20%20%202.%20verify%20the%20subject_token%20signature%5Cn%20%20%203.%20evaluate%20the%20subject_token%20claims%0A%0AIdP-%3EIdP%3A3.%20STS%20generates%20a%20certificate-bound%20jwt%20access_token%20with%20these%20claims%3A%5Cn%20%20%20%20%7Biss%2C%20aud%2C%20sub%2C%20exp%2C%20nbf%7D%5Cn%20%20%20%20%E2%80%A2%20iss%20is%20the%20URI%20that%20identifies%20who%20issues%20the%20access_token%5Cn%20%20%20%20%E2%80%A2%20aud%20identifies%20the%20target%20service%20and%20it%20is%20the%20value%20from%5Cn%20%20%20%20%20%20the%20resource%20parameter%5Cn%20%20%20%20%E2%80%A2%20sub%20identifies%20the%20subscriber%20by%20an%20email%20address%20that%20is%20extracted%20from%5Cn%20%20%20%20%20%20the%20access_token_with_user_claims%5Cn%20%20%20%20%E2%80%A2%20exp%2C%20nbf%20are%20the%20standard%20JWT%20claims%0APropagator%3C-IdP%3A4.%20Return%20the%20access_token%0A%0APropagator-%3ERP%3A5.%20Send%20an%20HTTP%20request%20to%20the%20RP%20with%20the%20access_token%20using%20mTLS%0ARP-%3ERP%3A6.%20Authorization%20decision%5Cn%20%20%20%201.%20verify%20the%20access_token%20signature%5Cn%20%20%20%202.%20validate%20proof-of-possession%5Cn%20%20%20%203.%20validate%20the%20client%20service%20specific%20identity%5Cn%20%20%20%204.%20evaluate%20claims%0ARP-%3EPropagator%3A7.%20Return%20the%20HTTP%20response%2C%20typically%20with%20200%2C%20201%20status%20code%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1757" height="1158"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 245.88277088234372 50.815047804 L 245.88277088234372 1104.812626884" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 831.66032289875 50.815047804 L 831.66032289875 1104.812626884" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1381.7700479952343 50.815047804 L 1381.7700479952343 1104.812626884" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 218.27243650034373 10.253481456000003 L 273.49310526434374 10.253481456000003 L 273.49310526434374 50.815047804 L 218.27243650034373 50.815047804 L 218.27243650034373 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="234.63277088234372" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IdP</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 694.8749854649922 10.253481456000003 L 968.4456603325077 10.253481456000003 L 968.4456603325077 50.815047804 L 694.8749854649922 50.815047804 L 694.8749854649922 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="711.2353198469922" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Identity Propagator (RP + Client)</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1338.076379644118 10.253481456000003 L 1425.4637163463506 10.253481456000003 L 1425.4637163463506 50.815047804 L 1338.076379644118 50.815047804 L 1338.076379644118 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1354.4367140261181" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RP (RS)</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 218.27243650034373 1104.812626884 L 273.49310526434374 1104.812626884 L 273.49310526434374 1145.3741932320002 L 218.27243650034373 1145.3741932320002 L 218.27243650034373 1104.812626884 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="234.63277088234372" y="1130.2955440320002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IdP</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 694.8749854649922 1104.812626884 L 968.4456603325077 1104.812626884 L 968.4456603325077 1145.3741932320002 L 694.8749854649922 1145.3741932320002 L 694.8749854649922 1104.812626884 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="711.2353198469922" y="1130.2955440320002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Identity Propagator (RP + Client)</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1338.076379644118 1104.812626884 L 1425.4637163463506 1104.812626884 L 1425.4637163463506 1145.3741932320002 L 1338.076379644118 1145.3741932320002 L 1338.076379644118 1104.812626884 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1354.4367140261181" y="1130.2955440320002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RP (RS)</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 7.5393246000000005 80.97234620399999 L 470.65543288468746 80.97234620399999 L 484.22621716468745 94.54313048399999 L 484.22621716468745 145.810537764 L 7.5393246000000005 145.810537764 L 7.5393246000000005 80.97234620399999 M 470.65543288468746 80.97234620399999 L 470.65543288468746 94.54313048399999 L 484.22621716468745 94.54313048399999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="102.08245508399999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IdP</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="117.16110428399999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports RFC 8705</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="132.239753484" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports the STS Token Exchange extension of OAuth 2.0</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 365.46687051289064 168.42851156400002 L 1284.2829910046094 168.42851156400002 L 1297.8537752846094 181.99929584400002 L 1297.8537752846094 293.581299924 L 365.46687051289064 293.581299924 L 365.46687051289064 168.42851156400002 M 1284.2829910046094 168.42851156400002 L 1284.2829910046094 181.99929584400002 L 1297.8537752846094 181.99929584400002" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="386.5769793928906" y="189.538620444" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Identity Propagator:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="386.5769793928906" y="204.617269644" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports RFC 8705</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="386.5769793928906" y="219.695918844" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• acts as a relying party in respect of the IdP in order to obtain an access_token_with_user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="386.5769793928906" y="234.774568044" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is registered at the IdP as a confidential client or uses RFC 8705 to authenticate at the IdP</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="386.5769793928906" y="249.853217244" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• acts as a client in respect of the RP</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="386.5769793928906" y="264.931866444" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• the hash of the public key described in RFC 8705 is published using .well-known, Webfinger or DNS (DANE) mechanism</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="386.5769793928906" y="280.01051564399995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  to authenticate to the RP using the service specific client identity represented by a DNS domain name</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1124.1016047646485 316.199273724 L 1625.8677069458204 316.199273724 L 1639.4384912258204 329.770058004 L 1639.4384912258204 411.194763684 L 1124.1016047646485 411.194763684 L 1124.1016047646485 316.199273724 M 1625.8677069458204 316.199273724 L 1625.8677069458204 329.770058004 L 1639.4384912258204 329.770058004" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1145.2117136446484" y="337.309382604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RP:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1145.2117136446484" y="352.388031804" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports RFC 8705</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1145.2117136446484" y="367.46668100399995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses the information in the assertion to identify the subscriber</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1145.2117136446484" y="382.5453302039999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  and makes authorization decisions using a local ABAC engine</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1145.2117136446484" y="397.6239794039999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• should support the service discovery mechanism</text></g><g><g><rect fill="white" stroke="none" x="265.28474340703127" y="433.8127374840001" width="335.95691385179686" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="265.28474340703127" y="448.89138668400005" width="255.15692605882813" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="265.28474340703127" y="463.970035884" width="233.54025735765626" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="265.28474340703127" y="479.048685084" width="491.9402512541406" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="265.28474340703127" y="494.12733428399997" width="389.8402756682031" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="265.28474340703127" y="509.20598348399994" width="546.9736069670313" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="267.5465407870313" y="447.3835217640001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. Send an HTTP request to the STS endpoint</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="267.5465407870313" y="462.46217096400005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • grant_type = token-exchange</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="267.5465407870313" y="477.540820164" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • resource = a target RP URI</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="267.5465407870313" y="492.619469364" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • requested_token_type = urn:ietf:params:oauth:token-type:jwt</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="267.5465407870313" y="507.69811856399997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • subject_token = access_token_with_user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="267.5465407870313" y="522.7767677639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • subject_token_type = urn:ietf:params:oauth:token-type:access_token</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 831.66032289875 528.8082274440001 L 258.2975253903437 528.8082274440001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(245.88277088234372,528.8082274440001) translate(-245.88277088234372,-528.8082274440001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 258.4483118823437 522.5254569440001 L 245.88277088234372 528.8082274440001 L 258.4483118823437 535.090997944 Z"/></g></g><g><g><rect fill="white" stroke="none" x="263.7258391023437" y="551.4262012440001" width="191.60692300707032" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="263.7258391023437" y="566.5048504440001" width="280.0902756682031" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="263.7258391023437" y="581.5834996440001" width="287.39026346117186" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="263.7258391023437" y="596.6621488440001" width="287.85693826585936" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="265.9876364823437" y="564.9969855240001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. Authorization decision:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="265.9876364823437" y="580.0756347240001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   1. evaluate the resource parameter</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="265.9876364823437" y="595.1542839240001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   2. verify the subject_token signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="265.9876364823437" y="610.232933124" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   3. evaluate the subject_token claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 245.88277088234372 616.2643928040001 L 306.1973676823437 616.2643928040001 L 306.1973676823437 635.8666367640001 L 258.2975253903437 635.8666367640001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(245.88277088234372,635.8666367640001) translate(-245.88277088234372,-635.8666367640001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 258.4483118823437 629.5838662640001 L 245.88277088234372 635.8666367640001 L 258.4483118823437 642.149407264 Z"/></g></g><g><g><rect fill="white" stroke="none" x="263.7258391023437" y="658.4846105640001" width="540.456944369375" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="263.7258391023437" y="673.5632597640001" width="202.99025430589845" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="263.7258391023437" y="688.6419089640001" width="453.79025735765623" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="263.7258391023437" y="703.7205581640001" width="447.02359476" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="263.7258391023437" y="718.799207364" width="206.90692605882813" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="263.7258391023437" y="733.877856564" width="562.6569565764063" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="263.7258391023437" y="748.956505764" width="291.4069260588281" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="263.7258391023437" y="764.035154964" width="307.57358255296873" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="265.9876364823437" y="672.0553948440001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. STS generates a certificate-bound jwt access_token with these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="265.9876364823437" y="687.1340440440001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {iss, aud, sub, exp, nbf}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="265.9876364823437" y="702.2126932440001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • iss is the URI that identifies who issues the access_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="265.9876364823437" y="717.2913424440001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • aud identifies the target service and it is the value from</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="265.9876364823437" y="732.369991644" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      the resource parameter</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="265.9876364823437" y="747.448640844" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • sub identifies the subscriber by an email address that is extracted from</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="265.9876364823437" y="762.527290044" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      the access_token_with_user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="265.9876364823437" y="777.605939244" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • exp, nbf are the standard JWT claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 245.88277088234372 783.6373989240001 L 306.1973676823437 783.6373989240001 L 306.1973676823437 803.2396428840001 L 258.2975253903437 803.2396428840001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(245.88277088234372,803.2396428840001) translate(-245.88277088234372,-803.2396428840001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 258.4483118823437 796.9568723840001 L 245.88277088234372 803.2396428840001 L 258.4483118823437 809.5224133840001 Z"/></g></g><g><g><rect fill="white" stroke="none" x="437.21808538701174" y="825.857616684" width="203.10692300707032" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="439.47988276701176" y="839.428400964" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. Return the access_token</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 245.88277088234372 845.4598606440001 L 819.24556839075 845.4598606440001" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(831.66032289875,845.4598606440001) translate(-831.66032289875,-845.4598606440001)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 819.0947818987499 839.1770901440001 L 831.66032289875 845.4598606440001 L 819.0947818987499 851.742631144 Z"/></g></g><g><g><rect fill="white" stroke="none" x="849.50339111875" y="868.077834444" width="514.4235886564844" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="851.7651884987499" y="881.648618724" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. Send an HTTP request to the RP with the access_token using mTLS</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 831.66032289875 887.680078404 L 1369.3552934872343 887.680078404" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1381.7700479952343,887.680078404) translate(-1381.7700479952343,-887.680078404)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1369.2045069952344 881.3973079040001 L 1381.7700479952343 887.680078404 L 1369.2045069952344 893.962848904 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1399.6131162152344" y="910.298052204" width="186.65692605882813" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1399.6131162152344" y="925.376701404" width="288.3069199553125" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1399.6131162152344" y="940.4553506039999" width="247.32359781175782" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1399.6131162152344" y="955.5339998039999" width="352.54025735765623" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1399.6131162152344" y="970.6126490039999" width="157.54025735765626" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1401.8749135952344" y="923.868836484" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. Authorization decision</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1401.8749135952344" y="938.947485684" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    1. verify the access_token signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1401.8749135952344" y="954.0261348839999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    2. validate proof-of-possession</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1401.8749135952344" y="969.1047840839999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    3. validate the client service specific identity</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1401.8749135952344" y="984.1834332839999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    4. evaluate claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1381.7700479952343 990.214892964 L 1442.0846447952345 990.214892964 L 1442.0846447952345 1009.817136924 L 1394.1848025032343 1009.817136924" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1381.7700479952343,1009.817136924) translate(-1381.7700479952343,-1009.817136924)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1394.3355889952343 1003.534366424 L 1381.7700479952343 1009.817136924 L 1394.3355889952343 1016.099907424 Z"/></g></g><g><g><rect fill="white" stroke="none" x="866.2783850152343" y="1032.4351107240002" width="480.8736008635156" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="868.5401823952343" y="1046.0058950040002" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7. Return the HTTP response, typically with 200, 201 status code</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1381.7700479952343 1052.037354684 L 844.07507740675 1052.037354684" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(831.66032289875,1052.037354684) translate(-831.66032289875,-1052.037354684)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 844.22586389875 1045.7545841840001 L 831.66032289875 1052.037354684 L 844.22586389875 1058.320125184 Z"/></g></g></g></g></svg>