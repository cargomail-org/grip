<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1694" height="1097"><desc>participant%20%22IdP%20%2B%20STS%22%20as%20STS%0Aparticipant%20%22Identity%20Propagator%22%20as%20Propagator%0Aparticipant%20%22RP%22%20as%20RP%0A%0Abottomparticipants%0A%0Anote%20over%20STS%3ASTS%3A%5Cn%E2%80%A2%20supports%20RFC%208705%5Cn%E2%80%A2%20supports%20the%20Token%20Exchange%20extension%20of%20OAuth%202.0%0Anote%20over%20Propagator%3AIdentity%20Propagator%3A%5Cn%E2%80%A2%20supports%20RFC%208705%5Cn%E2%80%A2%20acts%20as%20a%20relying%20party%20in%20respect%20of%20the%20IdP%20in%20order%20to%20obtain%5Cn%20%20an%20access_token_with_user_claims%5Cn%E2%80%A2%20is%20registered%20at%20the%20IdP%20as%20a%20confidential%20client%0Anote%20over%20RP%3ARP%3A%5Cn%E2%80%A2%20supports%20RFC%208705%5Cn%E2%80%A2%20uses%20the%20information%20in%20the%20assertion%20to%20identify%20the%20subscriber%5Cn%20%20and%20makes%20authorization%20decisions%20using%20a%20local%20ABAC%20engine.%0ASTS%3C-Propagator%3A1.%20Send%20an%20HTTP%20request%20to%20the%20STS%20endpoint%5Cn%20%20%20%20%E2%80%A2%20grant_type%20%3D%20token-exchange%5Cn%20%20%20%20%E2%80%A2%20resource%20%3D%20a%20target%20RP%20URI%5Cn%20%20%20%20%E2%80%A2%20requested_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Aaccess_token%5Cn%20%20%20%20%E2%80%A2%20subject_token%20%3D%20access_token_with_user_claims%5Cn%20%20%20%20%E2%80%A2%20subject_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Aaccess_token%0ASTS-%3ESTS%3A2.%20Authorization%20decision%3A%5Cn%20%20%201.%20evaluate%20the%20resource%20parameter%5Cn%20%20%202.%20verify%20the%20subject_token%20signature%5Cn%20%20%203.%20evaluate%20the%20subject_token%20claims%0A%0ASTS-%3ESTS%3A3.%20STS%20generates%20a%20certificate-bound%20access_token%20with%20these%20claims%3A%5Cn%20%20%20%20%7Biss%2C%20aud%2C%20sub%2C%20exp%2C%20nbf%7D%5Cn%20%20%20%20%E2%80%A2%20iss%20is%20the%20URI%20that%20identifies%20who%20issues%20the%20access_token%5Cn%20%20%20%20%E2%80%A2%20aud%20identifies%20the%20target%20service%20and%20it%20is%20the%20value%20from%5Cn%20%20%20%20%20%20the%20resource%20parameter%5Cn%20%20%20%20%E2%80%A2%20sub%20identifies%20the%20subscriber%20by%20an%20email%20address%20that%20is%20extracted%20from%5Cn%20%20%20%20%20%20the%20access_token_with_user_claims%5Cn%20%20%20%20%E2%80%A2%20exp%2C%20nbf%20are%20the%20standard%20JWT%20claims%0APropagator%3C-STS%3A4.%20Return%20the%20access_token%0A%0APropagator-%3ERP%3A5.%20Send%20an%20HTTP%20request%20to%20the%20RP%20with%20the%20access_token%20using%20mTLS%0ARP-%3ERP%3A6.%20Authorization%20decision%5Cn%20%20%20%201.%20verify%20the%20access_token%20signature%5Cn%20%20%20%202.%20validate%20proof-of-possession%5Cn%20%20%20%203.%20evaluate%20claims%0ARP-%3EPropagator%3A7.%20Return%20the%20HTTP%20response%2C%20typically%20with%20200%2C%20201%20status%20code%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1694" height="1097"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 229.7494395835156 50.815047804 L 229.7494395835156 1044.4980300839998" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 833.3591951975781 50.815047804 L 833.3591951975781 1044.4980300839998" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1383.4689202940624 50.815047804 L 1383.4689202940624 1044.4980300839998" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 177.522440315041 10.253481456000003 L 281.9764388519902 10.253481456000003 L 281.9764388519902 50.815047804 L 177.522440315041 50.815047804 L 177.522440315041 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="193.882774697041" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IdP + STS</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 746.215527990871 10.253481456000003 L 920.5028624042851 10.253481456000003 L 920.5028624042851 50.815047804 L 746.215527990871 50.815047804 L 746.215527990871 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="762.575862372871" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Identity Propagator</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1357.583586293532 10.253481456000003 L 1409.3542542945927 10.253481456000003 L 1409.3542542945927 50.815047804 L 1357.583586293532 50.815047804 L 1357.583586293532 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1373.9439206755321" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RP</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 177.522440315041 1044.4980300839998 L 281.9764388519902 1044.4980300839998 L 281.9764388519902 1085.0595964319998 L 177.522440315041 1085.0595964319998 L 177.522440315041 1044.4980300839998 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="193.882774697041" y="1069.9809472319998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IdP + STS</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 746.215527990871 1044.4980300839998 L 920.5028624042851 1044.4980300839998 L 920.5028624042851 1085.0595964319998 L 746.215527990871 1085.0595964319998 L 746.215527990871 1044.4980300839998 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="762.575862372871" y="1069.9809472319998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Identity Propagator</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1357.583586293532 1044.4980300839998 L 1409.3542542945927 1044.4980300839998 L 1409.3542542945927 1085.0595964319998 L 1357.583586293532 1085.0595964319998 L 1357.583586293532 1044.4980300839998 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1373.9439206755321" y="1069.9809472319998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RP</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 7.5393246000000005 80.97234620399999 L 438.3887702870312 80.97234620399999 L 451.9595545670312 94.54313048399999 L 451.9595545670312 145.810537764 L 7.5393246000000005 145.810537764 L 7.5393246000000005 80.97234620399999 M 438.3887702870312 80.97234620399999 L 438.3887702870312 94.54313048399999 L 451.9595545670312 94.54313048399999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="102.08245508399999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">STS:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="117.16110428399999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports RFC 8705</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="132.239753484" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports the Token Exchange extension of OAuth 2.0</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 581.557420668164 168.42851156400002 L 1071.590185446992 168.42851156400002 L 1085.160969726992 181.99929584400002 L 1085.160969726992 263.424001524 L 581.557420668164 263.424001524 L 581.557420668164 168.42851156400002 M 1071.590185446992 168.42851156400002 L 1071.590185446992 181.99929584400002 L 1085.160969726992 181.99929584400002" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="602.667529548164" y="189.538620444" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Identity Propagator:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="602.667529548164" y="204.617269644" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports RFC 8705</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="602.667529548164" y="219.695918844" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• acts as a relying party in respect of the IdP in order to obtain</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="602.667529548164" y="234.774568044" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  an access_token_with_user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="602.667529548164" y="249.853217244" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is registered at the IdP as a confidential client</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1125.8004770634766 286.04197532399996 L 1627.5665792446484 286.04197532399996 L 1641.1373635246484 299.61275960399996 L 1641.1373635246484 365.958816084 L 1125.8004770634766 365.958816084 L 1125.8004770634766 286.04197532399996 M 1627.5665792446484 286.04197532399996 L 1627.5665792446484 299.61275960399996 L 1641.1373635246484 299.61275960399996" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1146.9105859434765" y="307.15208420399995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RP:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1146.9105859434765" y="322.2307334039999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• supports RFC 8705</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1146.9105859434765" y="337.3093826039999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses the information in the assertion to identify the subscriber</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1146.9105859434765" y="352.38803180399987" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  and makes authorization decisions using a local ABAC engine.</text></g><g><g><rect fill="white" stroke="none" x="247.59250780351564" y="388.576789884" width="335.95691385179686" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.59250780351564" y="403.655439084" width="255.15692605882813" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.59250780351564" y="418.734088284" width="233.54025735765626" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.59250780351564" y="433.81273748399997" width="567.9236191740625" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.59250780351564" y="448.89138668399994" width="389.8402756682031" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.59250780351564" y="463.9700358839999" width="546.9736069670313" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="249.85430518351563" y="402.14757416400005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. Send an HTTP request to the STS endpoint</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="249.85430518351563" y="417.226223364" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • grant_type = token-exchange</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="249.85430518351563" y="432.304872564" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • resource = a target RP URI</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="249.85430518351563" y="447.38352176399997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • requested_token_type = urn:ietf:params:oauth:token-type:access_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="249.85430518351563" y="462.46217096399994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • subject_token = access_token_with_user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="249.85430518351563" y="477.5408201639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • subject_token_type = urn:ietf:params:oauth:token-type:access_token</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 833.3591951975781 483.572279844 L 242.16419409151558 483.572279844" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(229.7494395835156,483.572279844) translate(-229.7494395835156,-483.572279844)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 242.3149805835156 477.28950934399995 L 229.7494395835156 483.572279844 L 242.3149805835156 489.855050344 Z"/></g></g><g><g><rect fill="white" stroke="none" x="247.5925078035156" y="506.19025364399994" width="191.60692300707032" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.5925078035156" y="521.268902844" width="280.0902756682031" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.5925078035156" y="536.3475520439999" width="287.39026346117186" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.5925078035156" y="551.4262012439999" width="287.85693826585936" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="249.85430518351558" y="519.761037924" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. Authorization decision:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="249.85430518351558" y="534.839687124" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   1. evaluate the resource parameter</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="249.85430518351558" y="549.9183363239999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   2. verify the subject_token signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="249.85430518351558" y="564.9969855239999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   3. evaluate the subject_token claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 229.7494395835156 571.0284452039999 L 290.0640363835156 571.0284452039999 L 290.0640363835156 590.6306891639999 L 242.16419409151558 590.6306891639999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(229.7494395835156,590.6306891639999) translate(-229.7494395835156,-590.6306891639999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 242.3149805835156 584.347918664 L 229.7494395835156 590.6306891639999 L 242.3149805835156 596.9134596639999 Z"/></g></g><g><g><rect fill="white" stroke="none" x="247.5925078035156" y="613.248662964" width="513.9569138517969" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.5925078035156" y="628.327312164" width="202.99025430589845" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.5925078035156" y="643.405961364" width="453.79025735765623" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.5925078035156" y="658.4846105639999" width="447.02359476" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.5925078035156" y="673.5632597639999" width="206.90692605882813" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.5925078035156" y="688.6419089639999" width="562.6569565764063" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.5925078035156" y="703.7205581639998" width="291.4069260588281" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="247.5925078035156" y="718.7992073639998" width="307.57358255296873" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="249.85430518351558" y="626.819447244" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. STS generates a certificate-bound access_token with these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="249.85430518351558" y="641.898096444" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {iss, aud, sub, exp, nbf}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="249.85430518351558" y="656.976745644" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • iss is the URI that identifies who issues the access_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="249.85430518351558" y="672.0553948439999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • aud identifies the target service and it is the value from</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="249.85430518351558" y="687.1340440439999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      the resource parameter</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="249.85430518351558" y="702.2126932439999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • sub identifies the subscriber by an email address that is extracted from</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="249.85430518351558" y="717.2913424439998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      the access_token_with_user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="249.85430518351558" y="732.3699916439998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • exp, nbf are the standard JWT claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 229.7494395835156 738.4014513239999 L 290.0640363835156 738.4014513239999 L 290.0640363835156 758.003695284 L 242.16419409151558 758.003695284" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(229.7494395835156,758.003695284) translate(-229.7494395835156,-758.003695284)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 242.3149805835156 751.720924784 L 229.7494395835156 758.003695284 L 242.3149805835156 764.2864657839999 Z"/></g></g><g><g><rect fill="white" stroke="none" x="430.0008558870117" y="780.6216690839999" width="203.10692300707032" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="432.26265326701173" y="794.1924533639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. Return the access_token</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 229.7494395835156 800.2239130439999 L 820.9444406895781 800.2239130439999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(833.3591951975781,800.2239130439999) translate(-833.3591951975781,-800.2239130439999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 820.793654197578 793.941142544 L 833.3591951975781 800.2239130439999 L 820.793654197578 806.5066835439999 Z"/></g></g><g><g><rect fill="white" stroke="none" x="851.202263417578" y="822.8418868439999" width="514.4235886564844" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="853.464060797578" y="836.4126711239999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. Send an HTTP request to the RP with the access_token using mTLS</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 833.3591951975781 842.4441308039999 L 1371.0541657860624 842.4441308039999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1383.4689202940624,842.4441308039999) translate(-1383.4689202940624,-842.4441308039999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1370.9033792940625 836.1613603039999 L 1383.4689202940624 842.4441308039999 L 1370.9033792940625 848.7269013039999 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1401.3119885140625" y="865.0621046039998" width="186.65692605882813" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1401.3119885140625" y="880.1407538039998" width="288.3069199553125" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1401.3119885140625" y="895.2194030039998" width="247.32359781175782" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1401.3119885140625" y="910.2980522039998" width="157.54025735765626" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1403.5737858940624" y="878.6328888839998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. Authorization decision</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1403.5737858940624" y="893.7115380839998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    1. verify the access_token signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1403.5737858940624" y="908.7901872839998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    2. validate proof-of-possession</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1403.5737858940624" y="923.8688364839998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    3. evaluate claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1383.4689202940624 929.9002961639999 L 1443.7835170940625 929.9002961639999 L 1443.7835170940625 949.5025401239999 L 1395.8836748020624 949.5025401239999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1383.4689202940624,949.5025401239999) translate(-1383.4689202940624,-949.5025401239999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1396.0344612940623 943.2197696239999 L 1383.4689202940624 949.5025401239999 L 1396.0344612940623 955.7853106239999 Z"/></g></g><g><g><rect fill="white" stroke="none" x="867.9772573140624" y="972.1205139239999" width="480.8736008635156" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="870.2390546940624" y="985.6912982039998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7. Return the HTTP response, typically with 200, 201 status code</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1383.4689202940624 991.7227578839999 L 845.773949705578 991.7227578839999" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(833.3591951975781,991.7227578839999) translate(-833.3591951975781,-991.7227578839999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 845.9247361975781 985.4399873839999 L 833.3591951975781 991.7227578839999 L 845.9247361975781 998.0055283839998 Z"/></g></g></g></g></svg>