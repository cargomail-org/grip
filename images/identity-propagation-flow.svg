<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="1791" height="1097"><desc>participant%20%22Identity%20Propagation%20Service%20(IPS)%22%20as%20IPS%0Aparticipant%20%22Client%22%20as%20Client%0Aparticipant%20%22Resource%20Server%20(RS)%22%20as%20RS%0A%0Abottomparticipants%0A%0Anote%20over%20IPS%3AIPS%3A%5Cn%E2%80%A2%20acts%20as%20an%20IdP%20client%5Cn%E2%80%A2%20is%20part%20of%20the%20STS%20that%20supports%20the%20Token%20Exchange%20extension%20of%20OAuth%202.0%5Cn%E2%80%A2%20publishes%20its%20metadata%20on%20a%20URL%20%2F.well-known%2Foauth-authorization-server%5Cn%0Anote%20over%20Client%3AClient%3A%5Cn%E2%80%A2%20is%20registered%20at%20the%20IPS%20as%20a%20confidential%20client%5Cn%E2%80%A2%20acts%20as%20a%20Relying%20Party%20in%20respect%20of%20the%20IdP%20in%20order%20to%20obtain%5Cn%20%20an%20access_token_with_user_claims%5Cn%E2%80%A2%20should%20support%20DPOP%0Anote%20over%20RS%3ARS%3A%5Cn%E2%80%A2%20uses%20the%20local%20ABAC%20engine%20to%20automate%20authorization%20assessment%0AIPS%3C-Client%3A1.%20Send%20an%20HTTP%20request%20to%20exchange%20the%20access_token_with_user_claims%5Cn%20%20%20%20for%20an%20access%20token%20with%20changed%20aud%20claim%5Cn%20%20%20%20%E2%80%A2%20grant_type%20%3D%20token-exchange%5Cn%20%20%20%20%E2%80%A2%20resource%20%3D%20a%20target%20RS%20URI%5Cn%20%20%20%20%E2%80%A2%20requested_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Aaccess_token%5Cn%20%20%20%20%E2%80%A2%20subject_token%20%3D%20access_token_with_user_claims%5Cn%20%20%20%20%E2%80%A2%20subject_token_type%20%3D%20urn%3Aietf%3Aparams%3Aoauth%3Atoken-type%3Aaccess_token%0AIPS-%3EIPS%3A2.%20Authorization%20assessment%3A%5Cn%20%20%201.%20evaluate%20the%20resource%20parameter%5Cn%20%20%202.%20verify%20the%20subject_token%20signature%5Cn%20%20%203.%20evaluate%20the%20subject_token%20claims%0A%0AIPS-%3EIPS%3A3.%20IPS%20generates%20an%20access_token%20with%20these%20claims%3A%5Cn%20%20%20%20%7Biss%2C%20aud%2C%20sub%2C%20exp%2C%20nbf%7D%5Cn%20%20%20%20%E2%80%A2%20iss%20is%20the%20URI%20that%20identifies%20who%20issues%20the%20access_token%5Cn%20%20%20%20%E2%80%A2%20aud%20identifies%20the%20target%20service%20and%20it%20is%20the%20aud%20value%20from%5Cn%20%20%20%20%20%20the%20resource%20parameter%5Cn%20%20%20%20%E2%80%A2%20sub%20identifies%20the%20principal%20by%20an%20email%20address%20that%20is%20extracted%20from%5Cn%20%20%20%20%20%20the%20access_token_with_user_claims%5Cn%20%20%20%20%E2%80%A2%20exp%2C%20nbf%20are%20the%20standard%20JWT%20claims%0AClient%3C-IPS%3A4.%20Return%20the%20access_token%0A%0AClient-%3ERS%3A5.%20Send%20an%20HTTP%20request%20to%20the%20RS%20with%20the%20access_token%20in%20the%20header%0ARS-%3ERS%3A6.%20Authorization%20assessment%5Cn%20%20%20%201.%20verify%20the%20access_token%20signature%5Cn%20%20%20%202.%20evaluate%20claims%0ARS-%3EClient%3A7.%20Return%20the%20HTTP%20response%2C%20typically%20with%20200%2C%20201%20status%20code%0A</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="1791" height="1097"/></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 312.4661143882031 50.815047804 L 312.4661143882031 1044.498030084" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 916.0758700022656 50.815047804 L 916.0758700022656 1044.498030084" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1480.0855889952343 50.815047804 L 1480.0855889952343 1044.498030084" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray="11.598960923076923,5.0262164"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 172.88911283091014 10.253481456000003 L 452.0431159454961 10.253481456000003 L 452.0431159454961 50.815047804 L 172.88911283091014 50.815047804 L 172.88911283091014 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="189.24944721291013" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Identity Propagation Service (IPS)</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 878.4655356202655 10.253481456000003 L 953.6862043842656 10.253481456000003 L 953.6862043842656 50.815047804 L 878.4655356202655 50.815047804 L 878.4655356202655 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="894.8258700022656" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1385.8585859120624 10.253481456000003 L 1574.3125920784062 10.253481456000003 L 1574.3125920784062 50.815047804 L 1385.8585859120624 50.815047804 L 1385.8585859120624 10.253481456000003 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1402.2189202940624" y="35.736398604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Resource Server (RS)</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 172.88911283091014 1044.498030084 L 452.0431159454961 1044.498030084 L 452.0431159454961 1085.059596432 L 172.88911283091014 1085.059596432 L 172.88911283091014 1044.498030084 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="189.24944721291013" y="1069.980947232" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Identity Propagation Service (IPS)</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 878.4655356202655 1044.498030084 L 953.6862043842656 1044.498030084 L 953.6862043842656 1085.059596432 L 878.4655356202655 1085.059596432 L 878.4655356202655 1044.498030084 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="894.8258700022656" y="1069.980947232" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1385.8585859120624 1044.498030084 L 1574.3125920784062 1044.498030084 L 1574.3125920784062 1085.059596432 L 1385.8585859120624 1085.059596432 L 1385.8585859120624 1044.498030084 Z" stroke-miterlimit="10" stroke-width="2.4125838720000004" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1402.2189202940624" y="1069.980947232" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Resource Server (RS)</text></g></g><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 7.5393246000000005 80.972346204 L 603.8221198964062 80.972346204 L 617.3929041764062 94.543130484 L 617.3929041764062 175.967836164 L 7.5393246000000005 175.967836164 L 7.5393246000000005 80.972346204 M 603.8221198964062 80.972346204 L 603.8221198964062 94.543130484 L 617.3929041764062 94.543130484" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="102.082455084" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">IPS:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="117.161104284" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• acts as an IdP client</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="132.239753484" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is part of the STS that supports the Token Exchange extension of OAuth 2.0</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="147.318402684" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• publishes its metadata on a URL /.well-known/oauth-authorization-server</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="28.64943347999997" y="162.397051884" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve"></text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 662.932420668164 198.58580996400002 L 1155.648535056367 198.58580996400002 L 1169.219319336367 212.15659424400002 L 1169.219319336367 293.581299924 L 662.932420668164 293.581299924 L 662.932420668164 198.58580996400002 M 1155.648535056367 198.58580996400002 L 1155.648535056367 212.15659424400002 L 1169.219319336367 212.15659424400002" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="684.042529548164" y="219.695918844" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="684.042529548164" y="234.774568044" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• is registered at the IPS as a confidential client</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="684.042529548164" y="249.853217244" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• acts as a Relying Party in respect of the IdP in order to obtain</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="684.042529548164" y="264.931866444" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">  an access_token_with_user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="684.042529548164" y="280.01051564399995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• should support DPOP</text></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 1207.5671396611328 316.19927372399997 L 1739.033254049336 316.19927372399997 L 1752.604038329336 329.77005800399996 L 1752.604038329336 365.958816084 L 1207.5671396611328 365.958816084 L 1207.5671396611328 316.19927372399997 M 1739.033254049336 316.19927372399997 L 1739.033254049336 329.77005800399996 L 1752.604038329336 329.77005800399996" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1228.6772485411327" y="337.309382604" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">RS:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1228.6772485411327" y="352.388031804" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">• uses the local ABAC engine to automate authorization assessment</text></g><g><g><rect fill="white" stroke="none" x="330.3091826082031" y="388.576789884" width="544.590245150625" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="330.3091826082031" y="403.655439084" width="346.3736008635156" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="330.3091826082031" y="418.734088284" width="255.15692605882813" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="330.3091826082031" y="433.81273748399997" width="234.00693216234376" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="330.3091826082031" y="448.89138668399994" width="567.9236191740625" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="330.3091826082031" y="463.9700358839999" width="389.8402756682031" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="330.3091826082031" y="479.0486850839999" width="546.9736069670313" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="332.57097998820313" y="402.14757416400005" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. Send an HTTP request to exchange the access_token_with_user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="332.57097998820313" y="417.226223364" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    for an access token with changed aud claim</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="332.57097998820313" y="432.304872564" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • grant_type = token-exchange</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="332.57097998820313" y="447.38352176399997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • resource = a target RS URI</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="332.57097998820313" y="462.46217096399994" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • requested_token_type = urn:ietf:params:oauth:token-type:access_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="332.57097998820313" y="477.5408201639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • subject_token = access_token_with_user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="332.57097998820313" y="492.6194693639999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • subject_token_type = urn:ietf:params:oauth:token-type:access_token</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 916.0758700022656 498.650929044 L 324.8808688962031 498.650929044" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(312.4661143882031,498.650929044) translate(-312.4661143882031,-498.650929044)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 325.0316553882031 492.368158544 L 312.4661143882031 498.650929044 L 325.0316553882031 504.93369954400004 Z"/></g></g><g><g><rect fill="white" stroke="none" x="330.30918260820306" y="521.268902844" width="218.09026040941407" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="330.30918260820306" y="536.3475520439999" width="280.0902756682031" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="330.30918260820306" y="551.4262012439999" width="287.39026346117186" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="330.30918260820306" y="566.5048504439999" width="287.85693826585936" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="332.5709799882031" y="534.839687124" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. Authorization assessment:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="332.5709799882031" y="549.9183363239999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   1. evaluate the resource parameter</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="332.5709799882031" y="564.9969855239999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   2. verify the subject_token signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="332.5709799882031" y="580.0756347239999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">   3. evaluate the subject_token claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 312.4661143882031 586.107094404 L 372.7807111882031 586.107094404 L 372.7807111882031 605.709338364 L 324.8808688962031 605.709338364" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(312.4661143882031,605.709338364) translate(-312.4661143882031,-605.709338364)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 325.0316553882031 599.426567864 L 312.4661143882031 605.709338364 L 325.0316553882031 611.992108864 Z"/></g></g><g><g><rect fill="white" stroke="none" x="330.30918260820306" y="628.327312164" width="387.9402512541406" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="330.30918260820306" y="643.405961364" width="202.99025430589845" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="330.30918260820306" y="658.4846105639999" width="453.79025735765623" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="330.30918260820306" y="673.5632597639999" width="479.29025735765623" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="330.30918260820306" y="688.6419089639999" width="206.90692605882813" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="330.30918260820306" y="703.7205581639998" width="549.4402817717188" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="330.30918260820306" y="718.7992073639998" width="291.4069260588281" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="330.30918260820306" y="733.8778565639998" width="307.57358255296873" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="332.5709799882031" y="641.898096444" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. IPS generates an access_token with these claims:</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="332.5709799882031" y="656.976745644" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    {iss, aud, sub, exp, nbf}</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="332.5709799882031" y="672.0553948439999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • iss is the URI that identifies who issues the access_token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="332.5709799882031" y="687.1340440439999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • aud identifies the target service and it is the aud value from</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="332.5709799882031" y="702.2126932439999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      the resource parameter</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="332.5709799882031" y="717.2913424439998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • sub identifies the principal by an email address that is extracted from</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="332.5709799882031" y="732.3699916439998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">      the access_token_with_user_claims</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="332.5709799882031" y="747.4486408439998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    • exp, nbf are the standard JWT claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 312.4661143882031 753.480100524 L 372.7807111882031 753.480100524 L 372.7807111882031 773.082344484 L 324.8808688962031 773.082344484" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(312.4661143882031,773.082344484) translate(-312.4661143882031,-773.082344484)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 325.0316553882031 766.7995739840001 L 312.4661143882031 773.082344484 L 325.0316553882031 779.365114984 Z"/></g></g><g><g><rect fill="white" stroke="none" x="512.7175306916993" y="795.700318284" width="203.10692300707032" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="514.9793280716992" y="809.271102564" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. Return the access_token</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 312.4661143882031 815.302562244 L 903.6611154942656 815.302562244" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(916.0758700022656,815.302562244) translate(-916.0758700022656,-815.302562244)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 903.5103290022655 809.019791744 L 916.0758700022656 815.302562244 L 903.5103290022655 821.585332744 Z"/></g></g><g><g><rect fill="white" stroke="none" x="933.9189382222655" y="837.920536044" width="528.3235825529688" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="936.1807356022655" y="851.491320324" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. Send an HTTP request to the RS with the access_token in the header</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 916.0758700022656 857.522780004 L 1467.6708344872343 857.522780004" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1480.0855889952343,857.522780004) translate(-1480.0855889952343,-857.522780004)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1467.5200479952343 851.240009504 L 1480.0855889952343 857.522780004 L 1467.5200479952343 863.8055505039999 Z"/></g></g><g><g><rect fill="white" stroke="none" x="1497.9286572152344" y="880.140753804" width="213.14026346117188" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1497.9286572152344" y="895.219403004" width="288.3069199553125" height="19.602243960000003"/></g><g><rect fill="white" stroke="none" x="1497.9286572152344" y="910.298052204" width="157.54025735765626" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1500.1904545952343" y="893.711538084" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. Authorization assessment</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1500.1904545952343" y="908.790187284" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    1. verify the access_token signature</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="1500.1904545952343" y="923.868836484" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    2. evaluate claims</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1480.0855889952343 929.900296164 L 1540.4001857952344 929.900296164 L 1540.4001857952344 949.502540124 L 1492.5003435032343 949.502540124" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(1480.0855889952343,949.502540124) translate(-1480.0855889952343,-949.502540124)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 1492.6511299952342 943.219769624 L 1480.0855889952343 949.502540124 L 1492.6511299952342 955.785310624 Z"/></g></g><g><g><rect fill="white" stroke="none" x="957.6439290669921" y="972.120513924" width="480.8736008635156" height="19.602243960000003"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="959.905726446992" y="985.691298204" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7. Return the HTTP response, typically with 200, 201 status code</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 1480.0855889952343 991.722757884 L 928.4906245102655 991.722757884" stroke-miterlimit="10" stroke-width="1.2565541" stroke-dasharray=""/><g transform="translate(916.0758700022656,991.722757884) translate(-916.0758700022656,-991.722757884)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 928.6414110022656 985.439987384 L 916.0758700022656 991.722757884 L 928.6414110022656 998.005528384 Z"/></g></g></g></g></svg>